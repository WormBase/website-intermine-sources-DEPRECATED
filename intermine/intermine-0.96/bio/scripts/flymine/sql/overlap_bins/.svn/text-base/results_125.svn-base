Testing with size 125
Timing is on.
SELECT
Time: 3085392.330 ms
CREATE INDEX
Time: 1819262.104 ms
CREATE INDEX
Time: 2467363.490 ms
CREATE INDEX
Time: 461954.088 ms
CREATE INDEX
Time: 482070.912 ms
ANALYZE
Time: 54695.400 ms
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3182570.64..3182652.50 rows=3638 width=52) (actual time=68955.296..68958.594 rows=949 loops=1)
   ->  Sort  (cost=3182570.64..3182579.74 rows=3638 width=52) (actual time=68955.293..68956.354 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=3156686.91..3182355.47 rows=3638 width=52) (actual time=60146.155..68952.310 rows=1114 loops=1)
               ->  Nested Loop  (cost=3156686.91..3172416.53 rows=3689 width=42) (actual time=60034.040..63784.191 rows=1114 loops=1)
                     ->  Hash Join  (cost=3156686.91..3171361.61 rows=3689 width=24) (actual time=59992.233..60193.467 rows=1114 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=3131773.61..3137936.88 rows=616327 width=24) (actual time=55962.259..56072.615 rows=83765 loops=1)
                                 ->  Merge Join  (cost=2082183.86..3122528.70 rows=616327 width=24) (actual time=37699.102..51852.940 rows=2836464 loops=1)
                                       Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..909501.28 rows=1207483 width=20) (actual time=169.798..3229.777 rows=1262354 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                       ->  Sort  (cost=2082183.86..2088475.24 rows=2516552 width=20) (actual time=37529.279..40387.493 rows=2861394 loops=1)
                                             Sort Key: l2.objectid, l2.bin
                                             Sort Method:  quicksort  Memory: 290747kB
                                             ->  Index Scan using locationbin125__subjecttypeid on locationbin125 l2  (cost=0.00..1814636.42 rows=2516552 width=20) (actual time=262.835..31580.001 rows=2463265 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                           ->  Hash  (cost=24907.94..24907.94 rows=429 width=24) (actual time=4029.887..4029.887 rows=686 loops=1)
                                 ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=3827.900..4028.822 rows=686 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=231.932..424.568 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=87.180..90.544 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=144.742..325.654 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=3595.873..3595.873 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=14.643..3498.646 rows=71604 loops=1)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.27 rows=1 width=22) (actual time=3.217..3.219 rows=1 loops=1114)
                           Index Cond: (a1_.id = l1.subjectid)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=4.633..4.634 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 68992.303 ms
(34 rows)

Time: 70466.269 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3182570.64..3182652.50 rows=3638 width=52) (actual time=26695.299..26698.549 rows=949 loops=1)
   ->  Sort  (cost=3182570.64..3182579.74 rows=3638 width=52) (actual time=26695.296..26696.356 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=3156686.91..3182355.47 rows=3638 width=52) (actual time=26466.159..26692.715 rows=1114 loops=1)
               ->  Nested Loop  (cost=3156686.91..3172416.53 rows=3689 width=42) (actual time=26466.116..26676.682 rows=1114 loops=1)
                     ->  Hash Join  (cost=3156686.91..3171361.61 rows=3689 width=24) (actual time=26466.071..26663.135 rows=1114 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=3131773.61..3137936.88 rows=616327 width=24) (actual time=26261.092..26369.545 rows=83765 loops=1)
                                 ->  Merge Join  (cost=2082183.86..3122528.70 rows=616327 width=24) (actual time=9608.461..22295.769 rows=2836464 loops=1)
                                       Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..909501.28 rows=1207483 width=20) (actual time=0.068..1709.819 rows=1262354 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                       ->  Sort  (cost=2082183.86..2088475.24 rows=2516552 width=20) (actual time=9608.369..12440.132 rows=2861394 loops=1)
                                             Sort Key: l2.objectid, l2.bin
                                             Sort Method:  quicksort  Memory: 290747kB
                                             ->  Index Scan using locationbin125__subjecttypeid on locationbin125 l2  (cost=0.00..1814636.42 rows=2516552 width=20) (actual time=0.063..3726.614 rows=2463265 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                           ->  Hash  (cost=24907.94..24907.94 rows=429 width=24) (actual time=204.892..204.892 rows=686 loops=1)
                                 ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=181.681..203.957 rows=686 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.216..14.219 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.148..0.350 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.062..5.281 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=181.381..181.381 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.011..92.177 rows=71604 loops=1)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.27 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=1114)
                           Index Cond: (a1_.id = l1.subjectid)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.009..0.010 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 26730.752 ms
(34 rows)

Time: 26734.488 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3182570.64..3182581.89 rows=500 width=52) (actual time=26781.472..26784.095 rows=500 loops=1)
   ->  Unique  (cost=3182570.64..3182652.50 rows=3638 width=52) (actual time=26781.468..26783.158 rows=500 loops=1)
         ->  Sort  (cost=3182570.64..3182579.74 rows=3638 width=52) (actual time=26781.465..26782.023 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=3156686.91..3182355.47 rows=3638 width=52) (actual time=26553.341..26778.972 rows=1114 loops=1)
                     ->  Nested Loop  (cost=3156686.91..3172416.53 rows=3689 width=42) (actual time=26553.301..26763.333 rows=1114 loops=1)
                           ->  Hash Join  (cost=3156686.91..3171361.61 rows=3689 width=24) (actual time=26553.256..26749.960 rows=1114 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=3131773.61..3137936.88 rows=616327 width=24) (actual time=26349.468..26457.747 rows=83765 loops=1)
                                       ->  Merge Join  (cost=2082183.86..3122528.70 rows=616327 width=24) (actual time=9694.503..22379.555 rows=2836464 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..909501.28 rows=1207483 width=20) (actual time=0.065..1713.634 rows=1262354 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                             ->  Sort  (cost=2082183.86..2088475.24 rows=2516552 width=20) (actual time=9694.415..12558.920 rows=2861394 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 290747kB
                                                   ->  Index Scan using locationbin125__subjecttypeid on locationbin125 l2  (cost=0.00..1814636.42 rows=2516552 width=20) (actual time=0.059..3785.080 rows=2463265 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                 ->  Hash  (cost=24907.94..24907.94 rows=429 width=24) (actual time=203.708..203.708 rows=686 loops=1)
                                       ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=180.707..202.831 rows=686 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.212..14.041 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.145..0.345 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.062..5.099 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=180.455..180.455 rows=71604 loops=1)
                                                   ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.011..91.160 rows=71604 loops=1)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.27 rows=1 width=22) (actual time=0.006..0.008 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.009..0.010 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 26815.579 ms
(35 rows)

Time: 26942.186 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3182570.64..3182581.89 rows=500 width=52) (actual time=26356.820..26359.359 rows=500 loops=1)
   ->  Unique  (cost=3182570.64..3182652.50 rows=3638 width=52) (actual time=26356.817..26358.464 rows=500 loops=1)
         ->  Sort  (cost=3182570.64..3182579.74 rows=3638 width=52) (actual time=26356.813..26357.353 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=3156686.91..3182355.47 rows=3638 width=52) (actual time=26122.826..26354.290 rows=1114 loops=1)
                     ->  Nested Loop  (cost=3156686.91..3172416.53 rows=3689 width=42) (actual time=26122.773..26336.552 rows=1114 loops=1)
                           ->  Hash Join  (cost=3156686.91..3171361.61 rows=3689 width=24) (actual time=26122.720..26321.880 rows=1114 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=3131773.61..3137936.88 rows=616327 width=24) (actual time=25920.893..26034.893 rows=83765 loops=1)
                                       ->  Merge Join  (cost=2082183.86..3122528.70 rows=616327 width=24) (actual time=9694.241..22010.641 rows=2836464 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..909501.28 rows=1207483 width=20) (actual time=0.065..1696.274 rows=1262354 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                             ->  Sort  (cost=2082183.86..2088475.24 rows=2516552 width=20) (actual time=9694.153..12434.386 rows=2861394 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 290747kB
                                                   ->  Index Scan using locationbin125__subjecttypeid on locationbin125 l2  (cost=0.00..1814636.42 rows=2516552 width=20) (actual time=0.059..3780.638 rows=2463265 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                 ->  Hash  (cost=24907.94..24907.94 rows=429 width=24) (actual time=201.742..201.742 rows=686 loops=1)
                                       ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=179.052..200.847 rows=686 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.214..13.943 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.147..0.344 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.061..5.145 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=178.798..178.798 rows=71604 loops=1)
                                                   ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.012..91.278 rows=71604 loops=1)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.27 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.011..0.012 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 26396.927 ms
(35 rows)

Time: 26400.548 ms
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=778344.69..778348.79 rows=149 width=66) (actual time=4814.828..4835.618 rows=6492 loops=1)
   ->  Sort  (cost=778344.69..778345.06 rows=149 width=66) (actual time=4814.825..4821.504 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=777510.72..778339.31 rows=149 width=66) (actual time=3073.446..4797.678 rows=6492 loops=1)
               ->  Nested Loop  (cost=777510.72..778161.10 rows=149 width=55) (actual time=3015.604..4674.900 rows=6492 loops=1)
                     ->  Nested Loop  (cost=777510.72..777972.62 rows=149 width=45) (actual time=3015.394..4064.332 rows=6492 loops=1)
                           ->  Nested Loop  (cost=777510.72..777928.12 rows=153 width=31) (actual time=3015.379..4006.991 rows=6499 loops=1)
                                 ->  Merge Join  (cost=777510.72..777827.73 rows=153 width=12) (actual time=2977.290..3006.821 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=17.929..22.262 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.218..13.253 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.146..0.384 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.065..4.875 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=753066.45..753130.43 rows=25591 width=8) (actual time=2951.099..2961.758 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=750680.94..751192.76 rows=25591 width=8) (actual time=2754.703..2887.677 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=750680.94..750936.85 rows=25591 width=24) (actual time=2754.700..2807.088 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..750297.08 rows=25591 width=24) (actual time=54.691..2617.122 rows=89090 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=35.195..209.710 rows=117445 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=19.359..1183.333 rows=848210 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.64 rows=1 width=23) (actual time=0.148..0.150 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.089..0.090 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.18 rows=1 width=19) (actual time=0.013..0.015 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 4844.750 ms
(39 rows)

Time: 4882.989 ms
                                                                                                               QUERY PLAN                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=778344.69..778348.79 rows=149 width=66) (actual time=3056.231..3076.580 rows=6492 loops=1)
   ->  Sort  (cost=778344.69..778345.06 rows=149 width=66) (actual time=3056.228..3062.662 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=777510.72..778339.31 rows=149 width=66) (actual time=2775.064..3039.363 rows=6492 loops=1)
               ->  Nested Loop  (cost=777510.72..778161.10 rows=149 width=55) (actual time=2775.051..2983.931 rows=6492 loops=1)
                     ->  Nested Loop  (cost=777510.72..777972.62 rows=149 width=45) (actual time=2775.036..2920.447 rows=6492 loops=1)
                           ->  Nested Loop  (cost=777510.72..777928.12 rows=153 width=31) (actual time=2775.022..2864.835 rows=6499 loops=1)
                                 ->  Merge Join  (cost=777510.72..777827.73 rows=153 width=12) (actual time=2774.986..2804.353 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.555..22.906 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.107..13.645 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.200 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.026..4.985 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=753066.45..753130.43 rows=25591 width=8) (actual time=2748.169..2758.666 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=750680.94..751192.76 rows=25591 width=8) (actual time=2553.456..2685.629 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=750680.94..750936.85 rows=25591 width=24) (actual time=2553.453..2605.563 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..750297.08 rows=25591 width=24) (actual time=0.175..2418.425 rows=89090 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=0.019..149.245 rows=117445 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=0.015..1071.831 rows=848210 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.64 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.18 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 3083.197 ms
(39 rows)

Time: 3087.975 ms
                                                                                                                  QUERY PLAN                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=778344.69..778348.79 rows=149 width=66) (actual time=3059.342..3061.848 rows=500 loops=1)
   ->  Unique  (cost=778344.69..778348.79 rows=149 width=66) (actual time=3059.339..3060.883 rows=500 loops=1)
         ->  Sort  (cost=778344.69..778345.06 rows=149 width=66) (actual time=3059.336..3059.821 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=777510.72..778339.31 rows=149 width=66) (actual time=2782.987..3042.281 rows=6492 loops=1)
                     ->  Nested Loop  (cost=777510.72..778161.10 rows=149 width=55) (actual time=2782.974..2987.482 rows=6492 loops=1)
                           ->  Nested Loop  (cost=777510.72..777972.62 rows=149 width=45) (actual time=2782.958..2927.508 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=777510.72..777928.12 rows=153 width=31) (actual time=2782.944..2872.628 rows=6499 loops=1)
                                       ->  Merge Join  (cost=777510.72..777827.73 rows=153 width=12) (actual time=2782.915..2812.376 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.180..22.534 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.107..13.399 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.208 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..4.889 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=753066.45..753130.43 rows=25591 width=8) (actual time=2756.471..2766.983 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=750680.94..751192.76 rows=25591 width=8) (actual time=2562.032..2694.110 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=750680.94..750936.85 rows=25591 width=24) (actual time=2562.029..2614.276 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..750297.08 rows=25591 width=24) (actual time=0.173..2430.343 rows=89090 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=0.019..149.249 rows=117445 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=0.016..1074.972 rows=848210 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.64 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.18 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 3062.602 ms
(40 rows)

Time: 3067.123 ms
                                                                                                                  QUERY PLAN                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=778344.69..778348.79 rows=149 width=66) (actual time=3066.136..3068.645 rows=500 loops=1)
   ->  Unique  (cost=778344.69..778348.79 rows=149 width=66) (actual time=3066.133..3067.693 rows=500 loops=1)
         ->  Sort  (cost=778344.69..778345.06 rows=149 width=66) (actual time=3066.130..3066.619 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=777510.72..778339.31 rows=149 width=66) (actual time=2789.887..3049.147 rows=6492 loops=1)
                     ->  Nested Loop  (cost=777510.72..778161.10 rows=149 width=55) (actual time=2789.874..2994.368 rows=6492 loops=1)
                           ->  Nested Loop  (cost=777510.72..777972.62 rows=149 width=45) (actual time=2789.858..2934.412 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=777510.72..777928.12 rows=153 width=31) (actual time=2789.844..2879.501 rows=6499 loops=1)
                                       ->  Merge Join  (cost=777510.72..777827.73 rows=153 width=12) (actual time=2789.812..2819.254 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.252..22.596 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.106..13.469 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.205 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..4.926 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=753066.45..753130.43 rows=25591 width=8) (actual time=2763.291..2773.762 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=750680.94..751192.76 rows=25591 width=8) (actual time=2567.493..2700.101 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=750680.94..750936.85 rows=25591 width=24) (actual time=2567.490..2619.877 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..750297.08 rows=25591 width=24) (actual time=0.173..2431.277 rows=89090 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=0.018..149.135 rows=117445 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=0.016..1074.823 rows=848210 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.64 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.18 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 3069.390 ms
(40 rows)

Time: 3073.899 ms
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=7778353.30..7778894.55 rows=43300 width=46) (actual time=147223.600..147246.265 rows=7408 loops=1)
   ->  Sort  (cost=7778353.30..7778461.55 rows=43300 width=46) (actual time=147223.595..147230.989 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Hash Join  (cost=7601050.74..7775018.75 rows=43300 width=46) (actual time=143986.173..147206.692 rows=7408 loops=1)
               Hash Cond: (a1_.geneid = a4_.id)
               ->  Hash Join  (cost=7599084.86..7772186.88 rows=43300 width=32) (actual time=143792.073..146988.473 rows=7408 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=7586140.04..7758376.06 rows=43300 width=32) (actual time=143338.731..146389.196 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=7559828.24..7632166.21 rows=7233797 width=24) (actual time=142992.867..144622.849 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=4214469.07..7451321.29 rows=7233797 width=24) (actual time=70864.085..124544.740 rows=12834989 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..1759946.67 rows=2412341 width=20) (actual time=38.273..3531.840 rows=2333531 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=70825.789..87192.713 rows=15175274 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  external sort  Disk: 487648kB
                                             ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=4618.434..23490.796 rows=14672305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=4532.556..4532.556 rows=14672305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=345.805..345.805 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=291.668..336.605 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=4.445..30.708 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.207 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=4.361..17.391 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=287.095..287.095 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=4.397..147.175 rows=103331 loops=1)
                     ->  Hash  (cost=12346.54..12346.54 rows=47863 width=8) (actual time=453.199..453.199 rows=47985 loops=1)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=68.423..380.947 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=66.105..66.105 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=194.033..194.033 rows=48661 loops=1)
                     ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=5.109..131.933 rows=48661 loops=1)
 Total runtime: 147550.282 ms
(41 rows)

Time: 147621.900 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=7778353.30..7778894.55 rows=43300 width=46) (actual time=145379.519..145402.261 rows=7408 loops=1)
   ->  Sort  (cost=7778353.30..7778461.55 rows=43300 width=46) (actual time=145379.514..145386.838 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Hash Join  (cost=7601050.74..7775018.75 rows=43300 width=46) (actual time=142140.425..145362.575 rows=7408 loops=1)
               Hash Cond: (a1_.geneid = a4_.id)
               ->  Hash Join  (cost=7599084.86..7772186.88 rows=43300 width=32) (actual time=142018.661..145216.918 rows=7408 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=7586140.04..7758376.06 rows=43300 width=32) (actual time=141742.811..144794.533 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=7559828.24..7632166.21 rows=7233797 width=24) (actual time=141435.485..143069.941 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=4214469.07..7451321.29 rows=7233797 width=24) (actual time=69656.744..123037.828 rows=12834989 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..1759946.67 rows=2412341 width=20) (actual time=0.072..3335.430 rows=2333531 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69656.650..85929.999 rows=15175274 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  external sort  Disk: 487648kB
                                             ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3624.931..22301.814 rows=14672305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3538.589..3538.589 rows=14672305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=307.277..307.277 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=258.984..298.741 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.161..21.340 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.101..0.299 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.054..7.927 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=258.768..258.768 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..130.566 rows=103331 loops=1)
                     ->  Hash  (cost=12346.54..12346.54 rows=47863 width=8) (actual time=275.745..275.745 rows=47985 loops=1)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.407..214.856 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.600..13.600 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.724..121.724 rows=48661 loops=1)
                     ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.036..62.586 rows=48661 loops=1)
 Total runtime: 145690.936 ms
(41 rows)

Time: 145698.444 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=7778042.35..7778043.60 rows=500 width=46) (actual time=145698.694..145700.126 rows=500 loops=1)
   ->  Sort  (cost=7778042.35..7778150.60 rows=43300 width=46) (actual time=145698.691..145699.175 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=7775451.75..7775884.75 rows=43300 width=46) (actual time=145678.284..145687.265 rows=7408 loops=1)
               ->  Hash Join  (cost=7601050.74..7775018.75 rows=43300 width=46) (actual time=142444.828..145664.214 rows=7408 loops=1)
                     Hash Cond: (a1_.geneid = a4_.id)
                     ->  Hash Join  (cost=7599084.86..7772186.88 rows=43300 width=32) (actual time=142321.734..145517.113 rows=7408 loops=1)
                           Hash Cond: (l1.subjectid = a1_.id)
                           ->  Hash Join  (cost=7586140.04..7758376.06 rows=43300 width=32) (actual time=142047.200..145096.365 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=7559828.24..7632166.21 rows=7233797 width=24) (actual time=141738.790..143373.252 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=4214469.07..7451321.29 rows=7233797 width=24) (actual time=69859.312..123311.240 rows=12834989 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..1759946.67 rows=2412341 width=20) (actual time=0.070..3326.555 rows=2333531 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69859.220..86158.287 rows=15175274 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  external sort  Disk: 487648kB
                                                   ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3748.393..22450.003 rows=14672305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3662.933..3662.933 rows=14672305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=308.362..308.362 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=259.696..299.513 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.160..21.222 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.102..0.303 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.051..7.875 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=259.479..259.479 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..130.221 rows=103331 loops=1)
                           ->  Hash  (cost=12346.54..12346.54 rows=47863 width=8) (actual time=274.397..274.397 rows=47985 loops=1)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.392..213.176 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.620..13.620 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.060..123.060 rows=48661 loops=1)
                           ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.017..63.501 rows=48661 loops=1)
 Total runtime: 145981.384 ms
(42 rows)

Time: 145987.087 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=7778042.35..7778043.60 rows=500 width=46) (actual time=145426.173..145427.607 rows=500 loops=1)
   ->  Sort  (cost=7778042.35..7778150.60 rows=43300 width=46) (actual time=145426.169..145426.650 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=7775451.75..7775884.75 rows=43300 width=46) (actual time=145405.684..145414.722 rows=7408 loops=1)
               ->  Hash Join  (cost=7601050.74..7775018.75 rows=43300 width=46) (actual time=142166.183..145391.576 rows=7408 loops=1)
                     Hash Cond: (a1_.geneid = a4_.id)
                     ->  Hash Join  (cost=7599084.86..7772186.88 rows=43300 width=32) (actual time=142044.133..145245.668 rows=7408 loops=1)
                           Hash Cond: (l1.subjectid = a1_.id)
                           ->  Hash Join  (cost=7586140.04..7758376.06 rows=43300 width=32) (actual time=141768.217..144811.835 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=7559828.24..7632166.21 rows=7233797 width=24) (actual time=141458.334..143080.292 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=4214469.07..7451321.29 rows=7233797 width=24) (actual time=69837.010..123240.679 rows=12834989 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..1759946.67 rows=2412341 width=20) (actual time=0.071..3322.762 rows=2333531 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69836.917..86106.207 rows=15175274 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  external sort  Disk: 487648kB
                                                   ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3770.667..22438.609 rows=14672305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3685.582..3685.582 rows=14672305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=309.836..309.836 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=260.058..301.230 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.159..21.463 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.102..0.298 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.050..7.970 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=259.842..259.842 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..130.224 rows=103331 loops=1)
                           ->  Hash  (cost=12346.54..12346.54 rows=47863 width=8) (actual time=275.809..275.809 rows=47985 loops=1)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.335..214.895 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.545..13.545 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.992..121.992 rows=48661 loops=1)
                           ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..62.588 rows=48661 loops=1)
 Total runtime: 145706.132 ms
(42 rows)

Time: 145713.020 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=4583130.73..4583166.52 rows=2863 width=37) (actual time=105517.297..105518.330 rows=341 loops=1)
   ->  Sort  (cost=4583130.73..4583137.89 rows=2863 width=37) (actual time=105517.294..105517.623 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=4569619.85..4582966.35 rows=2863 width=37) (actual time=104677.998..105516.500 rows=341 loops=1)
               ->  Nested Loop  (cost=4569619.85..4582038.72 rows=2863 width=23) (actual time=104677.967..105511.535 rows=341 loops=1)
                     ->  Hash Join  (cost=4569619.85..4581007.37 rows=2863 width=23) (actual time=104620.389..104995.961 rows=2193 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=4535832.39..4540615.08 rows=478269 width=24) (actual time=104593.648..104802.062 rows=160316 loops=1)
                                 ->  Merge Join  (cost=4214469.07..4528658.35 rows=478269 width=24) (actual time=69047.426..103040.481 rows=1089868 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=0.066..164.061 rows=117445 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                       ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69045.924..85065.218 rows=15155278 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  external sort  Disk: 487648kB
                                             ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3471.466..22043.828 rows=14672305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3386.032..3386.032 rows=14672305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=26.717..26.717 rows=322 loops=1)
                                 ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=17.154..26.267 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=7.665..22.426 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.131..0.335 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=7.526..21.000 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.35 rows=1 width=8) (actual time=0.232..0.233 rows=0 loops=2193)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.009..0.010 rows=1 loops=341)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 105757.574 ms
(36 rows)

Time: 105761.283 ms
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=4583130.73..4583166.52 rows=2863 width=37) (actual time=105076.968..105077.983 rows=341 loops=1)
   ->  Sort  (cost=4583130.73..4583137.89 rows=2863 width=37) (actual time=105076.965..105077.296 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=4569619.85..4582966.35 rows=2863 width=37) (actual time=104666.771..105076.199 rows=341 loops=1)
               ->  Nested Loop  (cost=4569619.85..4582038.72 rows=2863 width=23) (actual time=104666.740..105071.239 rows=341 loops=1)
                     ->  Hash Join  (cost=4569619.85..4581007.37 rows=2863 width=23) (actual time=104665.844..105044.761 rows=2193 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=4535832.39..4540615.08 rows=478269 width=24) (actual time=104659.440..104870.183 rows=160316 loops=1)
                                 ->  Merge Join  (cost=4214469.07..4528658.35 rows=478269 width=24) (actual time=69091.959..103101.837 rows=1089868 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=0.050..164.153 rows=117445 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                       ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69090.467..85123.046 rows=15155278 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  external sort  Disk: 487648kB
                                             ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3470.917..22063.509 rows=14672305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3385.487..3385.487 rows=14672305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=6.380..6.380 rows=322 loops=1)
                                 ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=2.024..5.937 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.194..2.153 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.132..0.340 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.056..0.690 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.35 rows=1 width=8) (actual time=0.009..0.010 rows=0 loops=2193)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.009..0.010 rows=1 loops=341)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 105317.710 ms
(36 rows)

Time: 105321.684 ms
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4583130.73..4583136.98 rows=500 width=37) (actual time=105399.569..105401.259 rows=341 loops=1)
   ->  Unique  (cost=4583130.73..4583166.52 rows=2863 width=37) (actual time=105399.566..105400.598 rows=341 loops=1)
         ->  Sort  (cost=4583130.73..4583137.89 rows=2863 width=37) (actual time=105399.563..105399.896 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=4569619.85..4582966.35 rows=2863 width=37) (actual time=104989.996..105398.791 rows=341 loops=1)
                     ->  Nested Loop  (cost=4569619.85..4582038.72 rows=2863 width=23) (actual time=104989.966..105393.816 rows=341 loops=1)
                           ->  Hash Join  (cost=4569619.85..4581007.37 rows=2863 width=23) (actual time=104989.075..105367.490 rows=2193 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=4535832.39..4540615.08 rows=478269 width=24) (actual time=104982.700..105192.978 rows=160316 loops=1)
                                       ->  Merge Join  (cost=4214469.07..4528658.35 rows=478269 width=24) (actual time=69400.315..103433.612 rows=1089868 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=0.050..163.998 rows=117445 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                             ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69398.810..85458.637 rows=15155278 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  external sort  Disk: 487648kB
                                                   ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3809.404..22387.268 rows=14672305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3723.899..3723.899 rows=14672305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=6.352..6.352 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=1.989..5.908 rows=322 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.191..2.125 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.132..0.338 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.053..0.704 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.35 rows=1 width=8) (actual time=0.009..0.010 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.009..0.010 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 105641.758 ms
(37 rows)

Time: 105645.403 ms
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4583130.73..4583136.98 rows=500 width=37) (actual time=105425.880..105427.537 rows=341 loops=1)
   ->  Unique  (cost=4583130.73..4583166.52 rows=2863 width=37) (actual time=105425.877..105426.895 rows=341 loops=1)
         ->  Sort  (cost=4583130.73..4583137.89 rows=2863 width=37) (actual time=105425.874..105426.206 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=4569619.85..4582966.35 rows=2863 width=37) (actual time=105017.158..105425.108 rows=341 loops=1)
                     ->  Nested Loop  (cost=4569619.85..4582038.72 rows=2863 width=23) (actual time=105017.127..105420.162 rows=341 loops=1)
                           ->  Hash Join  (cost=4569619.85..4581007.37 rows=2863 width=23) (actual time=105016.239..105393.759 rows=2193 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=4535832.39..4540615.08 rows=478269 width=24) (actual time=105009.799..105219.398 rows=160316 loops=1)
                                       ->  Merge Join  (cost=4214469.07..4528658.35 rows=478269 width=24) (actual time=69451.702..103440.287 rows=1089868 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l2  (cost=0.00..140754.97 rows=159494 width=20) (actual time=0.050..163.816 rows=117445 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                             ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69450.213..85469.158 rows=15155278 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  external sort  Disk: 487648kB
                                                   ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3797.500..22346.695 rows=14672305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3712.033..3712.033 rows=14672305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=6.417..6.417 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=2.029..5.964 rows=322 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.195..2.148 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.133..0.344 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.057..0.708 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.35 rows=1 width=8) (actual time=0.009..0.010 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.009..0.010 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 105670.937 ms
(37 rows)

Time: 105674.611 ms
                                                                                                            QUERY PLAN                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=5911995.28..5912424.06 rows=15592 width=82) (actual time=192434.960..192564.300 rows=39884 loops=1)
   ->  Sort  (cost=5911995.28..5912034.26 rows=15592 width=82) (actual time=192434.956..192476.995 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=5822200.81..5910909.41 rows=15592 width=82) (actual time=173434.710..192313.441 rows=39884 loops=1)
               ->  Hash Join  (cost=5822200.81..5891185.44 rows=15592 width=72) (actual time=173434.666..190770.623 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=5820234.93..5888903.02 rows=16063 width=58) (actual time=173313.575..190509.181 rows=40032 loops=1)
                           ->  Hash Join  (cost=5820234.93..5884130.11 rows=16063 width=39) (actual time=173313.518..189308.122 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=5778132.19..5804967.79 rows=2683560 width=24) (actual time=172524.833..179700.971 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=4589168.17..5737878.79 rows=2683560 width=24) (actual time=84160.107..149067.533 rows=15743981 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=0.073..1136.569 rows=804734 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=84159.998..106616.882 rows=20795855 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  external sort  Disk: 558344kB
                                                   ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=7115.588..28503.751 rows=16799189 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=7004.465..7004.465 rows=16799189 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=787.222..787.222 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=88.429..720.729 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=32.979..215.325 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.205..0.321 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=32.766..117.369 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.005..0.006 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.28 rows=1 width=23) (actual time=0.024..0.025 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.054..121.054 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..62.133 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.033..0.034 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 192933.339 ms
(39 rows)

Time: 192946.861 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=5911995.28..5912424.06 rows=15592 width=82) (actual time=189593.514..189722.868 rows=39884 loops=1)
   ->  Sort  (cost=5911995.28..5912034.26 rows=15592 width=82) (actual time=189593.510..189635.975 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=5822200.81..5910909.41 rows=15592 width=82) (actual time=172165.187..189474.388 rows=39884 loops=1)
               ->  Hash Join  (cost=5822200.81..5891185.44 rows=15592 width=72) (actual time=172165.147..189006.878 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=5820234.93..5888903.02 rows=16063 width=58) (actual time=172043.504..188744.652 rows=40032 loops=1)
                           ->  Hash Join  (cost=5820234.93..5884130.11 rows=16063 width=39) (actual time=172043.449..188265.092 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=5778132.19..5804967.79 rows=2683560 width=24) (actual time=171404.983..178744.913 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=4589168.17..5737878.79 rows=2683560 width=24) (actual time=82595.204..147475.404 rows=15743981 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=0.070..1132.097 rows=804734 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=82595.100..105066.741 rows=20795855 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  external sort  Disk: 558344kB
                                                   ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=6310.984..27691.366 rows=16799189 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=6199.919..6199.919 rows=16799189 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=636.994..636.994 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.318..571.495 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.273..156.642 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.207..0.317 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.057..57.770 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.28 rows=1 width=23) (actual time=0.006..0.008 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.604..121.604 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..62.450 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 190096.463 ms
(39 rows)

Time: 190101.771 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5911995.28..5912009.03 rows=500 width=82) (actual time=189861.883..189864.450 rows=500 loops=1)
   ->  Unique  (cost=5911995.28..5912424.06 rows=15592 width=82) (actual time=189861.879..189863.505 rows=500 loops=1)
         ->  Sort  (cost=5911995.28..5912034.26 rows=15592 width=82) (actual time=189861.875..189862.407 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=5822200.81..5910909.41 rows=15592 width=82) (actual time=172392.502..189742.988 rows=39884 loops=1)
                     ->  Hash Join  (cost=5822200.81..5891185.44 rows=15592 width=72) (actual time=172392.460..189264.523 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=5820234.93..5888903.02 rows=16063 width=58) (actual time=172270.468..189001.486 rows=40032 loops=1)
                                 ->  Hash Join  (cost=5820234.93..5884130.11 rows=16063 width=39) (actual time=172270.405..188508.115 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=5778132.19..5804967.79 rows=2683560 width=24) (actual time=171629.093..178965.070 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=4589168.17..5737878.79 rows=2683560 width=24) (actual time=82698.839..147609.143 rows=15743981 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=0.056..1134.269 rows=804734 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=82698.748..105184.270 rows=20795855 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  external sort  Disk: 558344kB
                                                         ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=6271.692..27700.395 rows=16799189 loops=1)
                                                               Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                               ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=6160.716..6160.716 rows=16799189 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=639.839..639.839 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.308..574.214 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.263..156.653 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.202..0.313 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.055..57.704 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.28 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.955..121.955 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..63.087 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.008 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 190200.707 ms
(40 rows)

Time: 190206.065 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5911995.28..5912009.03 rows=500 width=82) (actual time=189763.687..189766.254 rows=500 loops=1)
   ->  Unique  (cost=5911995.28..5912424.06 rows=15592 width=82) (actual time=189763.684..189765.313 rows=500 loops=1)
         ->  Sort  (cost=5911995.28..5912034.26 rows=15592 width=82) (actual time=189763.679..189764.201 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=5822200.81..5910909.41 rows=15592 width=82) (actual time=172325.793..189644.764 rows=39884 loops=1)
                     ->  Hash Join  (cost=5822200.81..5891185.44 rows=15592 width=72) (actual time=172325.751..189169.772 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=5820234.93..5888903.02 rows=16063 width=58) (actual time=172204.261..188907.268 rows=40032 loops=1)
                                 ->  Hash Join  (cost=5820234.93..5884130.11 rows=16063 width=39) (actual time=172204.207..188418.117 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=5778132.19..5804967.79 rows=2683560 width=24) (actual time=171567.862..178899.659 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=4589168.17..5737878.79 rows=2683560 width=24) (actual time=82630.263..147535.740 rows=15743981 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..601434.66 rows=771026 width=20) (actual time=0.055..1136.535 rows=804734 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=82630.173..105126.719 rows=20795855 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  external sort  Disk: 558344kB
                                                         ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=6267.275..27690.944 rows=16799189 loops=1)
                                                               Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                               ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=6156.225..6156.225 rows=16799189 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=634.871..634.871 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.321..569.330 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.277..155.447 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.216..0.331 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.055..57.483 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.28 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.452..121.452 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.036..62.282 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.008 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 190106.444 ms
(40 rows)

Time: 190111.802 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=27878075.43..27881827.96 rows=300202 width=53) (actual time=1575972.800..1576028.669 rows=17651 loops=1)
   ->  Sort  (cost=27878075.43..27878825.94 rows=300202 width=53) (actual time=1575972.796..1575991.143 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=26274506.98..27850763.70 rows=300202 width=53) (actual time=1161611.936..1575892.008 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=26258639.02..27828891.70 rows=300202 width=39) (actual time=1161040.729..1574907.475 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  Unique  (cost=26216536.28..27094196.63 rows=50152020 width=24) (actual time=1160404.803..1525031.695 rows=29345747 loops=1)
                           ->  Sort  (cost=26216536.28..26341916.33 rows=50152020 width=24) (actual time=1160404.799..1354586.562 rows=120034524 loops=1)
                                 Sort Key: l1.subjectid, l2.subjectid, l1.intermine_start, l1.intermine_end, l2.intermine_start, l2.intermine_end
                                 Sort Method:  external merge  Disk: 3989392kB
                                 ->  Merge Join  (cost=8803637.24..19067491.95 rows=50152020 width=24) (actual time=153017.359..596050.873 rows=120034524 loops=1)
                                       Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=69936.218..86341.249 rows=14672305 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  external sort  Disk: 430280kB
                                             ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3569.215..22250.789 rows=14672305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3483.874..3483.874 rows=14672305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                       ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=83081.092..218941.183 rows=124382810 loops=1)
                                             Sort Key: l2.objectid, l2.bin
                                             Sort Method:  external sort  Disk: 558344kB
                                             ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=6415.521..27758.579 rows=16799189 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=6287.377..6287.377 rows=16799189 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=634.837..634.837 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.301..569.452 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.259..155.005 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.199..0.310 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..57.470 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=537.636..537.636 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=137.611..473.762 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.512..213.576 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.717..13.717 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.054..122.054 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.017..62.743 rows=48661 loops=1)
 Total runtime: 1578076.820 ms
(48 rows)

Time: 1578081.333 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=27878075.43..27881827.96 rows=300202 width=53) (actual time=1536425.784..1536480.520 rows=17651 loops=1)
   ->  Sort  (cost=27878075.43..27878825.94 rows=300202 width=53) (actual time=1536425.781..1536444.064 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=26274506.98..27850763.70 rows=300202 width=53) (actual time=1123973.247..1536367.480 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=26258639.02..27828891.70 rows=300202 width=39) (actual time=1123397.336..1535379.978 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  Unique  (cost=26216536.28..27094196.63 rows=50152020 width=24) (actual time=1122755.714..1485516.621 rows=29345747 loops=1)
                           ->  Sort  (cost=26216536.28..26341916.33 rows=50152020 width=24) (actual time=1122755.710..1315270.690 rows=120034524 loops=1)
                                 Sort Key: l1.subjectid, l2.subjectid, l1.intermine_start, l1.intermine_end, l2.intermine_start, l2.intermine_end
                                 Sort Method:  external merge  Disk: 3989392kB
                                 ->  Merge Join  (cost=8803637.24..19067491.95 rows=50152020 width=24) (actual time=148062.050..590907.578 rows=120034524 loops=1)
                                       Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=68022.754..84249.852 rows=14672305 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  external sort  Disk: 430280kB
                                             ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3583.478..22271.733 rows=14672305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3498.168..3498.168 rows=14672305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                       ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=80039.246..215298.577 rows=124382810 loops=1)
                                             Sort Key: l2.objectid, l2.bin
                                             Sort Method:  external sort  Disk: 558344kB
                                             ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=6083.023..27415.847 rows=16799189 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=5968.358..5968.358 rows=16799189 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=640.554..640.554 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.323..574.890 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.275..156.580 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.215..0.329 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.054..57.938 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=542.475..542.475 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=137.460..478.545 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.460..218.880 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.686..13.686 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.957..121.957 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..62.575 rows=48661 loops=1)
 Total runtime: 1538358.666 ms
(48 rows)

Time: 1538363.156 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27871726.48..27871727.73 rows=500 width=53) (actual time=1536836.310..1536837.750 rows=500 loops=1)
   ->  Sort  (cost=27871726.48..27872476.98 rows=300202 width=53) (actual time=1536836.306..1536836.793 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=27853765.72..27856767.74 rows=300202 width=53) (actual time=1536788.125..1536811.133 rows=17651 loops=1)
               ->  Hash Join  (cost=26274506.98..27850763.70 rows=300202 width=53) (actual time=1123860.160..1536727.328 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=26258639.02..27828891.70 rows=300202 width=39) (actual time=1123288.676..1535745.595 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  Unique  (cost=26216536.28..27094196.63 rows=50152020 width=24) (actual time=1122650.470..1485829.952 rows=29345747 loops=1)
                                 ->  Sort  (cost=26216536.28..26341916.33 rows=50152020 width=24) (actual time=1122650.466..1315553.466 rows=120034524 loops=1)
                                       Sort Key: l1.subjectid, l2.subjectid, l1.intermine_start, l1.intermine_end, l2.intermine_start, l2.intermine_end
                                       Sort Method:  external merge  Disk: 3989392kB
                                       ->  Merge Join  (cost=8803637.24..19067491.95 rows=50152020 width=24) (actual time=147230.769..587818.231 rows=120034524 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=67659.116..83885.465 rows=14672305 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  external sort  Disk: 430280kB
                                                   ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3451.125..21888.602 rows=14672305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3365.440..3365.440 rows=14672305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                             ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=79571.604..214186.300 rows=124382810 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  external sort  Disk: 558344kB
                                                   ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=5879.997..26991.884 rows=16799189 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=5769.101..5769.101 rows=16799189 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=637.114..637.114 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.303..571.606 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.260..156.389 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.201..0.312 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..58.495 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=538.077..538.077 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=137.665..473.990 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.501..213.447 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.643..13.643 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.120..122.120 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..62.786 rows=48661 loops=1)
 Total runtime: 1538637.214 ms
(49 rows)

Time: 1538715.375 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27871726.48..27871727.73 rows=500 width=53) (actual time=1535946.723..1535948.146 rows=500 loops=1)
   ->  Sort  (cost=27871726.48..27872476.98 rows=300202 width=53) (actual time=1535946.719..1535947.198 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=27853765.72..27856767.74 rows=300202 width=53) (actual time=1535898.377..1535921.506 rows=17651 loops=1)
               ->  Hash Join  (cost=26274506.98..27850763.70 rows=300202 width=53) (actual time=1123134.916..1535838.040 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=26258639.02..27828891.70 rows=300202 width=39) (actual time=1122562.582..1534854.918 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  Unique  (cost=26216536.28..27094196.63 rows=50152020 width=24) (actual time=1121924.716..1484948.438 rows=29345747 loops=1)
                                 ->  Sort  (cost=26216536.28..26341916.33 rows=50152020 width=24) (actual time=1121924.712..1314696.350 rows=120034524 loops=1)
                                       Sort Key: l1.subjectid, l2.subjectid, l1.intermine_start, l1.intermine_end, l2.intermine_start, l2.intermine_end
                                       Sort Method:  external merge  Disk: 3989392kB
                                       ->  Merge Join  (cost=8803637.24..19067491.95 rows=50152020 width=24) (actual time=147390.011..588436.110 rows=120034524 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Sort  (cost=4214469.07..4250492.59 rows=14409410 width=20) (actual time=67670.471..83899.737 rows=14672305 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  external sort  Disk: 430280kB
                                                   ->  Bitmap Heap Scan on locationbin125 l1  (cost=326587.00..2501153.62 rows=14409410 width=20) (actual time=3449.484..21848.434 rows=14672305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..322984.64 rows=14409410 width=0) (actual time=3363.899..3363.899 rows=14672305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                             ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=79719.490..214379.259 rows=124382810 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  external sort  Disk: 558344kB
                                                   ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=5877.347..27164.879 rows=16799189 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=5766.329..5766.329 rows=16799189 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=636.799..636.799 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.297..571.290 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.253..156.297 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.196..0.305 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.050..57.866 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=538.986..538.986 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=137.203..475.051 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.482..215.500 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.627..13.627 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.678..121.678 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..62.558 rows=48661 loops=1)
 Total runtime: 1537746.697 ms
(49 rows)

Time: 1537824.544 ms
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=5724414.65..5724586.60 rows=68781 width=4) (actual time=1987.075..1987.211 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=5527445.57..5718888.19 rows=68781 width=4) (actual time=657.503..1986.850 rows=118 loops=1)
         ->  HashAggregate  (cost=5527445.57..5528133.38 rows=68781 width=24) (actual time=600.778..601.344 rows=120 loops=1)
               ->  Nested Loop  (cost=0.00..5526413.85 rows=68781 width=24) (actual time=116.552..594.165 rows=4706 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin125__subjectid on locationbin125 l1  (cost=0.00..1279.62 rows=1909 width=20) (actual time=78.853..78.890 rows=29 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Index Scan using locationbin125__bin on locationbin125 l2  (cost=0.00..2856.00 rows=1913 width=20) (actual time=0.376..16.532 rows=916 loops=29)
                           Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..2.75 rows=1 width=4) (actual time=11.508..11.541 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 1987.762 ms
(14 rows)

Time: 2002.776 ms
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=5724414.65..5724586.60 rows=68781 width=4) (actual time=76.783..76.902 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=5527445.57..5718888.19 rows=68781 width=4) (actual time=74.860..76.607 rows=118 loops=1)
         ->  HashAggregate  (cost=5527445.57..5528133.38 rows=68781 width=24) (actual time=74.845..75.354 rows=120 loops=1)
               ->  Nested Loop  (cost=0.00..5526413.85 rows=68781 width=24) (actual time=0.092..68.443 rows=4706 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin125__subjectid on locationbin125 l1  (cost=0.00..1279.62 rows=1909 width=20) (actual time=0.025..0.065 rows=29 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Index Scan using locationbin125__bin on locationbin125 l2  (cost=0.00..2856.00 rows=1913 width=20) (actual time=0.010..1.106 rows=916 loops=29)
                           Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..2.75 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 77.436 ms
(14 rows)

Time: 78.574 ms
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5534347.64..5536906.83 rows=500 width=4) (actual time=85.040..19790.016 rows=118 loops=1)
   ->  Merge Join  (cost=5534347.64..5886394.75 rows=68781 width=4) (actual time=85.037..19789.701 rows=118 loops=1)
         Merge Cond: (a1_.id = l.lid2)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..335098.61 rows=6366713 width=4) (actual time=4.216..13205.031 rows=5971604 loops=1)
         ->  Sort  (cost=5534347.64..5534519.60 rows=68781 width=4) (actual time=76.028..76.283 rows=120 loops=1)
               Sort Key: l.lid2
               Sort Method:  quicksort  Memory: 30kB
               ->  Subquery Scan l  (cost=5527445.57..5528821.19 rows=68781 width=4) (actual time=75.115..75.858 rows=120 loops=1)
                     ->  HashAggregate  (cost=5527445.57..5528133.38 rows=68781 width=24) (actual time=75.113..75.624 rows=120 loops=1)
                           ->  Nested Loop  (cost=0.00..5526413.85 rows=68781 width=24) (actual time=0.082..68.580 rows=4706 loops=1)
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                                 ->  Index Scan using locationbin125__subjectid on locationbin125 l1  (cost=0.00..1279.62 rows=1909 width=20) (actual time=0.018..0.053 rows=29 loops=1)
                                       Index Cond: (232042548 = subjectid)
                                 ->  Index Scan using locationbin125__bin on locationbin125 l2  (cost=0.00..2856.00 rows=1913 width=20) (actual time=0.010..1.106 rows=916 loops=29)
                                       Index Cond: (l2.bin = l1.bin)
 Total runtime: 19790.645 ms
(16 rows)

Time: 19791.892 ms
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5534347.64..5536906.83 rows=500 width=4) (actual time=78.527..14478.179 rows=118 loops=1)
   ->  Merge Join  (cost=5534347.64..5886394.75 rows=68781 width=4) (actual time=78.525..14477.872 rows=118 loops=1)
         Merge Cond: (a1_.id = l.lid2)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..335098.61 rows=6366713 width=4) (actual time=0.079..7898.766 rows=5971604 loops=1)
         ->  Sort  (cost=5534347.64..5534519.60 rows=68781 width=4) (actual time=78.322..78.503 rows=120 loops=1)
               Sort Key: l.lid2
               Sort Method:  quicksort  Memory: 30kB
               ->  Subquery Scan l  (cost=5527445.57..5528821.19 rows=68781 width=4) (actual time=77.374..78.157 rows=120 loops=1)
                     ->  HashAggregate  (cost=5527445.57..5528133.38 rows=68781 width=24) (actual time=77.371..77.920 rows=120 loops=1)
                           ->  Nested Loop  (cost=0.00..5526413.85 rows=68781 width=24) (actual time=0.220..70.809 rows=4706 loops=1)
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                                 ->  Index Scan using locationbin125__subjectid on locationbin125 l1  (cost=0.00..1279.62 rows=1909 width=20) (actual time=0.064..0.101 rows=29 loops=1)
                                       Index Cond: (232042548 = subjectid)
                                 ->  Index Scan using locationbin125__bin on locationbin125 l2  (cost=0.00..2856.00 rows=1913 width=20) (actual time=0.012..1.181 rows=916 loops=29)
                                       Index Cond: (l2.bin = l1.bin)
 Total runtime: 14478.752 ms
(16 rows)

Time: 14480.057 ms
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=3220542.93..3222085.99 rows=617222 width=46) (actual time=23239.964..23375.715 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=3124146.96..3161180.28 rows=617222 width=46) (actual time=21924.078..22819.513 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=3119819.01..3144507.89 rows=617222 width=22) (actual time=21664.157..22191.794 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=3117853.14..3124025.36 rows=617222 width=24) (actual time=21541.515..21717.008 rows=129835 loops=1)
                     ->  Merge Join  (cost=2105920.31..3108594.81 rows=617222 width=24) (actual time=10031.428..19185.367 rows=1648425 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..871915.92 rows=1154230 width=20) (actual time=0.081..907.588 rows=677008 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=2105920.31..2112344.34 rows=2569612 width=20) (actual time=10031.283..12643.752 rows=2607958 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 294991kB
                                 ->  Bitmap Heap Scan on locationbin125 l2  (cost=57982.81..1832345.04 rows=2569612 width=20) (actual time=910.841..4076.447 rows=2517586 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..57340.41 rows=2569612 width=0) (actual time=901.086..901.086 rows=2517586 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.584..122.584 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.758 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=259.856..259.856 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.035..130.157 rows=103331 loops=1)
 Total runtime: 23524.630 ms
(25 rows)

Time: 23537.269 ms
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=3220542.93..3222085.99 rows=617222 width=46) (actual time=22849.731..22985.533 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=3124146.96..3161180.28 rows=617222 width=46) (actual time=21531.907..22428.888 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=3119819.01..3144507.89 rows=617222 width=22) (actual time=21270.400..21798.979 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=3117853.14..3124025.36 rows=617222 width=24) (actual time=21149.102..21324.992 rows=129835 loops=1)
                     ->  Merge Join  (cost=2105920.31..3108594.81 rows=617222 width=24) (actual time=9667.908..18797.843 rows=1648425 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..871915.92 rows=1154230 width=20) (actual time=0.062..905.381 rows=677008 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=2105920.31..2112344.34 rows=2569612 width=20) (actual time=9667.781..12269.877 rows=2607958 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 294991kB
                                 ->  Bitmap Heap Scan on locationbin125 l2  (cost=57982.81..1832345.04 rows=2569612 width=20) (actual time=596.029..3729.480 rows=2517586 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..57340.41 rows=2569612 width=0) (actual time=586.296..586.296 rows=2517586 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.240..121.240 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.101 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=261.442..261.442 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.035..131.317 rows=103331 loops=1)
 Total runtime: 23134.414 ms
(25 rows)

Time: 23136.282 ms
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3191935.79..3191937.04 rows=500 width=46) (actual time=22622.481..22623.917 rows=500 loops=1)
   ->  Sort  (cost=3191935.79..3193478.84 rows=617222 width=46) (actual time=22622.478..22622.947 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=3124146.96..3161180.28 rows=617222 width=46) (actual time=21539.769..22440.449 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=3119819.01..3144507.89 rows=617222 width=22) (actual time=21281.836..21812.703 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=3117853.14..3124025.36 rows=617222 width=24) (actual time=21159.809..21336.234 rows=129835 loops=1)
                           ->  Merge Join  (cost=2105920.31..3108594.81 rows=617222 width=24) (actual time=9732.569..18823.502 rows=1648425 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..871915.92 rows=1154230 width=20) (actual time=0.064..905.309 rows=677008 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=2105920.31..2112344.34 rows=2569612 width=20) (actual time=9732.441..12318.987 rows=2607958 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 294991kB
                                       ->  Bitmap Heap Scan on locationbin125 l2  (cost=57982.81..1832345.04 rows=2569612 width=20) (actual time=642.937..3785.177 rows=2517586 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..57340.41 rows=2569612 width=0) (actual time=633.058..633.058 rows=2517586 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.970..121.970 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.230 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=257.869..257.869 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.035..129.390 rows=103331 loops=1)
 Total runtime: 22648.722 ms
(26 rows)

Time: 22650.610 ms
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3191935.79..3191937.04 rows=500 width=46) (actual time=22613.359..22614.795 rows=500 loops=1)
   ->  Sort  (cost=3191935.79..3193478.84 rows=617222 width=46) (actual time=22613.356..22613.838 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=3124146.96..3161180.28 rows=617222 width=46) (actual time=21529.177..22431.947 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=3119819.01..3144507.89 rows=617222 width=22) (actual time=21271.342..21803.497 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=3117853.14..3124025.36 rows=617222 width=24) (actual time=21149.017..21325.569 rows=129835 loops=1)
                           ->  Merge Join  (cost=2105920.31..3108594.81 rows=617222 width=24) (actual time=9723.061..18817.386 rows=1648425 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..871915.92 rows=1154230 width=20) (actual time=0.062..906.324 rows=677008 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=2105920.31..2112344.34 rows=2569612 width=20) (actual time=9722.936..12311.335 rows=2607958 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 294991kB
                                       ->  Bitmap Heap Scan on locationbin125 l2  (cost=57982.81..1832345.04 rows=2569612 width=20) (actual time=641.876..3788.504 rows=2517586 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..57340.41 rows=2569612 width=0) (actual time=632.161..632.161 rows=2517586 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.261..122.261 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.611 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=257.771..257.771 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.035..129.936 rows=103331 loops=1)
 Total runtime: 22639.670 ms
(26 rows)

Time: 22641.565 ms
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=6645860.63..6653393.07 rows=3012979 width=135) (actual time=149799.059..150701.389 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=6122012.66..6321622.52 rows=3012979 width=135) (actual time=138529.315..145017.552 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=5918516.19..6050334.02 rows=3012979 width=49) (actual time=126788.059..130369.004 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=5917060.14..5947189.93 rows=3012979 width=24) (actual time=126671.721..127910.632 rows=800907 loops=1)
                     ->  Merge Join  (cost=4589168.17..5871865.45 rows=3012979 width=24) (actual time=83001.617..123625.267 rows=1969347 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..668240.67 rows=865673 width=20) (actual time=31.715..1348.828 rows=849579 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=82969.866..100782.476 rows=16792979 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  external sort  Disk: 558344kB
                                 ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=5940.809..27359.800 rows=16799189 loops=1)
                                       Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=5821.676..5821.676 rows=16799189 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=116.277..116.277 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=4.968..71.084 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11740.397..11740.397 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=2.998..5735.832 rows=4025132 loops=1)
 Total runtime: 151837.867 ms
(25 rows)

Time: 151845.134 ms
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=6645860.63..6653393.07 rows=3012979 width=135) (actual time=149467.355..150367.251 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=6122012.66..6321622.52 rows=3012979 width=135) (actual time=138132.670..144618.308 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=5918516.19..6050334.02 rows=3012979 width=49) (actual time=126902.160..130481.989 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=5917060.14..5947189.93 rows=3012979 width=24) (actual time=126811.697..128050.594 rows=800907 loops=1)
                     ->  Merge Join  (cost=4589168.17..5871865.45 rows=3012979 width=24) (actual time=83294.128..123779.696 rows=1969347 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..668240.67 rows=865673 width=20) (actual time=0.069..1204.666 rows=849579 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=83294.024..101105.802 rows=16792979 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  external sort  Disk: 558344kB
                                 ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=5964.047..27354.994 rows=16799189 loops=1)
                                       Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=5848.604..5848.604 rows=16799189 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=90.415..90.415 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..45.314 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11229.653..11229.653 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.039..5256.222 rows=4025132 loops=1)
 Total runtime: 151453.197 ms
(25 rows)

Time: 151516.860 ms
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=6471756.01..6471757.26 rows=500 width=135) (actual time=145710.852..145712.281 rows=500 loops=1)
   ->  Sort  (cost=6471756.01..6479288.46 rows=3012979 width=135) (actual time=145710.848..145711.328 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=6122012.66..6321622.52 rows=3012979 width=135) (actual time=137976.664..144462.612 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=5918516.19..6050334.02 rows=3012979 width=49) (actual time=126907.175..130479.421 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=5917060.14..5947189.93 rows=3012979 width=24) (actual time=126815.978..128050.018 rows=800907 loops=1)
                           ->  Merge Join  (cost=4589168.17..5871865.45 rows=3012979 width=24) (actual time=83330.274..123774.795 rows=1969347 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..668240.67 rows=865673 width=20) (actual time=0.065..1204.857 rows=849579 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=83330.174..101098.422 rows=16792979 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  external sort  Disk: 558344kB
                                       ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=6063.087..27415.874 rows=16799189 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                             ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=5944.922..5944.922 rows=16799189 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=91.150..91.150 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..45.433 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11068.633..11068.633 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.037..5206.917 rows=4025132 loops=1)
 Total runtime: 146011.544 ms
(26 rows)

Time: 146076.418 ms
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=6471756.01..6471757.26 rows=500 width=135) (actual time=145579.175..145580.598 rows=500 loops=1)
   ->  Sort  (cost=6471756.01..6479288.46 rows=3012979 width=135) (actual time=145579.172..145579.649 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=6122012.66..6321622.52 rows=3012979 width=135) (actual time=137853.121..144337.099 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=5918516.19..6050334.02 rows=3012979 width=49) (actual time=126738.166..130307.985 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=5917060.14..5947189.93 rows=3012979 width=24) (actual time=126647.163..127880.326 rows=800907 loops=1)
                           ->  Merge Join  (cost=4589168.17..5871865.45 rows=3012979 width=24) (actual time=83174.147..123613.533 rows=1969347 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin125__subjectobjectbin on locationbin125 l1  (cost=0.00..668240.67 rows=865673 width=20) (actual time=0.080..1203.540 rows=849579 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Sort  (cost=4589168.17..4630980.16 rows=16724796 width=20) (actual time=83174.032..100941.173 rows=16792979 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  external sort  Disk: 558344kB
                                       ->  Bitmap Heap Scan on locationbin125 l2  (cost=379061.24..2582570.19 rows=16724796 width=20) (actual time=5960.701..27276.374 rows=16799189 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                             ->  Bitmap Index Scan on locationbin125__subjecttypeid  (cost=0.00..374880.04 rows=16724796 width=0) (actual time=5844.849..5844.849 rows=16799189 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=90.956..90.956 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.016..45.244 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11114.097..11114.097 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.037..5237.640 rows=4025132 loops=1)
 Total runtime: 145879.370 ms
(26 rows)

Time: 145943.589 ms
