Testing with size 2000
Timing is on.
SELECT
Time: 235020.169 ms
CREATE INDEX
Time: 24258.642 ms
CREATE INDEX
Time: 100977.392 ms
CREATE INDEX
Time: 23694.572 ms
CREATE INDEX
Time: 23538.175 ms
ANALYZE
Time: 2155.072 ms
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=272259.55..272263.55 rows=178 width=52) (actual time=3446.849..3450.134 rows=949 loops=1)
   ->  Sort  (cost=272259.55..272259.99 rows=178 width=52) (actual time=3446.846..3447.933 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=249824.03..272252.89 rows=178 width=52) (actual time=3385.967..3444.344 rows=1114 loops=1)
               ->  Nested Loop  (cost=249824.03..271765.24 rows=181 width=42) (actual time=3385.898..3426.796 rows=1114 loops=1)
                     ->  Hash Join  (cost=249824.03..271702.00 rows=181 width=24) (actual time=3385.796..3413.048 rows=1114 loops=1)
                           Hash Cond: (indirect1.bioentities = a2_.id)
                           ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.236..14.360 rows=4248 loops=1)
                                 ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.153..0.400 rows=1 loops=1)
                                       Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                 ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.077..5.428 rows=4248 loops=1)
                                       Index Cond: (indirect1.datasets = a3_.id)
                           ->  Hash  (cost=249447.03..249447.03 rows=30160 width=28) (actual time=3385.534..3385.534 rows=83765 loops=1)
                                 ->  Hash Join  (cost=248127.53..249447.03 rows=30160 width=28) (actual time=2905.045..3272.566 rows=83765 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=245334.44..245636.04 rows=30160 width=24) (actual time=2723.462..2831.811 rows=83765 loops=1)
                                             ->  Merge Join  (cost=237864.55..244882.04 rows=30160 width=24) (actual time=1093.911..2341.734 rows=256445 loops=1)
                                                   Merge Cond: ((l1.bin = l2.bin) AND (l1.objectid = l2.objectid))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Sort  (cost=95536.16..95839.51 rows=121337 width=20) (actual time=412.262..538.580 rows=123813 loops=1)
                                                         Sort Key: l1.bin, l1.objectid
                                                         Sort Method:  quicksort  Memory: 12745kB
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.111..184.461 rows=123813 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Sort  (cost=142328.38..142839.30 rows=204368 width=20) (actual time=681.625..1000.169 rows=317186 loops=1)
                                                         Sort Key: l2.bin, l2.objectid
                                                         Sort Method:  quicksort  Memory: 22174kB
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..124302.30 rows=204368 width=20) (actual time=0.106..310.129 rows=205176 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=181.543..181.543 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.014..94.253 rows=71604 loops=1)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.34 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=1114)
                           Index Cond: (a1_.id = l1.subjectid)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.010..0.011 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3455.783 ms
(37 rows)

Time: 3473.398 ms
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=272259.55..272263.55 rows=178 width=52) (actual time=3364.494..3367.744 rows=949 loops=1)
   ->  Sort  (cost=272259.55..272259.99 rows=178 width=52) (actual time=3364.491..3365.562 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=249824.03..272252.89 rows=178 width=52) (actual time=3316.023..3362.096 rows=1114 loops=1)
               ->  Nested Loop  (cost=249824.03..271765.24 rows=181 width=42) (actual time=3316.008..3351.872 rows=1114 loops=1)
                     ->  Hash Join  (cost=249824.03..271702.00 rows=181 width=24) (actual time=3315.972..3342.191 rows=1114 loops=1)
                           Hash Cond: (indirect1.bioentities = a2_.id)
                           ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.107..13.721 rows=4248 loops=1)
                                 ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.214 rows=1 loops=1)
                                       Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                 ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.026..5.112 rows=4248 loops=1)
                                       Index Cond: (indirect1.datasets = a3_.id)
                           ->  Hash  (cost=249447.03..249447.03 rows=30160 width=28) (actual time=3315.839..3315.839 rows=83765 loops=1)
                                 ->  Hash Join  (cost=248127.53..249447.03 rows=30160 width=28) (actual time=2837.081..3203.624 rows=83765 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=245334.44..245636.04 rows=30160 width=24) (actual time=2658.974..2766.833 rows=83765 loops=1)
                                             ->  Merge Join  (cost=237864.55..244882.04 rows=30160 width=24) (actual time=1045.502..2289.055 rows=256445 loops=1)
                                                   Merge Cond: ((l1.bin = l2.bin) AND (l1.objectid = l2.objectid))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Sort  (cost=95536.16..95839.51 rows=121337 width=20) (actual time=391.607..517.447 rows=123813 loops=1)
                                                         Sort Key: l1.bin, l1.objectid
                                                         Sort Method:  quicksort  Memory: 12745kB
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.026..168.211 rows=123813 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Sort  (cost=142328.38..142839.30 rows=204368 width=20) (actual time=653.872..971.404 rows=317186 loops=1)
                                                         Sort Key: l2.bin, l2.objectid
                                                         Sort Method:  quicksort  Memory: 22174kB
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..124302.30 rows=204368 width=20) (actual time=0.041..283.109 rows=205176 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=178.070..178.070 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.003..91.582 rows=71604 loops=1)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.34 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                           Index Cond: (a1_.id = l1.subjectid)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3373.355 ms
(37 rows)

Time: 3378.712 ms
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=272259.55..272263.55 rows=178 width=52) (actual time=3372.549..3375.198 rows=500 loops=1)
   ->  Unique  (cost=272259.55..272263.55 rows=178 width=52) (actual time=3372.547..3374.243 rows=500 loops=1)
         ->  Sort  (cost=272259.55..272259.99 rows=178 width=52) (actual time=3372.544..3373.094 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=249824.03..272252.89 rows=178 width=52) (actual time=3323.784..3370.128 rows=1114 loops=1)
                     ->  Nested Loop  (cost=249824.03..271765.24 rows=181 width=42) (actual time=3323.768..3359.793 rows=1114 loops=1)
                           ->  Hash Join  (cost=249824.03..271702.00 rows=181 width=24) (actual time=3323.732..3350.046 rows=1114 loops=1)
                                 Hash Cond: (indirect1.bioentities = a2_.id)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.107..13.753 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.215 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.026..5.041 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Hash  (cost=249447.03..249447.03 rows=30160 width=28) (actual time=3323.570..3323.570 rows=83765 loops=1)
                                       ->  Hash Join  (cost=248127.53..249447.03 rows=30160 width=28) (actual time=2840.313..3210.538 rows=83765 loops=1)
                                             Hash Cond: (l2.subjectid = a2_.id)
                                             ->  HashAggregate  (cost=245334.44..245636.04 rows=30160 width=24) (actual time=2664.043..2772.744 rows=83765 loops=1)
                                                   ->  Merge Join  (cost=237864.55..244882.04 rows=30160 width=24) (actual time=1043.968..2283.934 rows=256445 loops=1)
                                                         Merge Cond: ((l1.bin = l2.bin) AND (l1.objectid = l2.objectid))
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Sort  (cost=95536.16..95839.51 rows=121337 width=20) (actual time=391.029..517.309 rows=123813 loops=1)
                                                               Sort Key: l1.bin, l1.objectid
                                                               Sort Method:  quicksort  Memory: 12745kB
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.025..167.860 rows=123813 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                         ->  Sort  (cost=142328.38..142839.30 rows=204368 width=20) (actual time=652.916..971.201 rows=317186 loops=1)
                                                               Sort Key: l2.bin, l2.objectid
                                                               Sort Method:  quicksort  Memory: 22174kB
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..124302.30 rows=204368 width=20) (actual time=0.039..283.234 rows=205176 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                             ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=176.232..176.232 rows=71604 loops=1)
                                                   ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.002..90.087 rows=71604 loops=1)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.34 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3380.397 ms
(38 rows)

Time: 3385.880 ms
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=272259.55..272263.55 rows=178 width=52) (actual time=3378.027..3380.661 rows=500 loops=1)
   ->  Unique  (cost=272259.55..272263.55 rows=178 width=52) (actual time=3378.025..3379.714 rows=500 loops=1)
         ->  Sort  (cost=272259.55..272259.99 rows=178 width=52) (actual time=3378.021..3378.572 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=249824.03..272252.89 rows=178 width=52) (actual time=3329.377..3375.609 rows=1114 loops=1)
                     ->  Nested Loop  (cost=249824.03..271765.24 rows=181 width=42) (actual time=3329.362..3365.318 rows=1114 loops=1)
                           ->  Hash Join  (cost=249824.03..271702.00 rows=181 width=24) (actual time=3329.327..3355.598 rows=1114 loops=1)
                                 Hash Cond: (indirect1.bioentities = a2_.id)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.106..13.709 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.214 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.026..5.061 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Hash  (cost=249447.03..249447.03 rows=30160 width=28) (actual time=3329.193..3329.193 rows=83765 loops=1)
                                       ->  Hash Join  (cost=248127.53..249447.03 rows=30160 width=28) (actual time=2846.465..3216.033 rows=83765 loops=1)
                                             Hash Cond: (l2.subjectid = a2_.id)
                                             ->  HashAggregate  (cost=245334.44..245636.04 rows=30160 width=24) (actual time=2669.482..2778.397 rows=83765 loops=1)
                                                   ->  Merge Join  (cost=237864.55..244882.04 rows=30160 width=24) (actual time=1047.792..2292.632 rows=256445 loops=1)
                                                         Merge Cond: ((l1.bin = l2.bin) AND (l1.objectid = l2.objectid))
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Sort  (cost=95536.16..95839.51 rows=121337 width=20) (actual time=393.029..519.670 rows=123813 loops=1)
                                                               Sort Key: l1.bin, l1.objectid
                                                               Sort Method:  quicksort  Memory: 12745kB
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.026..168.964 rows=123813 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                         ->  Sort  (cost=142328.38..142839.30 rows=204368 width=20) (actual time=654.740..972.763 rows=317186 loops=1)
                                                               Sort Key: l2.bin, l2.objectid
                                                               Sort Method:  quicksort  Memory: 22174kB
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..124302.30 rows=204368 width=20) (actual time=0.042..283.455 rows=205176 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                             ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=176.947..176.947 rows=71604 loops=1)
                                                   ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.003..90.402 rows=71604 loops=1)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.34 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3385.835 ms
(38 rows)

Time: 3391.255 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=181043.98..181045.13 rows=42 width=66) (actual time=1081.051..1101.468 rows=6492 loops=1)
   ->  Sort  (cost=181043.98..181044.08 rows=42 width=66) (actual time=1081.048..1087.511 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=180590.76..181042.85 rows=42 width=66) (actual time=788.636..1063.970 rows=6492 loops=1)
               ->  Nested Loop  (cost=180590.76..180946.11 rows=42 width=55) (actual time=788.570..1007.821 rows=6492 loops=1)
                     ->  Nested Loop  (cost=180590.76..180892.98 rows=42 width=45) (actual time=788.546..942.194 rows=6492 loops=1)
                           ->  Nested Loop  (cost=180590.76..180880.48 rows=43 width=31) (actual time=788.531..886.076 rows=6499 loops=1)
                                 ->  Merge Join  (cost=180590.76..180814.42 rows=43 width=12) (actual time=788.412..817.935 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.208..22.546 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.104..13.382 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.198 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.023..4.869 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=156146.49..156164.34 rows=7142 width=8) (actual time=761.927..772.612 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=155546.48..155689.32 rows=7142 width=8) (actual time=563.014..697.190 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=155546.48..155617.90 rows=7142 width=24) (actual time=563.011..617.008 rows=41453 loops=1)
                                                         ->  Nested Loop  (cost=0.00..155439.35 rows=7142 width=24) (actual time=0.140..488.882 rows=43991 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.082..26.770 rows=18701 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..6.83 rows=1 width=20) (actual time=0.010..0.015 rows=4 loops=18701)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.Exon'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.52 rows=1 width=23) (actual time=0.005..0.006 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.005..0.006 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.29 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 1107.872 ms
(38 rows)

Time: 1114.071 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=181043.98..181045.13 rows=42 width=66) (actual time=1016.745..1036.918 rows=6492 loops=1)
   ->  Sort  (cost=181043.98..181044.08 rows=42 width=66) (actual time=1016.741..1023.214 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=180590.76..181042.85 rows=42 width=66) (actual time=741.297..999.857 rows=6492 loops=1)
               ->  Nested Loop  (cost=180590.76..180946.11 rows=42 width=55) (actual time=741.283..944.642 rows=6492 loops=1)
                     ->  Nested Loop  (cost=180590.76..180892.98 rows=42 width=45) (actual time=741.268..884.848 rows=6492 loops=1)
                           ->  Nested Loop  (cost=180590.76..180880.48 rows=43 width=31) (actual time=741.255..830.061 rows=6499 loops=1)
                                 ->  Merge Join  (cost=180590.76..180814.42 rows=43 width=12) (actual time=741.221..770.703 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.314..22.666 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.104..13.521 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.198 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..4.994 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=156146.49..156164.34 rows=7142 width=8) (actual time=714.639..725.228 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=155546.48..155689.32 rows=7142 width=8) (actual time=518.450..651.528 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=155546.48..155617.90 rows=7142 width=24) (actual time=518.448..571.519 rows=41453 loops=1)
                                                         ->  Nested Loop  (cost=0.00..155439.35 rows=7142 width=24) (actual time=0.046..446.794 rows=43991 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.024..23.956 rows=18701 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..6.83 rows=1 width=20) (actual time=0.008..0.013 rows=4 loops=18701)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.Exon'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.52 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.29 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 1043.230 ms
(38 rows)

Time: 1047.966 ms
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=181043.98..181045.13 rows=42 width=66) (actual time=1021.004..1023.541 rows=500 loops=1)
   ->  Unique  (cost=181043.98..181045.13 rows=42 width=66) (actual time=1021.001..1022.607 rows=500 loops=1)
         ->  Sort  (cost=181043.98..181044.08 rows=42 width=66) (actual time=1020.998..1021.485 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=180590.76..181042.85 rows=42 width=66) (actual time=743.775..1004.095 rows=6492 loops=1)
                     ->  Nested Loop  (cost=180590.76..180946.11 rows=42 width=55) (actual time=743.762..948.410 rows=6492 loops=1)
                           ->  Nested Loop  (cost=180590.76..180892.98 rows=42 width=45) (actual time=743.747..888.016 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=180590.76..180880.48 rows=43 width=31) (actual time=743.733..832.747 rows=6499 loops=1)
                                       ->  Merge Join  (cost=180590.76..180814.42 rows=43 width=12) (actual time=743.700..773.027 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.135..22.452 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.105..13.353 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.196 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.026..4.908 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=156146.49..156164.34 rows=7142 width=8) (actual time=717.301..727.906 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=155546.48..155689.32 rows=7142 width=8) (actual time=521.308..654.622 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=155546.48..155617.90 rows=7142 width=24) (actual time=521.304..574.575 rows=41453 loops=1)
                                                               ->  Nested Loop  (cost=0.00..155439.35 rows=7142 width=24) (actual time=0.046..449.885 rows=43991 loops=1)
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.023..24.116 rows=18701 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..6.83 rows=1 width=20) (actual time=0.008..0.013 rows=4 loops=18701)
                                                                           Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.Exon'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.52 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.29 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 1024.212 ms
(39 rows)

Time: 1029.006 ms
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=181043.98..181045.13 rows=42 width=66) (actual time=1025.964..1028.467 rows=500 loops=1)
   ->  Unique  (cost=181043.98..181045.13 rows=42 width=66) (actual time=1025.962..1027.511 rows=500 loops=1)
         ->  Sort  (cost=181043.98..181044.08 rows=42 width=66) (actual time=1025.958..1026.446 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=180590.76..181042.85 rows=42 width=66) (actual time=750.897..1009.201 rows=6492 loops=1)
                     ->  Nested Loop  (cost=180590.76..180946.11 rows=42 width=55) (actual time=750.883..954.323 rows=6492 loops=1)
                           ->  Nested Loop  (cost=180590.76..180892.98 rows=42 width=45) (actual time=750.869..894.517 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=180590.76..180880.48 rows=43 width=31) (actual time=750.855..839.562 rows=6499 loops=1)
                                       ->  Merge Join  (cost=180590.76..180814.42 rows=43 width=12) (actual time=750.822..780.236 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.288..22.590 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.104..13.461 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.074..0.197 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..4.914 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=156146.49..156164.34 rows=7142 width=8) (actual time=724.261..734.871 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=155546.48..155689.32 rows=7142 width=8) (actual time=527.995..661.464 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=155546.48..155617.90 rows=7142 width=24) (actual time=527.992..581.149 rows=41453 loops=1)
                                                               ->  Nested Loop  (cost=0.00..155439.35 rows=7142 width=24) (actual time=0.046..456.668 rows=43991 loops=1)
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.023..24.138 rows=18701 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..6.83 rows=1 width=20) (actual time=0.009..0.014 rows=4 loops=18701)
                                                                           Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.Exon'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.52 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.29 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 1029.149 ms
(39 rows)

Time: 1033.931 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=622828.06..622857.83 rows=2381 width=46) (actual time=20352.324..20375.142 rows=7408 loops=1)
   ->  Sort  (cost=622828.06..622834.02 rows=2381 width=46) (actual time=20352.320..20359.713 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Nested Loop  (cost=611570.13..622694.52 rows=2381 width=46) (actual time=16482.806..20334.709 rows=7408 loops=1)
               ->  Nested Loop  (cost=611570.13..621921.32 rows=2381 width=32) (actual time=16482.791..20256.891 rows=7408 loops=1)
                     ->  Hash Join  (cost=611570.13..621042.50 rows=2381 width=32) (actual time=16482.522..19527.306 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=585258.34..589236.67 rows=397833 width=24) (actual time=16159.421..17702.348 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=361312.75..579290.84 rows=397833 width=24) (actual time=5359.475..13167.632 rows=1851350 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..136242.08 rows=234970 width=20) (actual time=0.065..329.639 rows=230511 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5359.388..7763.149 rows=2468038 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 155940kB
                                             ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.093..2453.270 rows=1366875 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=323.034..323.034 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=273.730..313.835 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.177..21.545 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.078..0.212 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.094..8.264 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=273.488..273.488 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.016..139.060 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.36 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 20414.588 ms
(35 rows)

Time: 20423.583 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=622828.06..622857.83 rows=2381 width=46) (actual time=20062.876..20085.548 rows=7408 loops=1)
   ->  Sort  (cost=622828.06..622834.02 rows=2381 width=46) (actual time=20062.872..20070.264 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Nested Loop  (cost=611570.13..622694.52 rows=2381 width=46) (actual time=16251.845..20045.398 rows=7408 loops=1)
               ->  Nested Loop  (cost=611570.13..621921.32 rows=2381 width=32) (actual time=16251.832..19969.727 rows=7408 loops=1)
                     ->  Hash Join  (cost=611570.13..621042.50 rows=2381 width=32) (actual time=16251.676..19267.652 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=585258.34..589236.67 rows=397833 width=24) (actual time=15934.552..17469.463 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=361312.75..579290.84 rows=397833 width=24) (actual time=5155.969..12968.304 rows=1851350 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..136242.08 rows=234970 width=20) (actual time=0.054..331.578 rows=230511 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5155.893..7560.920 rows=2468038 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 155940kB
                                             ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.043..2254.594 rows=1366875 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=317.058..317.058 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=267.911..307.863 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.199..21.452 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.134..0.334 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.060..8.078 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=267.644..267.644 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..131.343 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.36 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 20124.758 ms
(35 rows)

Time: 20132.194 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=622828.06..622834.31 rows=500 width=46) (actual time=20091.024..20093.519 rows=500 loops=1)
   ->  Unique  (cost=622828.06..622857.83 rows=2381 width=46) (actual time=20091.022..20092.578 rows=500 loops=1)
         ->  Sort  (cost=622828.06..622834.02 rows=2381 width=46) (actual time=20091.018..20091.517 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Nested Loop  (cost=611570.13..622694.52 rows=2381 width=46) (actual time=16269.056..20073.375 rows=7408 loops=1)
                     ->  Nested Loop  (cost=611570.13..621921.32 rows=2381 width=32) (actual time=16269.044..19997.773 rows=7408 loops=1)
                           ->  Hash Join  (cost=611570.13..621042.50 rows=2381 width=32) (actual time=16268.890..19296.181 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=585258.34..589236.67 rows=397833 width=24) (actual time=15950.170..17492.547 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=361312.75..579290.84 rows=397833 width=24) (actual time=5148.182..12958.214 rows=1851350 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..136242.08 rows=234970 width=20) (actual time=0.051..331.580 rows=230511 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5148.109..7553.275 rows=2468038 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 155940kB
                                                   ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.044..2248.459 rows=1366875 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=318.655..318.655 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=269.685..309.492 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.198..21.336 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.133..0.335 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.059..7.886 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=269.422..269.422 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.011..132.949 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.36 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 20126.337 ms
(36 rows)

Time: 20133.757 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=622828.06..622834.31 rows=500 width=46) (actual time=20077.436..20079.946 rows=500 loops=1)
   ->  Unique  (cost=622828.06..622857.83 rows=2381 width=46) (actual time=20077.433..20078.981 rows=500 loops=1)
         ->  Sort  (cost=622828.06..622834.02 rows=2381 width=46) (actual time=20077.429..20077.929 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Nested Loop  (cost=611570.13..622694.52 rows=2381 width=46) (actual time=16281.266..20059.831 rows=7408 loops=1)
                     ->  Nested Loop  (cost=611570.13..621921.32 rows=2381 width=32) (actual time=16281.252..19984.464 rows=7408 loops=1)
                           ->  Hash Join  (cost=611570.13..621042.50 rows=2381 width=32) (actual time=16281.099..19287.422 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=585258.34..589236.67 rows=397833 width=24) (actual time=15964.199..17496.250 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=361312.75..579290.84 rows=397833 width=24) (actual time=5154.184..12964.688 rows=1851350 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..136242.08 rows=234970 width=20) (actual time=0.053..331.793 rows=230511 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5154.109..7557.880 rows=2468038 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 155940kB
                                                   ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.043..2250.694 rows=1366875 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=316.834..316.834 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=267.633..307.590 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.196..21.457 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.131..0.332 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.059..7.972 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=267.372..267.372 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..131.406 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.36 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 20112.548 ms
(36 rows)

Time: 20119.943 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=240798.37..240800.92 rows=204 width=37) (actual time=2543.936..2544.947 rows=341 loops=1)
   ->  Sort  (cost=240798.37..240798.88 rows=204 width=37) (actual time=2543.934..2544.263 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=239974.86..240790.55 rows=204 width=37) (actual time=2514.259..2543.289 rows=341 loops=1)
               ->  Nested Loop  (cost=239974.86..240590.99 rows=204 width=26) (actual time=2514.199..2540.339 rows=341 loops=1)
                     ->  Nested Loop  (cost=239974.86..240524.89 rows=204 width=12) (actual time=2514.186..2537.258 rows=341 loops=1)
                           ->  Merge Join  (cost=239974.86..240334.72 rows=204 width=12) (actual time=2514.073..2521.772 rows=2193 loops=1)
                                 Merge Cond: (indirect1.bioentities = l.lid2)
                                 ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.738..3.297 rows=546 loops=1)
                                       Sort Key: indirect1.bioentities
                                       Sort Method:  quicksort  Memory: 50kB
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.185..2.094 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.127..0.338 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..0.690 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Sort  (cost=215530.59..215615.74 rows=34059 width=8) (actual time=2398.903..2457.051 rows=55850 loops=1)
                                       Sort Key: l.lid2
                                       Sort Method:  quicksort  Memory: 13659kB
                                       ->  Subquery Scan l  (cost=212285.49..212966.67 rows=34059 width=8) (actual time=1616.789..2137.946 rows=160316 loops=1)
                                             ->  HashAggregate  (cost=212285.49..212626.08 rows=34059 width=24) (actual time=1616.786..1825.491 rows=160316 loops=1)
                                                   ->  Nested Loop  (cost=0.00..211774.61 rows=34059 width=24) (actual time=0.105..1258.737 rows=219266 loops=1)
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.062..25.694 rows=18701 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..9.56 rows=5 width=20) (actual time=0.012..0.033 rows=17 loops=18701)
                                                               Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.92 rows=1 width=8) (actual time=0.005..0.005 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l.lid1)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.97 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 2548.983 ms
(36 rows)

Time: 2552.932 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=240798.37..240800.92 rows=204 width=37) (actual time=2506.969..2507.998 rows=341 loops=1)
   ->  Sort  (cost=240798.37..240798.88 rows=204 width=37) (actual time=2506.966..2507.277 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=239974.86..240790.55 rows=204 width=37) (actual time=2477.326..2506.336 rows=341 loops=1)
               ->  Nested Loop  (cost=239974.86..240590.99 rows=204 width=26) (actual time=2477.311..2503.447 rows=341 loops=1)
                     ->  Nested Loop  (cost=239974.86..240524.89 rows=204 width=12) (actual time=2477.298..2500.344 rows=341 loops=1)
                           ->  Merge Join  (cost=239974.86..240334.72 rows=204 width=12) (actual time=2477.183..2484.883 rows=2193 loops=1)
                                 Merge Cond: (indirect1.bioentities = l.lid2)
                                 ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.529..3.080 rows=546 loops=1)
                                       Sort Key: indirect1.bioentities
                                       Sort Method:  quicksort  Memory: 50kB
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.102..1.922 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.203 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.021..0.647 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Sort  (cost=215530.59..215615.74 rows=34059 width=8) (actual time=2362.132..2420.415 rows=55850 loops=1)
                                       Sort Key: l.lid2
                                       Sort Method:  quicksort  Memory: 13659kB
                                       ->  Subquery Scan l  (cost=212285.49..212966.67 rows=34059 width=8) (actual time=1582.259..2101.311 rows=160316 loops=1)
                                             ->  HashAggregate  (cost=212285.49..212626.08 rows=34059 width=24) (actual time=1582.256..1790.800 rows=160316 loops=1)
                                                   ->  Nested Loop  (cost=0.00..211774.61 rows=34059 width=24) (actual time=0.047..1227.457 rows=219266 loops=1)
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.022..24.126 rows=18701 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                         ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..9.56 rows=5 width=20) (actual time=0.011..0.031 rows=17 loops=18701)
                                                               Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.92 rows=1 width=8) (actual time=0.004..0.005 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l.lid1)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.97 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 2511.988 ms
(36 rows)

Time: 2515.918 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=240798.37..240800.92 rows=204 width=37) (actual time=2509.511..2511.187 rows=341 loops=1)
   ->  Unique  (cost=240798.37..240800.92 rows=204 width=37) (actual time=2509.508..2510.532 rows=341 loops=1)
         ->  Sort  (cost=240798.37..240798.88 rows=204 width=37) (actual time=2509.505..2509.843 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=239974.86..240790.55 rows=204 width=37) (actual time=2479.875..2508.873 rows=341 loops=1)
                     ->  Nested Loop  (cost=239974.86..240590.99 rows=204 width=26) (actual time=2479.861..2505.976 rows=341 loops=1)
                           ->  Nested Loop  (cost=239974.86..240524.89 rows=204 width=12) (actual time=2479.848..2502.870 rows=341 loops=1)
                                 ->  Merge Join  (cost=239974.86..240334.72 rows=204 width=12) (actual time=2479.734..2487.501 rows=2193 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.535..3.094 rows=546 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 50kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.102..1.926 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.204 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.020..0.645 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=215530.59..215615.74 rows=34059 width=8) (actual time=2364.443..2422.990 rows=55850 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 13659kB
                                             ->  Subquery Scan l  (cost=212285.49..212966.67 rows=34059 width=8) (actual time=1584.148..2102.681 rows=160316 loops=1)
                                                   ->  HashAggregate  (cost=212285.49..212626.08 rows=34059 width=24) (actual time=1584.144..1792.208 rows=160316 loops=1)
                                                         ->  Nested Loop  (cost=0.00..211774.61 rows=34059 width=24) (actual time=0.047..1229.020 rows=219266 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.021..24.521 rows=18701 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..9.56 rows=5 width=20) (actual time=0.011..0.031 rows=17 loops=18701)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.92 rows=1 width=8) (actual time=0.004..0.005 rows=0 loops=2193)
                                       Index Cond: (a1_.id = l.lid1)
                                       Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                           ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                                 Index Cond: (a4_.id = a1_.geneid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.97 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 2515.188 ms
(37 rows)

Time: 2519.155 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=240798.37..240800.92 rows=204 width=37) (actual time=2508.517..2510.186 rows=341 loops=1)
   ->  Unique  (cost=240798.37..240800.92 rows=204 width=37) (actual time=2508.514..2509.541 rows=341 loops=1)
         ->  Sort  (cost=240798.37..240798.88 rows=204 width=37) (actual time=2508.511..2508.836 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=239974.86..240790.55 rows=204 width=37) (actual time=2478.870..2507.877 rows=341 loops=1)
                     ->  Nested Loop  (cost=239974.86..240590.99 rows=204 width=26) (actual time=2478.855..2504.964 rows=341 loops=1)
                           ->  Nested Loop  (cost=239974.86..240524.89 rows=204 width=12) (actual time=2478.841..2501.871 rows=341 loops=1)
                                 ->  Merge Join  (cost=239974.86..240334.72 rows=204 width=12) (actual time=2478.726..2486.433 rows=2193 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.535..3.078 rows=546 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 50kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.102..1.924 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.204 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.020..0.648 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=215530.59..215615.74 rows=34059 width=8) (actual time=2363.328..2421.987 rows=55850 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 13659kB
                                             ->  Subquery Scan l  (cost=212285.49..212966.67 rows=34059 width=8) (actual time=1579.398..2100.928 rows=160316 loops=1)
                                                   ->  HashAggregate  (cost=212285.49..212626.08 rows=34059 width=24) (actual time=1579.395..1788.144 rows=160316 loops=1)
                                                         ->  Nested Loop  (cost=0.00..211774.61 rows=34059 width=24) (actual time=0.048..1223.751 rows=219266 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..17547.64 rows=20116 width=20) (actual time=0.021..24.455 rows=18701 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..9.56 rows=5 width=20) (actual time=0.011..0.031 rows=17 loops=18701)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.92 rows=1 width=8) (actual time=0.004..0.005 rows=0 loops=2193)
                                       Index Cond: (a1_.id = l.lid1)
                                       Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                           ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                                 Index Cond: (a4_.id = a1_.geneid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.97 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 2514.178 ms
(37 rows)

Time: 2518.197 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1514105.38..1514377.38 rows=9891 width=82) (actual time=104172.451..104300.697 rows=39884 loops=1)
   ->  Sort  (cost=1514105.38..1514130.10 rows=9891 width=82) (actual time=104172.446..104214.800 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=1457156.90..1513449.01 rows=9891 width=82) (actual time=87287.843..104047.239 rows=39884 loops=1)
               ->  Hash Join  (cost=1457156.90..1500936.84 rows=9891 width=72) (actual time=87287.798..103576.602 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=1455191.03..1498770.16 rows=10190 width=58) (actual time=87164.265..103303.426 rows=40032 loops=1)
                           ->  Hash Join  (cost=1455191.03..1495722.03 rows=10190 width=39) (actual time=87164.206..102822.362 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1413088.29..1430111.07 rows=1702278 width=24) (actual time=86514.257..93403.553 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=885534.26..1387554.12 rows=1702278 width=24) (actual time=35726.374..76917.666 rows=5365674 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..155849.07 rows=291894 width=20) (actual time=0.048..426.490 rows=282925 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=885534.26..897521.38 rows=4794847 width=20) (actual time=35726.301..51818.006 rows=15961576 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 573116kB
                                                   ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l2  (cost=0.00..353472.79 rows=4794847 width=20) (actual time=0.071..21097.910 rows=4819293 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=648.507..648.507 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.254..577.847 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.197..156.535 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.136..0.212 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.053..58.544 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.006..0.008 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.492..123.492 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..62.480 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 104463.722 ms
(37 rows)

Time: 104475.630 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1514105.38..1514377.38 rows=9891 width=82) (actual time=104160.222..104290.101 rows=39884 loops=1)
   ->  Sort  (cost=1514105.38..1514130.10 rows=9891 width=82) (actual time=104160.218..104202.822 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=1457156.90..1513449.01 rows=9891 width=82) (actual time=87219.448..104030.977 rows=39884 loops=1)
               ->  Hash Join  (cost=1457156.90..1500936.84 rows=9891 width=72) (actual time=87219.406..103557.831 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=1455191.03..1498770.16 rows=10190 width=58) (actual time=87096.128..103290.680 rows=40032 loops=1)
                           ->  Hash Join  (cost=1455191.03..1495722.03 rows=10190 width=39) (actual time=87096.069..102809.475 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1413088.29..1430111.07 rows=1702278 width=24) (actual time=86447.784..93291.540 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=885534.26..1387554.12 rows=1702278 width=24) (actual time=35556.421..76859.258 rows=5365674 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..155849.07 rows=291894 width=20) (actual time=0.049..426.701 rows=282925 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=885534.26..897521.38 rows=4794847 width=20) (actual time=35556.343..51638.576 rows=15961576 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 573116kB
                                                   ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l2  (cost=0.00..353472.79 rows=4794847 width=20) (actual time=0.048..20922.216 rows=4819293 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=646.842..646.842 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.319..576.410 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.273..156.670 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.210..0.326 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.055..57.881 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.006..0.008 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.239..123.239 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.033..62.453 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 104452.740 ms
(37 rows)

Time: 104463.675 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1514105.38..1514119.13 rows=500 width=82) (actual time=103962.616..103965.203 rows=500 loops=1)
   ->  Unique  (cost=1514105.38..1514377.38 rows=9891 width=82) (actual time=103962.612..103964.259 rows=500 loops=1)
         ->  Sort  (cost=1514105.38..1514130.10 rows=9891 width=82) (actual time=103962.608..103963.150 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=1457156.90..1513449.01 rows=9891 width=82) (actual time=87025.703..103832.924 rows=39884 loops=1)
                     ->  Hash Join  (cost=1457156.90..1500936.84 rows=9891 width=72) (actual time=87025.661..103365.833 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=1455191.03..1498770.16 rows=10190 width=58) (actual time=86902.684..103099.910 rows=40032 loops=1)
                                 ->  Hash Join  (cost=1455191.03..1495722.03 rows=10190 width=39) (actual time=86902.627..102620.737 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=1413088.29..1430111.07 rows=1702278 width=24) (actual time=86248.931..93085.962 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=885534.26..1387554.12 rows=1702278 width=24) (actual time=35578.877..76721.402 rows=5365674 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..155849.07 rows=291894 width=20) (actual time=0.051..424.551 rows=282925 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=885534.26..897521.38 rows=4794847 width=20) (actual time=35578.799..51669.573 rows=15961576 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  quicksort  Memory: 573116kB
                                                         ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l2  (cost=0.00..353472.79 rows=4794847 width=20) (actual time=0.050..20914.435 rows=4819293 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=652.250..652.250 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.319..581.468 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.273..155.513 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.210..0.325 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.056..57.629 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.005 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.006..0.007 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.937..122.937 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..62.259 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 104090.230 ms
(38 rows)

Time: 104101.234 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1514105.38..1514119.13 rows=500 width=82) (actual time=103880.311..103882.885 rows=500 loops=1)
   ->  Unique  (cost=1514105.38..1514377.38 rows=9891 width=82) (actual time=103880.308..103881.937 rows=500 loops=1)
         ->  Sort  (cost=1514105.38..1514130.10 rows=9891 width=82) (actual time=103880.303..103880.848 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=1457156.90..1513449.01 rows=9891 width=82) (actual time=86956.283..103750.699 rows=39884 loops=1)
                     ->  Hash Join  (cost=1457156.90..1500936.84 rows=9891 width=72) (actual time=86956.241..103280.809 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=1455191.03..1498770.16 rows=10190 width=58) (actual time=86833.273..103015.910 rows=40032 loops=1)
                                 ->  Hash Join  (cost=1455191.03..1495722.03 rows=10190 width=39) (actual time=86833.215..102531.506 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=1413088.29..1430111.07 rows=1702278 width=24) (actual time=86178.198..93001.962 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=885534.26..1387554.12 rows=1702278 width=24) (actual time=35476.722..76623.730 rows=5365674 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..155849.07 rows=291894 width=20) (actual time=0.048..424.543 rows=282925 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=885534.26..897521.38 rows=4794847 width=20) (actual time=35476.647..51566.264 rows=15961576 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  quicksort  Memory: 573116kB
                                                         ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l2  (cost=0.00..353472.79 rows=4794847 width=20) (actual time=0.048..20878.233 rows=4819293 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=653.574..653.574 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.316..582.899 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.271..157.099 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.209..0.323 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.053..58.075 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.005 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.006..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.929..122.929 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..62.161 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 104008.140 ms
(38 rows)

Time: 104019.130 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=2770379.79..2770987.23 rows=48595 width=53) (actual time=342005.301..342061.390 rows=17651 loops=1)
   ->  Sort  (cost=2770379.79..2770501.28 rows=48595 width=53) (actual time=342005.297..342023.819 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=2572330.48..2766597.03 rows=48595 width=53) (actual time=240874.525..341939.051 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=2556462.52..2749757.17 rows=48595 width=39) (actual time=240309.887..340746.874 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=2514359.78..2595542.39 rows=8118261 width=24) (actual time=239664.511..284540.957 rows=29345747 loops=1)
                           ->  Merge Join  (cost=361312.75..2392585.87 rows=8118261 width=24) (actual time=5260.900..168736.742 rows=34983239 loops=1)
                                 Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.066..7002.597 rows=4818102 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5260.697..56732.025 rows=53219047 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 155940kB
                                       ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.053..2363.398 rows=1366875 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=645.230..645.230 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.309..574.492 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.264..156.100 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.203..0.318 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.051..57.377 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=551.485..551.485 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=139.611..484.570 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.686..220.336 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.846..13.846 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.878..123.878 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..62.433 rows=48661 loops=1)
 Total runtime: 342520.477 ms
(38 rows)

Time: 342541.459 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=2770379.79..2770987.23 rows=48595 width=53) (actual time=339323.837..339380.047 rows=17651 loops=1)
   ->  Sort  (cost=2770379.79..2770501.28 rows=48595 width=53) (actual time=339323.832..339342.452 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=2572330.48..2766597.03 rows=48595 width=53) (actual time=238809.623..339256.109 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=2556462.52..2749757.17 rows=48595 width=39) (actual time=238248.996..338068.136 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=2514359.78..2595542.39 rows=8118261 width=24) (actual time=237601.666..282030.193 rows=29345747 loops=1)
                           ->  Merge Join  (cost=361312.75..2392585.87 rows=8118261 width=24) (actual time=5251.984..167994.339 rows=34983239 loops=1)
                                 Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.061..6963.334 rows=4818102 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5251.786..56741.131 rows=53219047 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 155940kB
                                       ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.053..2341.256 rows=1366875 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=647.186..647.186 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.308..576.001 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.263..157.031 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.202..0.314 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..58.049 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=547.497..547.497 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=140.697..480.788 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.605..215.138 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.745..13.745 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.045..125.045 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..63.363 rows=48661 loops=1)
 Total runtime: 339819.762 ms
(38 rows)

Time: 339839.414 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2769990.37..2769991.62 rows=500 width=53) (actual time=340489.805..340491.225 rows=500 loops=1)
   ->  Sort  (cost=2769990.37..2770111.86 rows=48595 width=53) (actual time=340489.801..340490.280 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=2767082.98..2767568.93 rows=48595 width=53) (actual time=340442.504..340463.992 rows=17651 loops=1)
               ->  Hash Join  (cost=2572330.48..2766597.03 rows=48595 width=53) (actual time=239625.304..340374.974 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=2556462.52..2749757.17 rows=48595 width=39) (actual time=239061.444..339195.961 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=2514359.78..2595542.39 rows=8118261 width=24) (actual time=238415.633..283152.724 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=361312.75..2392585.87 rows=8118261 width=24) (actual time=5256.917..168317.816 rows=34983239 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.059..6959.267 rows=4818102 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5256.718..56720.392 rows=53219047 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 155940kB
                                             ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.053..2345.365 rows=1366875 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=645.669..645.669 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.306..574.582 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.262..157.022 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.202..0.318 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..57.919 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=550.791..550.791 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=140.935..483.778 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.486..216.375 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.695..13.695 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.397..125.397 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..63.074 rows=48661 loops=1)
 Total runtime: 340915.253 ms
(39 rows)

Time: 340935.031 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2769990.37..2769991.62 rows=500 width=53) (actual time=340305.555..340306.994 rows=500 loops=1)
   ->  Sort  (cost=2769990.37..2770111.86 rows=48595 width=53) (actual time=340305.551..340306.036 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=2767082.98..2767568.93 rows=48595 width=53) (actual time=340257.737..340279.664 rows=17651 loops=1)
               ->  Hash Join  (cost=2572330.48..2766597.03 rows=48595 width=53) (actual time=239489.452..340190.330 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=2556462.52..2749757.17 rows=48595 width=39) (actual time=238925.766..339011.194 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=2514359.78..2595542.39 rows=8118261 width=24) (actual time=238284.081..282957.229 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=361312.75..2392585.87 rows=8118261 width=24) (actual time=5273.761..168205.323 rows=34983239 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.059..6946.565 rows=4818102 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Sort  (cost=361312.75..364792.90 rows=1392059 width=20) (actual time=5273.551..56734.685 rows=53219047 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 155940kB
                                             ->  Index Scan using locationbin2000__subjecttypeid on locationbin2000 l1  (cost=0.00..219261.56 rows=1392059 width=20) (actual time=0.052..2368.380 rows=1366875 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=641.543..641.543 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.306..570.418 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.262..155.305 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.203..0.316 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.051..57.735 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=550.637..550.637 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=140.818..483.506 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.513..216.766 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.709..13.709 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.254..125.254 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..63.032 rows=48661 loops=1)
 Total runtime: 340731.415 ms
(39 rows)

Time: 340751.351 ms
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=203373.91..203379.13 rows=2089 width=4) (actual time=15.436..15.551 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=193808.53..203258.71 rows=2089 width=4) (actual time=11.910..15.255 rows=118 loops=1)
         ->  HashAggregate  (cost=193808.53..193829.42 rows=2089 width=24) (actual time=11.854..12.024 rows=120 loops=1)
               ->  Nested Loop  (cost=18.59..193777.20 rows=2089 width=24) (actual time=0.470..11.068 rows=557 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin2000__subjectid on locationbin2000 l1  (cost=0.00..96.38 rows=107 width=20) (actual time=0.092..0.099 rows=3 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin2000 l2  (cost=18.59..1785.60 rows=1225 width=20) (actual time=0.195..2.005 rows=1281 loops=3)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin2000__bin  (cost=0.00..18.28 rows=1225 width=0) (actual time=0.175..0.175 rows=1281 loops=3)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.49 rows=1 width=4) (actual time=0.022..0.023 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 15.756 ms
(16 rows)

Time: 17.774 ms
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=203373.91..203379.13 rows=2089 width=4) (actual time=12.061..12.174 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=193808.53..203258.71 rows=2089 width=4) (actual time=10.488..11.894 rows=118 loops=1)
         ->  HashAggregate  (cost=193808.53..193829.42 rows=2089 width=24) (actual time=10.477..10.624 rows=120 loops=1)
               ->  Nested Loop  (cost=18.59..193777.20 rows=2089 width=24) (actual time=0.234..9.679 rows=557 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin2000__subjectid on locationbin2000 l1  (cost=0.00..96.38 rows=107 width=20) (actual time=0.013..0.017 rows=3 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin2000 l2  (cost=18.59..1785.60 rows=1225 width=20) (actual time=0.141..1.553 rows=1281 loops=3)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin2000__bin  (cost=0.00..18.28 rows=1225 width=0) (actual time=0.127..0.127 rows=1281 loops=3)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.49 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 12.369 ms
(16 rows)

Time: 13.520 ms
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=203362.81..203364.06 rows=500 width=4) (actual time=12.046..12.383 rows=118 loops=1)
   ->  Sort  (cost=203362.81..203368.03 rows=2089 width=4) (actual time=12.044..12.158 rows=118 loops=1)
         Sort Key: a1_.id
         Sort Method:  quicksort  Memory: 30kB
         ->  Nested Loop  (cost=193808.53..203258.71 rows=2089 width=4) (actual time=10.481..11.866 rows=118 loops=1)
               ->  HashAggregate  (cost=193808.53..193829.42 rows=2089 width=24) (actual time=10.470..10.612 rows=120 loops=1)
                     ->  Nested Loop  (cost=18.59..193777.20 rows=2089 width=24) (actual time=0.228..9.732 rows=557 loops=1)
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                           ->  Index Scan using locationbin2000__subjectid on locationbin2000 l1  (cost=0.00..96.38 rows=107 width=20) (actual time=0.012..0.018 rows=3 loops=1)
                                 Index Cond: (232042548 = subjectid)
                           ->  Bitmap Heap Scan on locationbin2000 l2  (cost=18.59..1785.60 rows=1225 width=20) (actual time=0.140..1.561 rows=1281 loops=3)
                                 Recheck Cond: (l2.bin = l1.bin)
                                 ->  Bitmap Index Scan on locationbin2000__bin  (cost=0.00..18.28 rows=1225 width=0) (actual time=0.127..0.127 rows=1281 loops=3)
                                       Index Cond: (l2.bin = l1.bin)
               ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.49 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
                     Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 12.574 ms
(17 rows)

Time: 13.717 ms
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=203362.81..203364.06 rows=500 width=4) (actual time=12.039..12.378 rows=118 loops=1)
   ->  Sort  (cost=203362.81..203368.03 rows=2089 width=4) (actual time=12.036..12.149 rows=118 loops=1)
         Sort Key: a1_.id
         Sort Method:  quicksort  Memory: 30kB
         ->  Nested Loop  (cost=193808.53..203258.71 rows=2089 width=4) (actual time=10.469..11.858 rows=118 loops=1)
               ->  HashAggregate  (cost=193808.53..193829.42 rows=2089 width=24) (actual time=10.457..10.602 rows=120 loops=1)
                     ->  Nested Loop  (cost=18.59..193777.20 rows=2089 width=24) (actual time=0.229..9.739 rows=557 loops=1)
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                           ->  Index Scan using locationbin2000__subjectid on locationbin2000 l1  (cost=0.00..96.38 rows=107 width=20) (actual time=0.011..0.016 rows=3 loops=1)
                                 Index Cond: (232042548 = subjectid)
                           ->  Bitmap Heap Scan on locationbin2000 l2  (cost=18.59..1785.60 rows=1225 width=20) (actual time=0.140..1.563 rows=1281 loops=3)
                                 Recheck Cond: (l2.bin = l1.bin)
                                 ->  Bitmap Index Scan on locationbin2000__bin  (cost=0.00..18.28 rows=1225 width=0) (actual time=0.127..0.127 rows=1281 loops=3)
                                       Index Cond: (l2.bin = l1.bin)
               ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.49 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
                     Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 12.567 ms
(17 rows)

Time: 13.761 ms
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=308029.03..308126.15 rows=38847 width=46) (actual time=4120.877..4258.038 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=302737.00..305067.82 rows=38847 width=46) (actual time=2780.189..3689.934 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=298409.05..299962.93 rows=38847 width=22) (actual time=2514.292..3050.604 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=296443.18..296831.65 rows=38847 width=24) (actual time=2390.480..2563.240 rows=129835 loops=1)
                     ->  Merge Join  (cost=202097.29..295860.47 rows=38847 width=24) (actual time=914.678..2037.338 rows=224634 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.067..76.289 rows=56430 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=202097.29..202755.36 rows=263226 width=20) (actual time=914.590..1254.097 rows=340558 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 26001kB
                                 ->  Bitmap Heap Scan on locationbin2000 l2  (cost=6054.97..178399.13 rows=263226 width=20) (actual time=64.151..378.588 rows=254161 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin2000__subjecttypeid  (cost=0.00..5989.16 rows=263226 width=0) (actual time=63.490..63.490 rows=254161 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.757..123.757 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.887 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=265.833..265.833 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.030..131.016 rows=103331 loops=1)
 Total runtime: 4388.047 ms
(25 rows)

Time: 4389.966 ms
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=308029.03..308126.15 rows=38847 width=46) (actual time=4092.798..4228.597 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=302737.00..305067.82 rows=38847 width=46) (actual time=2746.098..3661.605 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=298409.05..299962.93 rows=38847 width=22) (actual time=2485.324..3025.690 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=296443.18..296831.65 rows=38847 width=24) (actual time=2362.438..2536.162 rows=129835 loops=1)
                     ->  Merge Join  (cost=202097.29..295860.47 rows=38847 width=24) (actual time=892.322..2011.146 rows=224634 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.028..73.331 rows=56430 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=202097.29..202755.36 rows=263226 width=20) (actual time=892.272..1231.175 rows=340558 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 26001kB
                                 ->  Bitmap Heap Scan on locationbin2000 l2  (cost=6054.97..178399.13 rows=263226 width=20) (actual time=48.255..356.830 rows=254161 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin2000__subjecttypeid  (cost=0.00..5989.16 rows=263226 width=0) (actual time=47.617..47.617 rows=254161 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.832..122.832 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..62.429 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=260.711..260.711 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.009..128.959 rows=103331 loops=1)
 Total runtime: 4359.861 ms
(25 rows)

Time: 4361.729 ms
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=307003.52..307004.77 rows=500 width=46) (actual time=3844.987..3846.418 rows=500 loops=1)
   ->  Sort  (cost=307003.52..307100.64 rows=38847 width=46) (actual time=3844.983..3845.465 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=302737.00..305067.82 rows=38847 width=46) (actual time=2752.497..3663.375 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=298409.05..299962.93 rows=38847 width=22) (actual time=2491.557..3026.559 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=296443.18..296831.65 rows=38847 width=24) (actual time=2369.430..2542.093 rows=129835 loops=1)
                           ->  Merge Join  (cost=202097.29..295860.47 rows=38847 width=24) (actual time=899.710..2014.841 rows=224634 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.027..72.439 rows=56430 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=202097.29..202755.36 rows=263226 width=20) (actual time=899.660..1237.506 rows=340558 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 26001kB
                                       ->  Bitmap Heap Scan on locationbin2000 l2  (cost=6054.97..178399.13 rows=263226 width=20) (actual time=48.432..361.856 rows=254161 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin2000__subjecttypeid  (cost=0.00..5989.16 rows=263226 width=0) (actual time=47.782..47.782 rows=254161 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.075..122.075 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..61.804 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=260.876..260.876 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.009..129.211 rows=103331 loops=1)
 Total runtime: 3852.168 ms
(26 rows)

Time: 3854.075 ms
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=307003.52..307004.77 rows=500 width=46) (actual time=3832.250..3833.693 rows=500 loops=1)
   ->  Sort  (cost=307003.52..307100.64 rows=38847 width=46) (actual time=3832.246..3832.722 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=302737.00..305067.82 rows=38847 width=46) (actual time=2736.370..3649.054 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=298409.05..299962.93 rows=38847 width=22) (actual time=2480.429..3016.683 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=296443.18..296831.65 rows=38847 width=24) (actual time=2359.741..2532.996 rows=129835 loops=1)
                           ->  Merge Join  (cost=202097.29..295860.47 rows=38847 width=24) (actual time=895.442..2012.351 rows=224634 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..85290.07 rows=121337 width=20) (actual time=0.027..72.391 rows=56430 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=202097.29..202755.36 rows=263226 width=20) (actual time=895.393..1233.139 rows=340558 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 26001kB
                                       ->  Bitmap Heap Scan on locationbin2000 l2  (cost=6054.97..178399.13 rows=263226 width=20) (actual time=48.613..360.103 rows=254161 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin2000__subjecttypeid  (cost=0.00..5989.16 rows=263226 width=0) (actual time=47.963..47.963 rows=254161 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=120.635..120.635 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..61.740 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=255.878..255.878 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.009..128.920 rows=103331 loops=1)
 Total runtime: 3839.419 ms
(26 rows)

Time: 3841.301 ms
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=809806.32..811038.72 rows=492959 width=135) (actual time=37646.097..38504.809 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=730535.78..763194.32 rows=492959 width=135) (actual time=26881.713..33319.556 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=527039.31..548606.27 rows=492959 width=49) (actual time=15727.028..19265.961 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=525583.26..530512.85 rows=492959 width=24) (actual time=15633.258..16777.225 rows=800907 loops=1)
                     ->  Merge Join  (cost=0.00..518188.87 rows=492959 width=24) (actual time=0.137..14090.395 rows=872519 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..63891.37 rows=84529 width=20) (actual time=0.053..126.469 rows=86840 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.047..6935.735 rows=5074723 loops=1)
                                 Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=93.723..93.723 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..45.782 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11151.704..11151.704 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.036..5212.344 rows=4025132 loops=1)
 Total runtime: 39383.076 ms
(20 rows)

Time: 39385.350 ms
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=809806.32..811038.72 rows=492959 width=135) (actual time=37679.672..38541.837 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=730535.78..763194.32 rows=492959 width=135) (actual time=26915.536..33361.999 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=527039.31..548606.27 rows=492959 width=49) (actual time=15703.549..19244.681 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=525583.26..530512.85 rows=492959 width=24) (actual time=15610.738..16753.728 rows=800907 loops=1)
                     ->  Merge Join  (cost=0.00..518188.87 rows=492959 width=24) (actual time=0.149..14066.861 rows=872519 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..63891.37 rows=84529 width=20) (actual time=0.067..125.653 rows=86840 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.047..6910.987 rows=5074723 loops=1)
                                 Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=92.767..92.767 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..45.319 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11208.187..11208.187 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.057..5252.398 rows=4025132 loops=1)
 Total runtime: 39417.132 ms
(20 rows)

Time: 39418.773 ms
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=787757.93..787759.18 rows=500 width=135) (actual time=34596.201..34597.627 rows=500 loops=1)
   ->  Sort  (cost=787757.93..788990.33 rows=492959 width=135) (actual time=34596.197..34596.687 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=730535.78..763194.32 rows=492959 width=135) (actual time=26902.266..33343.796 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=527039.31..548606.27 rows=492959 width=49) (actual time=15710.115..19249.997 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=525583.26..530512.85 rows=492959 width=24) (actual time=15616.249..16760.021 rows=800907 loops=1)
                           ->  Merge Join  (cost=0.00..518188.87 rows=492959 width=24) (actual time=0.148..14067.576 rows=872519 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..63891.37 rows=84529 width=20) (actual time=0.066..125.419 rows=86840 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.045..6935.645 rows=5074723 loops=1)
                                       Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=93.822..93.822 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..45.825 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11188.295..11188.295 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.036..5256.436 rows=4025132 loops=1)
 Total runtime: 34697.580 ms
(21 rows)

Time: 34699.246 ms
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=787757.93..787759.18 rows=500 width=135) (actual time=34588.241..34589.684 rows=500 loops=1)
   ->  Sort  (cost=787757.93..788990.33 rows=492959 width=135) (actual time=34588.237..34588.718 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=730535.78..763194.32 rows=492959 width=135) (actual time=26908.852..33342.402 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=527039.31..548606.27 rows=492959 width=49) (actual time=15694.918..19227.105 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=525583.26..530512.85 rows=492959 width=24) (actual time=15601.859..16741.757 rows=800907 loops=1)
                           ->  Merge Join  (cost=0.00..518188.87 rows=492959 width=24) (actual time=0.148..14058.222 rows=872519 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l1  (cost=0.00..63891.37 rows=84529 width=20) (actual time=0.066..124.863 rows=86840 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Index Scan using locationbin2000__subjectobjectbin on locationbin2000 l2  (cost=0.00..363351.12 rows=4794847 width=20) (actual time=0.046..6908.158 rows=5074723 loops=1)
                                       Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=93.006..93.006 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..45.622 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11210.092..11210.092 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.035..5253.185 rows=4025132 loops=1)
 Total runtime: 34689.288 ms
(21 rows)

Time: 34690.958 ms
