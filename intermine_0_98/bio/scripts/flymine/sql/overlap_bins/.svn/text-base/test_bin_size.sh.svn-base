#!/bin/bash

SIZE=$1

echo "Testing with size $SIZE"

(
echo "\\timing"
echo "create table locationbin$SIZE as SELECT id, objectid, subjectid, intermine_start, intermine_end, subjecttype, generate_series(intermine_start / $SIZE, intermine_end / $SIZE) AS bin FROM locationwithtype order by subjecttype, objectid, bin;"
echo "create index locationbin${SIZE}__subjectobjectbin on locationbin$SIZE (subjecttype, objectid, bin);"
echo "create index locationbin${SIZE}__subjecttypeid on locationbin$SIZE (subjecttype, id);"
echo "create index locationbin${SIZE}__subjectid on locationbin$SIZE (subjectid);"
echo "create index locationbin${SIZE}__bin on locationbin$SIZE (bin);"
echo "analyse locationbin$SIZE;"
#echo "explain analyse select count(*) FROM (select distinct l1.id AS id1, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.id AS id2, l2.intermine_start as start2, l2.intermine_end AS end2 from locationbin$SIZE l1, locationbin$SIZE l2 where l1.subjecttype = 'GeneFlankingRegion' AND l2.subjecttype = 'Gene' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS a WHERE start1 <= end2 AND start2 <= end1;"
#echo "select count(*) FROM (select distinct l1.id AS id1, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.id AS id2, l2.intermine_start as start2, l2.intermine_end AS end2 from locationbin$SIZE l1, locationbin$SIZE l2 where l1.subjecttype = 'GeneFlankingRegion' AND l2.subjecttype = 'Gene' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS a WHERE start1 <= end2 AND start2 <= end1;"

echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6 FROM Gene AS a1_, MRNA AS a2_, DataSet AS a3_, Location AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype = 'org.intermine.model.bio.MRNA' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND a2_.id = l.lid2 AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6 FROM Gene AS a1_, MRNA AS a2_, DataSet AS a3_, Location AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype = 'org.intermine.model.bio.MRNA' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND a2_.id = l.lid2 AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6 FROM Gene AS a1_, MRNA AS a2_, DataSet AS a3_, Location AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype = 'org.intermine.model.bio.MRNA' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND a2_.id = l.lid2 AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6 FROM Gene AS a1_, MRNA AS a2_, DataSet AS a3_, Location AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype = 'org.intermine.model.bio.MRNA' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND a2_.id = l.lid2 AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, EST AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, EST AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, EST AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, EST AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE '5'' race (mixed-stage embryos)' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, ProteinBindingSite AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.ProteinBindingSite' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'adultmale\\_h3k4me3' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, ProteinBindingSite AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.ProteinBindingSite' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'adultmale\\_h3k4me3' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, ProteinBindingSite AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.ProteinBindingSite' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'adultmale\\_h3k4me3' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, ProteinBindingSite AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.ProteinBindingSite' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'adultmale\\_h3k4me3' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, EST AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE 'dmg3 rtpcr' AND LOWER(a1_.distance) LIKE '5.0kb' AND LOWER(a1_.direction) LIKE 'downstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, EST AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE 'dmg3 rtpcr' AND LOWER(a1_.distance) LIKE '5.0kb' AND LOWER(a1_.direction) LIKE 'downstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, EST AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE 'dmg3 rtpcr' AND LOWER(a1_.distance) LIKE '5.0kb' AND LOWER(a1_.direction) LIKE 'downstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, EST AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.EST' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE 'dmg3 rtpcr' AND LOWER(a1_.distance) LIKE '5.0kb' AND LOWER(a1_.direction) LIKE 'downstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a1_.id AS a1_id, a2_.id AS a2_id, a4_.id AS a4_id, a5_.id AS a5_id, a1_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3, a4_.intermine_start AS orderbyfield4, a4_.intermine_end AS orderbyfield5, a4_.strand AS orderbyfield6, a5_.primaryIdentifier AS orderbyfield7 FROM Exon AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Location AS a4_, Gene AS a5_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Exon' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND a1_.chromosomeLocationId = a4_.id AND a1_.geneId = a5_.id ORDER BY a1_.primaryIdentifier, a2_.secondaryIdentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryIdentifier, a1_.id, a2_.id, a4_.id, a5_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT DISTINCT a2_.id AS a2_id, a4_.id AS a4_id, a4_.primaryIdentifier AS orderbyfield2, a2_.secondaryIdentifier AS orderbyfield3 FROM GeneFlankingRegion AS a1_, TranscriptRegion AS a2_, DataSet AS a3_, Gene AS a4_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l, BioEntitiesDataSets AS indirect1 WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 AND a2_.id = indirect1.BioEntities AND indirect1.DataSets = a3_.id AND LOWER(a3_.title) LIKE E'dm\\_s2rp\\_totalrna\\_p200\\_020-022-024\\_38bp' AND LOWER(a1_.distance) LIKE '2.0kb' AND LOWER(a1_.direction) LIKE 'upstream' AND a1_.geneId = a4_.id ORDER BY a4_.primaryIdentifier, a2_.secondaryIdentifier, a2_.id, a4_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id FROM LocatedSequenceFeature AS a1_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE 232042548 = l.lid1 AND l.lid2 = a1_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.id;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id FROM LocatedSequenceFeature AS a1_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE 232042548 = l.lid1 AND l.lid2 = a1_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.id;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id FROM LocatedSequenceFeature AS a1_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE 232042548 = l.lid1 AND l.lid2 = a1_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id FROM LocatedSequenceFeature AS a1_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE 232042548 = l.lid1 AND l.lid2 = a1_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM Gene AS a1_, ProteinBindingSite AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype IN ('org.intermine.model.bio.ProteinBindingSite', 'org.intermine.model.bio.HistoneBindingSite') AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM Gene AS a1_, ProteinBindingSite AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype IN ('org.intermine.model.bio.ProteinBindingSite', 'org.intermine.model.bio.HistoneBindingSite') AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM Gene AS a1_, ProteinBindingSite AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype IN ('org.intermine.model.bio.ProteinBindingSite', 'org.intermine.model.bio.HistoneBindingSite') AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM Gene AS a1_, ProteinBindingSite AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.Gene' AND l2.subjecttype IN ('org.intermine.model.bio.ProteinBindingSite', 'org.intermine.model.bio.HistoneBindingSite') AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id LIMIT 500;"

echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM IntergenicRegion AS a1_, TranscriptRegion AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.IntergenicRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM IntergenicRegion AS a1_, TranscriptRegion AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.IntergenicRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM IntergenicRegion AS a1_, TranscriptRegion AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.IntergenicRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id LIMIT 500;"
echo "EXPLAIN ANALYSE SELECT a1_.id AS a1_id, a2_.id AS a2_id, a1_.primaryIdentifier AS orderbyfield1, a2_.primaryIdentifier AS orderbyfield2 FROM IntergenicRegion AS a1_, TranscriptRegion AS a2_, (SELECT DISTINCT l1.subjectid AS lid1, l2.subjectid AS lid2, l1.intermine_start AS start1, l1.intermine_end AS end1, l2.intermine_start AS start2, l2.intermine_end AS end2 FROM locationbin$SIZE AS l1, locationbin$SIZE AS l2 WHERE l1.subjecttype = 'org.intermine.model.bio.IntergenicRegion' AND l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion' AND l1.objectid = l2.objectid AND l1.bin = l2.bin) AS l WHERE a1_.id = l.lid1 AND l.lid2 = a2_.id AND l.start1 <= l.end2 AND l.start2 <= l.end1 ORDER BY a1_.primaryIdentifier, a2_.primaryIdentifier, a1_.id, a2_.id LIMIT 500;"

) | psql mnw21-overlap-test
