Testing with size 500
Timing is on.
SELECT
Time: 817134.593 ms
CREATE INDEX
Time: 438235.040 ms
CREATE INDEX
Time: 548128.516 ms
CREATE INDEX
Time: 125024.610 ms
CREATE INDEX
Time: 118568.964 ms
ANALYZE
Time: 2067.385 ms
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=770148.86..770160.72 rows=527 width=52) (actual time=7311.754..7314.987 rows=949 loops=1)
   ->  Sort  (cost=770148.86..770150.18 rows=527 width=52) (actual time=7311.749..7312.827 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=741613.88..770125.04 rows=527 width=52) (actual time=6174.582..7309.010 rows=1114 loops=1)
               ->  Nested Loop  (cost=741613.88..768686.33 rows=534 width=42) (actual time=6142.864..6608.682 rows=1114 loops=1)
                     ->  Hash Join  (cost=741613.88..768523.33 rows=534 width=24) (actual time=6112.720..6160.322 rows=1114 loops=1)
                           Hash Cond: (a2_.id = l.lid2)
                           ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=340.775..385.565 rows=686 loops=1)
                                 Hash Cond: (indirect1.bioentities = a2_.id)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=53.527..89.757 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=10.216..10.457 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=43.303..70.775 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=287.202..287.202 rows=71604 loops=1)
                                       ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=4.353..199.155 rows=71604 loops=1)
                           ->  Hash  (cost=737704.72..737704.72 rows=89286 width=8) (actual time=5771.794..5771.794 rows=83765 loops=1)
                                 ->  Subquery Scan l  (cost=735919.00..737704.72 rows=89286 width=8) (actual time=5392.956..5665.873 rows=83765 loops=1)
                                       ->  HashAggregate  (cost=735919.00..736811.86 rows=89286 width=24) (actual time=5392.953..5500.150 rows=83765 loops=1)
                                             ->  Merge Join  (cost=0.00..734579.71 rows=89286 width=24) (actual time=9.547..4278.703 rows=772546 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=9.471..787.977 rows=351543 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..379869.35 rows=639324 width=20) (actual time=0.065..1225.232 rows=798679 loops=1)
                                                         Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.29 rows=1 width=22) (actual time=0.397..0.398 rows=1 loops=1114)
                           Index Cond: (a1_.id = l.lid1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.623..0.624 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 7316.503 ms
(32 rows)

Time: 7532.261 ms
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=770148.86..770160.72 rows=527 width=52) (actual time=5423.212..5426.449 rows=949 loops=1)
   ->  Sort  (cost=770148.86..770150.18 rows=527 width=52) (actual time=5423.209..5424.285 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=741613.88..770125.04 rows=527 width=52) (actual time=5376.262..5420.727 rows=1114 loops=1)
               ->  Nested Loop  (cost=741613.88..768686.33 rows=534 width=42) (actual time=5376.246..5410.402 rows=1114 loops=1)
                     ->  Hash Join  (cost=741613.88..768523.33 rows=534 width=24) (actual time=5376.216..5400.645 rows=1114 loops=1)
                           Hash Cond: (a2_.id = l.lid2)
                           ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=175.836..197.673 rows=686 loops=1)
                                 Hash Cond: (indirect1.bioentities = a2_.id)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.117..13.792 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.082..0.220 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.029..5.105 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=175.675..175.675 rows=71604 loops=1)
                                       ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.003..89.454 rows=71604 loops=1)
                           ->  Hash  (cost=737704.72..737704.72 rows=89286 width=8) (actual time=5200.313..5200.313 rows=83765 loops=1)
                                 ->  Subquery Scan l  (cost=735919.00..737704.72 rows=89286 width=8) (actual time=4824.931..5095.095 rows=83765 loops=1)
                                       ->  HashAggregate  (cost=735919.00..736811.86 rows=89286 width=24) (actual time=4824.927..4931.124 rows=83765 loops=1)
                                             ->  Merge Join  (cost=0.00..734579.71 rows=89286 width=24) (actual time=0.052..3724.404 rows=772546 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=0.022..447.393 rows=351543 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..379869.35 rows=639324 width=20) (actual time=0.019..1016.213 rows=798679 loops=1)
                                                         Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.29 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                           Index Cond: (a1_.id = l.lid1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 5427.941 ms
(32 rows)

Time: 5433.219 ms
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=770148.86..770160.11 rows=500 width=52) (actual time=5449.337..5451.961 rows=500 loops=1)
   ->  Unique  (cost=770148.86..770160.72 rows=527 width=52) (actual time=5449.334..5451.025 rows=500 loops=1)
         ->  Sort  (cost=770148.86..770150.18 rows=527 width=52) (actual time=5449.331..5449.883 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=741613.88..770125.04 rows=527 width=52) (actual time=5402.568..5446.819 rows=1114 loops=1)
                     ->  Nested Loop  (cost=741613.88..768686.33 rows=534 width=42) (actual time=5402.553..5436.524 rows=1114 loops=1)
                           ->  Hash Join  (cost=741613.88..768523.33 rows=534 width=24) (actual time=5402.520..5426.836 rows=1114 loops=1)
                                 Hash Cond: (a2_.id = l.lid2)
                                 ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=176.776..198.540 rows=686 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.117..13.780 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.082..0.219 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.029..5.100 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=176.617..176.617 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.004..90.088 rows=71604 loops=1)
                                 ->  Hash  (cost=737704.72..737704.72 rows=89286 width=8) (actual time=5225.675..5225.675 rows=83765 loops=1)
                                       ->  Subquery Scan l  (cost=735919.00..737704.72 rows=89286 width=8) (actual time=4847.280..5119.880 rows=83765 loops=1)
                                             ->  HashAggregate  (cost=735919.00..736811.86 rows=89286 width=24) (actual time=4847.278..4954.425 rows=83765 loops=1)
                                                   ->  Merge Join  (cost=0.00..734579.71 rows=89286 width=24) (actual time=0.053..3733.278 rows=772546 loops=1)
                                                         Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=0.022..447.758 rows=351543 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..379869.35 rows=639324 width=20) (actual time=0.019..1014.411 rows=798679 loops=1)
                                                               Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.29 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l.lid1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 5452.995 ms
(33 rows)

Time: 5466.694 ms
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=770148.86..770160.11 rows=500 width=52) (actual time=5448.347..5451.010 rows=500 loops=1)
   ->  Unique  (cost=770148.86..770160.72 rows=527 width=52) (actual time=5448.344..5450.046 rows=500 loops=1)
         ->  Sort  (cost=770148.86..770150.18 rows=527 width=52) (actual time=5448.341..5448.890 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=741613.88..770125.04 rows=527 width=52) (actual time=5401.229..5445.830 rows=1114 loops=1)
                     ->  Nested Loop  (cost=741613.88..768686.33 rows=534 width=42) (actual time=5401.213..5435.477 rows=1114 loops=1)
                           ->  Hash Join  (cost=741613.88..768523.33 rows=534 width=24) (actual time=5401.181..5425.739 rows=1114 loops=1)
                                 Hash Cond: (a2_.id = l.lid2)
                                 ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=176.526..198.546 rows=686 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.117..13.976 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.082..0.219 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.029..5.279 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=176.364..176.364 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.004..89.837 rows=71604 loops=1)
                                 ->  Hash  (cost=737704.72..737704.72 rows=89286 width=8) (actual time=5224.590..5224.590 rows=83765 loops=1)
                                       ->  Subquery Scan l  (cost=735919.00..737704.72 rows=89286 width=8) (actual time=4847.741..5118.842 rows=83765 loops=1)
                                             ->  HashAggregate  (cost=735919.00..736811.86 rows=89286 width=24) (actual time=4847.737..4954.254 rows=83765 loops=1)
                                                   ->  Merge Join  (cost=0.00..734579.71 rows=89286 width=24) (actual time=0.052..3729.734 rows=772546 loops=1)
                                                         Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=0.021..447.640 rows=351543 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..379869.35 rows=639324 width=20) (actual time=0.019..1015.061 rows=798679 loops=1)
                                                               Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.29 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l.lid1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 5452.034 ms
(33 rows)

Time: 5457.358 ms
                                                                                                               QUERY PLAN                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=348949.86..348951.09 rows=45 width=66) (actual time=2966.361..2986.721 rows=6492 loops=1)
   ->  Sort  (cost=348949.86..348949.97 rows=45 width=66) (actual time=2966.358..2972.773 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=348483.04..348948.62 rows=45 width=66) (actual time=1724.309..2948.648 rows=6492 loops=1)
               ->  Nested Loop  (cost=348483.04..348848.13 rows=45 width=55) (actual time=1675.978..2835.903 rows=6492 loops=1)
                     ->  Nested Loop  (cost=348483.04..348791.21 rows=45 width=45) (actual time=1675.754..2634.619 rows=6492 loops=1)
                           ->  Nested Loop  (cost=348483.04..348777.83 rows=46 width=31) (actual time=1675.737..2577.871 rows=6499 loops=1)
                                 ->  Merge Join  (cost=348483.04..348709.54 rows=46 width=12) (actual time=1643.191..1672.920 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.263..22.628 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.107..13.474 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.077..0.203 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.026..4.915 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=324038.77..324058.03 rows=7704 width=8) (actual time=1616.682..1627.300 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=323387.34..323541.42 rows=7704 width=8) (actual time=1420.416..1552.338 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=323387.34..323464.38 rows=7704 width=24) (actual time=1420.412..1472.274 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..323271.78 rows=7704 width=24) (actual time=7.532..1330.093 rows=54551 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=7.425..81.621 rows=38503 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.047..658.989 rows=420149 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.47 rows=1 width=23) (actual time=0.134..0.135 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.026..0.027 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.22 rows=1 width=19) (actual time=0.011..0.013 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 2993.106 ms
(39 rows)

Time: 3010.928 ms
                                                                                                               QUERY PLAN                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=348949.86..348951.09 rows=45 width=66) (actual time=1750.933..1771.229 rows=6492 loops=1)
   ->  Sort  (cost=348949.86..348949.97 rows=45 width=66) (actual time=1750.929..1757.367 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=348483.04..348948.62 rows=45 width=66) (actual time=1474.798..1734.126 rows=6492 loops=1)
               ->  Nested Loop  (cost=348483.04..348848.13 rows=45 width=55) (actual time=1474.786..1679.019 rows=6492 loops=1)
                     ->  Nested Loop  (cost=348483.04..348791.21 rows=45 width=45) (actual time=1474.770..1618.789 rows=6492 loops=1)
                           ->  Nested Loop  (cost=348483.04..348777.83 rows=46 width=31) (actual time=1474.755..1563.769 rows=6499 loops=1)
                                 ->  Merge Join  (cost=348483.04..348709.54 rows=46 width=12) (actual time=1474.721..1504.117 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.267..22.564 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.105..13.481 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.204 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.024..4.926 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=324038.77..324058.03 rows=7704 width=8) (actual time=1448.207..1458.814 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=323387.34..323541.42 rows=7704 width=8) (actual time=1253.680..1385.743 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=323387.34..323464.38 rows=7704 width=24) (actual time=1253.676..1305.661 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..323271.78 rows=7704 width=24) (actual time=0.096..1166.424 rows=54551 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=0.021..48.841 rows=38503 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.016..528.747 rows=420149 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.47 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.22 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 1777.624 ms
(39 rows)

Time: 1782.092 ms
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=348949.86..348951.09 rows=45 width=66) (actual time=1748.147..1750.660 rows=500 loops=1)
   ->  Unique  (cost=348949.86..348951.09 rows=45 width=66) (actual time=1748.144..1749.695 rows=500 loops=1)
         ->  Sort  (cost=348949.86..348949.97 rows=45 width=66) (actual time=1748.140..1748.633 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=348483.04..348948.62 rows=45 width=66) (actual time=1471.655..1731.375 rows=6492 loops=1)
                     ->  Nested Loop  (cost=348483.04..348848.13 rows=45 width=55) (actual time=1471.641..1676.339 rows=6492 loops=1)
                           ->  Nested Loop  (cost=348483.04..348791.21 rows=45 width=45) (actual time=1471.626..1615.946 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=348483.04..348777.83 rows=46 width=31) (actual time=1471.610..1560.975 rows=6499 loops=1)
                                       ->  Merge Join  (cost=348483.04..348709.54 rows=46 width=12) (actual time=1471.577..1501.111 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.231..22.577 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.105..13.437 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.197 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.024..4.930 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=324038.77..324058.03 rows=7704 width=8) (actual time=1445.087..1455.715 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=323387.34..323541.42 rows=7704 width=8) (actual time=1250.879..1383.015 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=323387.34..323464.38 rows=7704 width=24) (actual time=1250.876..1302.590 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..323271.78 rows=7704 width=24) (actual time=0.096..1164.127 rows=54551 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=0.021..48.906 rows=38503 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.016..530.472 rows=420149 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.47 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.22 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 1751.356 ms
(40 rows)

Time: 1755.857 ms
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=348949.86..348951.09 rows=45 width=66) (actual time=1747.796..1750.293 rows=500 loops=1)
   ->  Unique  (cost=348949.86..348951.09 rows=45 width=66) (actual time=1747.793..1749.332 rows=500 loops=1)
         ->  Sort  (cost=348949.86..348949.97 rows=45 width=66) (actual time=1747.790..1748.281 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=348483.04..348948.62 rows=45 width=66) (actual time=1471.114..1730.927 rows=6492 loops=1)
                     ->  Nested Loop  (cost=348483.04..348848.13 rows=45 width=55) (actual time=1471.100..1675.684 rows=6492 loops=1)
                           ->  Nested Loop  (cost=348483.04..348791.21 rows=45 width=45) (actual time=1471.084..1615.480 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=348483.04..348777.83 rows=46 width=31) (actual time=1471.069..1560.426 rows=6499 loops=1)
                                       ->  Merge Join  (cost=348483.04..348709.54 rows=46 width=12) (actual time=1471.037..1500.397 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.226..22.627 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.105..13.424 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.196 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..4.930 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=324038.77..324058.03 rows=7704 width=8) (actual time=1444.536..1455.007 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=323387.34..323541.42 rows=7704 width=8) (actual time=1250.790..1382.742 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=323387.34..323464.38 rows=7704 width=24) (actual time=1250.787..1302.509 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..323271.78 rows=7704 width=24) (actual time=0.096..1162.334 rows=54551 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=0.021..48.646 rows=38503 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.016..527.815 rows=420149 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.47 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.22 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 1750.976 ms
(40 rows)

Time: 1755.509 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1808109.26..1808189.59 rows=6427 width=46) (actual time=39599.708..39622.461 rows=7408 loops=1)
   ->  Sort  (cost=1808109.26..1808125.32 rows=6427 width=46) (actual time=39599.704..39607.133 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Nested Loop  (cost=1777893.21..1807702.75 rows=6427 width=46) (actual time=33594.919..39582.115 rows=7408 loops=1)
               ->  Nested Loop  (cost=1777893.21..1805615.67 rows=6427 width=32) (actual time=33594.884..39490.029 rows=7408 loops=1)
                     ->  Hash Join  (cost=1777893.21..1803456.74 rows=6427 width=32) (actual time=33550.783..36578.695 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=1751581.42..1762317.93 rows=1073651 width=24) (actual time=33142.850..34669.588 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=1133995.24..1735476.65 rows=1073651 width=24) (actual time=11131.532..27195.971 rows=4044637 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..380857.72 rows=641856 width=20) (actual time=0.062..950.299 rows=650788 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11131.448..15737.497 rows=4762678 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 412983kB
                                             ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=957.900..5990.620 rows=4027879 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=939.414..939.414 rows=4027879 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=407.867..407.867 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=342.917..398.507 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=22.495..59.451 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.080..0.214 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=22.409..46.069 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=320.355..320.355 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=3.703..184.213 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.32 rows=1 width=8) (actual time=0.031..0.032 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.007..0.008 rows=1 loops=7408)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 39703.735 ms
(37 rows)

Time: 39776.856 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1808109.26..1808189.59 rows=6427 width=46) (actual time=37353.307..37376.048 rows=7408 loops=1)
   ->  Sort  (cost=1808109.26..1808125.32 rows=6427 width=46) (actual time=37353.302..37360.735 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Nested Loop  (cost=1777893.21..1807702.75 rows=6427 width=46) (actual time=33482.581..37335.682 rows=7408 loops=1)
               ->  Nested Loop  (cost=1777893.21..1805615.67 rows=6427 width=32) (actual time=33482.549..37256.953 rows=7408 loops=1)
                     ->  Hash Join  (cost=1777893.21..1803456.74 rows=6427 width=32) (actual time=33482.291..36530.693 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=1751581.42..1762317.93 rows=1073651 width=24) (actual time=33166.128..34709.528 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=1133995.24..1735476.65 rows=1073651 width=24) (actual time=11185.555..27217.223 rows=4044637 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..380857.72 rows=641856 width=20) (actual time=0.057..916.677 rows=650788 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11185.475..15786.992 rows=4762678 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 412983kB
                                             ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=1037.477..6047.256 rows=4027879 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=1018.996..1018.996 rows=4027879 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=316.095..316.095 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=267.168..307.231 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.204..21.378 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.137..0.346 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.061..7.965 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=266.890..266.890 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..132.278 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.32 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 37458.159 ms
(37 rows)

Time: 37467.223 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1808109.26..1808115.51 rows=500 width=46) (actual time=37310.592..37313.063 rows=500 loops=1)
   ->  Unique  (cost=1808109.26..1808189.59 rows=6427 width=46) (actual time=37310.589..37312.123 rows=500 loops=1)
         ->  Sort  (cost=1808109.26..1808125.32 rows=6427 width=46) (actual time=37310.585..37311.073 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Nested Loop  (cost=1777893.21..1807702.75 rows=6427 width=46) (actual time=33446.362..37293.281 rows=7408 loops=1)
                     ->  Nested Loop  (cost=1777893.21..1805615.67 rows=6427 width=32) (actual time=33446.328..37214.603 rows=7408 loops=1)
                           ->  Hash Join  (cost=1777893.21..1803456.74 rows=6427 width=32) (actual time=33446.067..36485.683 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1751581.42..1762317.93 rows=1073651 width=24) (actual time=33130.316..34669.726 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=1133995.24..1735476.65 rows=1073651 width=24) (actual time=11158.154..27212.623 rows=4044637 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..380857.72 rows=641856 width=20) (actual time=0.057..915.022 rows=650788 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11158.076..15765.474 rows=4762678 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 412983kB
                                                   ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=1004.234..6014.796 rows=4027879 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=985.757..985.757 rows=4027879 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=315.684..315.684 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=266.803..306.777 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.200..21.430 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.135..0.349 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.060..7.977 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=266.539..266.539 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..131.280 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.32 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 37388.456 ms
(38 rows)

Time: 37397.441 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1808109.26..1808115.51 rows=500 width=46) (actual time=37368.276..37370.754 rows=500 loops=1)
   ->  Unique  (cost=1808109.26..1808189.59 rows=6427 width=46) (actual time=37368.273..37369.811 rows=500 loops=1)
         ->  Sort  (cost=1808109.26..1808125.32 rows=6427 width=46) (actual time=37368.269..37368.771 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Nested Loop  (cost=1777893.21..1807702.75 rows=6427 width=46) (actual time=33493.062..37350.818 rows=7408 loops=1)
                     ->  Nested Loop  (cost=1777893.21..1805615.67 rows=6427 width=32) (actual time=33493.031..37271.472 rows=7408 loops=1)
                           ->  Hash Join  (cost=1777893.21..1803456.74 rows=6427 width=32) (actual time=33492.778..36539.506 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1751581.42..1762317.93 rows=1073651 width=24) (actual time=33176.535..34721.007 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=1133995.24..1735476.65 rows=1073651 width=24) (actual time=11202.591..27249.719 rows=4044637 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..380857.72 rows=641856 width=20) (actual time=0.054..916.698 rows=650788 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11202.514..15805.822 rows=4762678 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 412983kB
                                                   ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=1035.908..6045.969 rows=4027879 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=1017.469..1017.469 rows=4027879 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=316.173..316.173 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=267.162..307.332 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.199..21.531 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.135..0.335 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.059..8.030 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=266.897..266.897 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.011..131.500 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.32 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 37446.498 ms
(38 rows)

Time: 37455.504 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=724968.82..724974.43 rows=449 width=37) (actual time=4597.065..4598.073 rows=341 loops=1)
   ->  Sort  (cost=724968.82..724969.94 rows=449 width=37) (actual time=4597.062..4597.389 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=723691.09..724949.04 rows=449 width=37) (actual time=4558.489..4596.417 rows=341 loops=1)
               ->  Nested Loop  (cost=723691.09..724671.04 rows=449 width=26) (actual time=4558.430..4593.316 rows=341 loops=1)
                     ->  Nested Loop  (cost=723691.09..724525.56 rows=449 width=12) (actual time=4558.416..4590.157 rows=341 loops=1)
                           ->  Merge Join  (cost=723691.09..724257.86 rows=449 width=12) (actual time=4558.316..4566.083 rows=2193 loops=1)
                                 Merge Cond: (indirect1.bioentities = l.lid2)
                                 ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=14.775..15.323 rows=546 loops=1)
                                       Sort Key: indirect1.bioentities
                                       Sort Method:  quicksort  Memory: 50kB
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=6.298..14.167 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.137..0.344 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=6.154..12.725 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Sort  (cost=699246.82..699434.19 rows=74950 width=8) (actual time=4431.069..4489.401 rows=55850 loops=1)
                                       Sort Key: l.lid2
                                       Sort Method:  quicksort  Memory: 13659kB
                                       ->  Subquery Scan l  (cost=691679.25..693178.25 rows=74950 width=8) (actual time=3656.212..4171.156 rows=160316 loops=1)
                                             ->  HashAggregate  (cost=691679.25..692428.75 rows=74950 width=24) (actual time=3656.209..3860.410 rows=160316 loops=1)
                                                   ->  Nested Loop  (cost=0.00..690555.00 rows=74950 width=24) (actual time=0.106..3071.923 rows=393401 loops=1)
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=0.059..52.693 rows=38503 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..14.45 rows=4 width=20) (actual time=0.035..0.053 rows=11 loops=38503)
                                                               Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.58 rows=1 width=8) (actual time=0.008..0.009 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l.lid1)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.61 rows=1 width=19) (actual time=0.004..0.005 rows=1 loops=341)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 4602.130 ms
(36 rows)

Time: 4605.908 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=724968.82..724974.43 rows=449 width=37) (actual time=3430.564..3431.575 rows=341 loops=1)
   ->  Sort  (cost=724968.82..724969.94 rows=449 width=37) (actual time=3430.562..3430.892 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=723691.09..724949.04 rows=449 width=37) (actual time=3400.845..3429.931 rows=341 loops=1)
               ->  Nested Loop  (cost=723691.09..724671.04 rows=449 width=26) (actual time=3400.831..3427.028 rows=341 loops=1)
                     ->  Nested Loop  (cost=723691.09..724525.56 rows=449 width=12) (actual time=3400.818..3423.897 rows=341 loops=1)
                           ->  Merge Join  (cost=723691.09..724257.86 rows=449 width=12) (actual time=3400.719..3408.475 rows=2193 loops=1)
                                 Merge Cond: (indirect1.bioentities = l.lid2)
                                 ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.576..3.132 rows=546 loops=1)
                                       Sort Key: indirect1.bioentities
                                       Sort Method:  quicksort  Memory: 50kB
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.109..1.967 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.079..0.206 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.023..0.684 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Sort  (cost=699246.82..699434.19 rows=74950 width=8) (actual time=3285.013..3343.782 rows=55850 loops=1)
                                       Sort Key: l.lid2
                                       Sort Method:  quicksort  Memory: 13659kB
                                       ->  Subquery Scan l  (cost=691679.25..693178.25 rows=74950 width=8) (actual time=2510.123..3025.577 rows=160316 loops=1)
                                             ->  HashAggregate  (cost=691679.25..692428.75 rows=74950 width=24) (actual time=2510.120..2714.875 rows=160316 loops=1)
                                                   ->  Nested Loop  (cost=0.00..690555.00 rows=74950 width=24) (actual time=0.042..1928.445 rows=393401 loops=1)
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=0.019..49.558 rows=38503 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                         ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..14.45 rows=4 width=20) (actual time=0.010..0.023 rows=11 loops=38503)
                                                               Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.58 rows=1 width=8) (actual time=0.004..0.005 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l.lid1)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.61 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 3435.627 ms
(36 rows)

Time: 3439.310 ms
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=724968.82..724974.43 rows=449 width=37) (actual time=3431.326..3432.969 rows=341 loops=1)
   ->  Unique  (cost=724968.82..724974.43 rows=449 width=37) (actual time=3431.322..3432.323 rows=341 loops=1)
         ->  Sort  (cost=724968.82..724969.94 rows=449 width=37) (actual time=3431.320..3431.649 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=723691.09..724949.04 rows=449 width=37) (actual time=3401.642..3430.677 rows=341 loops=1)
                     ->  Nested Loop  (cost=723691.09..724671.04 rows=449 width=26) (actual time=3401.628..3427.790 rows=341 loops=1)
                           ->  Nested Loop  (cost=723691.09..724525.56 rows=449 width=12) (actual time=3401.615..3424.669 rows=341 loops=1)
                                 ->  Merge Join  (cost=723691.09..724257.86 rows=449 width=12) (actual time=3401.517..3409.232 rows=2193 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.559..3.118 rows=546 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 50kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.109..1.944 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.079..0.237 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.023..0.646 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=699246.82..699434.19 rows=74950 width=8) (actual time=3286.439..3344.793 rows=55850 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 13659kB
                                             ->  Subquery Scan l  (cost=691679.25..693178.25 rows=74950 width=8) (actual time=2510.151..3024.852 rows=160316 loops=1)
                                                   ->  HashAggregate  (cost=691679.25..692428.75 rows=74950 width=24) (actual time=2510.148..2714.190 rows=160316 loops=1)
                                                         ->  Nested Loop  (cost=0.00..690555.00 rows=74950 width=24) (actual time=0.042..1932.250 rows=393401 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=0.018..49.633 rows=38503 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..14.45 rows=4 width=20) (actual time=0.010..0.023 rows=11 loops=38503)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.58 rows=1 width=8) (actual time=0.004..0.005 rows=0 loops=2193)
                                       Index Cond: (a1_.id = l.lid1)
                                       Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                           ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                                 Index Cond: (a4_.id = a1_.geneid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.61 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 3437.008 ms
(37 rows)

Time: 3440.710 ms
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=724968.82..724974.43 rows=449 width=37) (actual time=3428.218..3429.888 rows=341 loops=1)
   ->  Unique  (cost=724968.82..724974.43 rows=449 width=37) (actual time=3428.215..3429.233 rows=341 loops=1)
         ->  Sort  (cost=724968.82..724969.94 rows=449 width=37) (actual time=3428.212..3428.538 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=723691.09..724949.04 rows=449 width=37) (actual time=3398.380..3427.580 rows=341 loops=1)
                     ->  Nested Loop  (cost=723691.09..724671.04 rows=449 width=26) (actual time=3398.366..3424.706 rows=341 loops=1)
                           ->  Nested Loop  (cost=723691.09..724525.56 rows=449 width=12) (actual time=3398.353..3421.578 rows=341 loops=1)
                                 ->  Merge Join  (cost=723691.09..724257.86 rows=449 width=12) (actual time=3398.255..3405.994 rows=2193 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.570..3.118 rows=546 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 50kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.109..1.923 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.079..0.212 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.023..0.644 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=699246.82..699434.19 rows=74950 width=8) (actual time=3282.819..3341.337 rows=55850 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 13659kB
                                             ->  Subquery Scan l  (cost=691679.25..693178.25 rows=74950 width=8) (actual time=2510.219..3022.925 rows=160316 loops=1)
                                                   ->  HashAggregate  (cost=691679.25..692428.75 rows=74950 width=24) (actual time=2510.215..2713.669 rows=160316 loops=1)
                                                         ->  Nested Loop  (cost=0.00..690555.00 rows=74950 width=24) (actual time=0.042..1931.485 rows=393401 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..39520.61 rows=44807 width=20) (actual time=0.019..49.584 rows=38503 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..14.45 rows=4 width=20) (actual time=0.010..0.023 rows=11 loops=38503)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.58 rows=1 width=8) (actual time=0.005..0.005 rows=0 loops=2193)
                                       Index Cond: (a1_.id = l.lid1)
                                       Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                           ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                                 Index Cond: (a4_.id = a1_.geneid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.61 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 3433.913 ms
(37 rows)

Time: 3437.605 ms
                                                                                                           QUERY PLAN                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=2273802.14..2274001.79 rows=7260 width=82) (actual time=86196.449..86323.965 rows=39884 loops=1)
   ->  Sort  (cost=2273802.14..2273820.29 rows=7260 width=82) (actual time=86196.444..86238.279 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=2232003.12..2273336.57 rows=7260 width=82) (actual time=68522.567..86073.595 rows=39884 loops=1)
               ->  Hash Join  (cost=2232003.12..2264152.62 rows=7260 width=72) (actual time=68522.520..84885.530 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=2230037.25..2262039.36 rows=7479 width=58) (actual time=68348.602..84571.292 rows=40032 loops=1)
                           ->  Hash Join  (cost=2230037.25..2259787.40 rows=7479 width=39) (actual time=68348.543..83753.963 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=2187934.51..2200429.40 rows=1249489 width=24) (actual time=67608.799..74272.353 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=1633683.51..2169192.17 rows=1249489 width=24) (actual time=21142.271..55278.115 rows=7443850 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.046..562.618 rows=387227 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=1633683.51..1651850.45 rows=7266776 width=20) (actual time=21142.202..32634.734 rows=11859491 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 760267kB
                                                   ->  Bitmap Heap Scan on locationbin500 l2  (cost=165550.90..805529.60 rows=7266776 width=20) (actual time=2827.117..11878.611 rows=7214832 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..163734.21 rows=7266776 width=0) (actual time=2785.599..2785.599 rows=7214832 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=738.320..738.320 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=65.194..666.859 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=18.865..186.426 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.133..0.210 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=18.723..88.471 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.004..0.006 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.015..0.016 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=173.879..173.879 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=5.136..111.987 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.024..0.025 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 86521.008 ms
(39 rows)

Time: 86551.356 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=2273802.14..2274001.79 rows=7260 width=82) (actual time=85150.359..85277.965 rows=39884 loops=1)
   ->  Sort  (cost=2273802.14..2273820.29 rows=7260 width=82) (actual time=85150.355..85192.051 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=2232003.12..2273336.57 rows=7260 width=82) (actual time=68530.357..85028.065 rows=39884 loops=1)
               ->  Hash Join  (cost=2232003.12..2264152.62 rows=7260 width=72) (actual time=68530.310..84557.339 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=2230037.25..2262039.36 rows=7479 width=58) (actual time=68405.506..84292.972 rows=40032 loops=1)
                           ->  Hash Join  (cost=2230037.25..2259787.40 rows=7479 width=39) (actual time=68405.447..83813.016 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=2187934.51..2200429.40 rows=1249489 width=24) (actual time=67759.320..74438.493 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=1633683.51..2169192.17 rows=1249489 width=24) (actual time=21150.756..55410.687 rows=7443850 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.047..560.981 rows=387227 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=1633683.51..1651850.45 rows=7266776 width=20) (actual time=21150.686..32724.534 rows=11859491 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 760267kB
                                                   ->  Bitmap Heap Scan on locationbin500 l2  (cost=165550.90..805529.60 rows=7266776 width=20) (actual time=2852.905..11933.864 rows=7214832 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..163734.21 rows=7266776 width=0) (actual time=2811.456..2811.456 rows=7214832 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=644.715..644.715 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.319..574.167 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.273..155.942 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.209..0.327 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.057..58.270 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.006..0.008 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.767..124.767 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..62.678 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 85475.550 ms
(39 rows)

Time: 85481.219 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2273802.14..2273815.89 rows=500 width=82) (actual time=84953.944..84956.512 rows=500 loops=1)
   ->  Unique  (cost=2273802.14..2274001.79 rows=7260 width=82) (actual time=84953.941..84955.551 rows=500 loops=1)
         ->  Sort  (cost=2273802.14..2273820.29 rows=7260 width=82) (actual time=84953.936..84954.460 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=2232003.12..2273336.57 rows=7260 width=82) (actual time=68341.501..84831.843 rows=39884 loops=1)
                     ->  Hash Join  (cost=2232003.12..2264152.62 rows=7260 width=72) (actual time=68341.456..84361.762 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=2230037.25..2262039.36 rows=7479 width=58) (actual time=68217.235..84097.178 rows=40032 loops=1)
                                 ->  Hash Join  (cost=2230037.25..2259787.40 rows=7479 width=39) (actual time=68217.178..83614.408 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=2187934.51..2200429.40 rows=1249489 width=24) (actual time=67572.064..74245.563 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=1633683.51..2169192.17 rows=1249489 width=24) (actual time=21037.505..55148.325 rows=7443850 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.046..557.195 rows=387227 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=1633683.51..1651850.45 rows=7266776 width=20) (actual time=21037.438..32527.621 rows=11859491 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  quicksort  Memory: 760267kB
                                                         ->  Bitmap Heap Scan on locationbin500 l2  (cost=165550.90..805529.60 rows=7266776 width=20) (actual time=2785.458..11819.059 rows=7214832 loops=1)
                                                               Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                               ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..163734.21 rows=7266776 width=0) (actual time=2744.004..2744.004 rows=7214832 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.702..643.702 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.317..572.542 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.272..155.961 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.210..0.321 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.056..58.022 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.006..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.180..124.180 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..62.283 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 85115.588 ms
(40 rows)

Time: 85121.308 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2273802.14..2273815.89 rows=500 width=82) (actual time=85094.649..85097.222 rows=500 loops=1)
   ->  Unique  (cost=2273802.14..2274001.79 rows=7260 width=82) (actual time=85094.645..85096.260 rows=500 loops=1)
         ->  Sort  (cost=2273802.14..2273820.29 rows=7260 width=82) (actual time=85094.641..85095.169 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=2232003.12..2273336.57 rows=7260 width=82) (actual time=68483.653..84972.804 rows=39884 loops=1)
                     ->  Hash Join  (cost=2232003.12..2264152.62 rows=7260 width=72) (actual time=68483.608..84504.182 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=2230037.25..2262039.36 rows=7479 width=58) (actual time=68358.287..84239.327 rows=40032 loops=1)
                                 ->  Hash Join  (cost=2230037.25..2259787.40 rows=7479 width=39) (actual time=68358.228..83759.880 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=2187934.51..2200429.40 rows=1249489 width=24) (actual time=67710.131..74383.932 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=1633683.51..2169192.17 rows=1249489 width=24) (actual time=21150.892..55288.504 rows=7443850 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..280413.99 rows=414611 width=20) (actual time=0.046..559.429 rows=387227 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=1633683.51..1651850.45 rows=7266776 width=20) (actual time=21150.822..32638.561 rows=11859491 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  quicksort  Memory: 760267kB
                                                         ->  Bitmap Heap Scan on locationbin500 l2  (cost=165550.90..805529.60 rows=7266776 width=20) (actual time=2901.936..11929.312 rows=7214832 loops=1)
                                                               Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                               ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..163734.21 rows=7266776 width=0) (actual time=2860.494..2860.494 rows=7214832 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=646.679..646.679 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.322..575.682 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.277..157.398 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.212..0.323 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.057..58.298 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.006..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.284..125.284 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..62.861 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 85256.503 ms
(40 rows)

Time: 85262.581 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=5608037.93..5608947.43 rows=72760 width=53) (actual time=406699.900..406756.077 rows=17651 loops=1)
   ->  Sort  (cost=5608037.93..5608219.83 rows=72760 width=53) (actual time=406699.896..406718.449 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=5311289.85..5602162.25 rows=72760 width=53) (actual time=306317.578..406633.934 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=5295421.89..5584839.09 rows=72760 width=39) (actual time=305583.584..405292.161 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=5253319.15..5374872.66 rows=12155351 width=24) (actual time=304941.546..349858.086 rows=29345747 loops=1)
                           ->  Merge Join  (cost=1133995.24..5070988.88 rows=12155351 width=24) (actual time=11158.434..212686.996 rows=51962102 loops=1)
                                 Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.065..10607.755 rows=7212274 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11158.221..68878.482 rows=59273472 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 412983kB
                                       ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=990.887..6023.592 rows=4027879 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                             ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=972.498..972.498 rows=4027879 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=641.869..641.869 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.305..571.306 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.263..156.252 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.204..0.315 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.051..57.816 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=720.933..720.933 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=199.758..647.454 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=74.927..373.659 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=73.117..73.117 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.741..124.741 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.017..62.569 rows=48661 loops=1)
 Total runtime: 407259.543 ms
(40 rows)

Time: 407289.078 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=5608037.93..5608947.43 rows=72760 width=53) (actual time=403300.570..403356.779 rows=17651 loops=1)
   ->  Sort  (cost=5608037.93..5608219.83 rows=72760 width=53) (actual time=403300.566..403319.087 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=5311289.85..5602162.25 rows=72760 width=53) (actual time=303077.415..403236.404 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=5295421.89..5584839.09 rows=72760 width=39) (actual time=302513.513..402069.613 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=5253319.15..5374872.66 rows=12155351 width=24) (actual time=301868.670..346542.473 rows=29345747 loops=1)
                           ->  Merge Join  (cost=1133995.24..5070988.88 rows=12155351 width=24) (actual time=11227.446..210600.278 rows=51962102 loops=1)
                                 Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.065..10304.203 rows=7212274 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11227.231..68570.605 rows=59273472 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 412983kB
                                       ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=1038.953..6082.212 rows=4027879 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                             ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=1020.553..1020.553 rows=4027879 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=644.685..644.685 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.314..573.931 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.268..156.827 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.208..0.319 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..58.090 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=550.929..550.929 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=141.200..483.888 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=16.035..220.694 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=14.232..14.232 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.087..125.087 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.895 rows=48661 loops=1)
 Total runtime: 403857.692 ms
(40 rows)

Time: 403886.181 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5607243.00..5607244.25 rows=500 width=53) (actual time=405336.180..405337.618 rows=500 loops=1)
   ->  Sort  (cost=5607243.00..5607424.90 rows=72760 width=53) (actual time=405336.176..405336.657 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=5602889.85..5603617.45 rows=72760 width=53) (actual time=405288.490..405310.212 rows=17651 loops=1)
               ->  Hash Join  (cost=5311289.85..5602162.25 rows=72760 width=53) (actual time=303836.135..405220.804 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=5295421.89..5584839.09 rows=72760 width=39) (actual time=303274.589..404041.580 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=5253319.15..5374872.66 rows=12155351 width=24) (actual time=302630.660..347924.673 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=1133995.24..5070988.88 rows=12155351 width=24) (actual time=11202.555..211748.818 rows=51962102 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.065..10349.602 rows=7212274 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11202.338..69042.860 rows=59273472 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 412983kB
                                             ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=983.097..6039.940 rows=4027879 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=964.592..964.592 rows=4027879 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.770..643.770 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.312..572.681 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.267..157.535 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.209..0.322 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.051..58.539 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=548.568..548.568 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=141.813..480.969 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=16.131..217.579 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=14.241..14.241 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.596..125.596 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..63.251 rows=48661 loops=1)
 Total runtime: 405825.807 ms
(41 rows)

Time: 405851.530 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5607243.00..5607244.25 rows=500 width=53) (actual time=404266.041..404267.475 rows=500 loops=1)
   ->  Sort  (cost=5607243.00..5607424.90 rows=72760 width=53) (actual time=404266.037..404266.526 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=5602889.85..5603617.45 rows=72760 width=53) (actual time=404217.520..404240.090 rows=17651 loops=1)
               ->  Hash Join  (cost=5311289.85..5602162.25 rows=72760 width=53) (actual time=303026.317..404149.450 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=5295421.89..5584839.09 rows=72760 width=39) (actual time=302467.078..402979.705 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=5253319.15..5374872.66 rows=12155351 width=24) (actual time=301821.333..347067.231 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=1133995.24..5070988.88 rows=12155351 width=24) (actual time=11278.276..211015.613 rows=51962102 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.065..10368.825 rows=7212274 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Sort  (cost=1133995.24..1144078.84 rows=4033441 width=20) (actual time=11278.061..68934.887 rows=59273472 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 412983kB
                                             ->  Bitmap Heap Scan on locationbin500 l1  (cost=91892.55..691454.57 rows=4033441 width=20) (actual time=1033.638..6119.965 rows=4027879 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..90884.19 rows=4033441 width=0) (actual time=1015.255..1015.255 rows=4027879 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=645.583..645.583 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.309..574.706 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.267..157.960 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.207..0.323 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.051..58.479 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=546.247..546.247 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=141.729..479.386 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=16.123..214.558 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=14.149..14.149 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.518..125.518 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..63.005 rows=48661 loops=1)
 Total runtime: 404755.882 ms
(41 rows)

Time: 404781.337 ms
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=737530.23..737552.38 rows=8860 width=4) (actual time=1355.358..1355.474 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=699851.41..736949.32 rows=8860 width=4) (actual time=70.808..1355.144 rows=118 loops=1)
         ->  HashAggregate  (cost=699851.41..699940.01 rows=8860 width=24) (actual time=23.942..24.168 rows=120 loops=1)
               ->  Nested Loop  (cost=19.43..699718.51 rows=8860 width=24) (actual time=0.395..22.062 rows=1371 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin500__subjectid on locationbin500 l1  (cost=0.00..300.31 rows=450 width=20) (actual time=0.105..0.117 rows=8 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin500 l2  (cost=19.43..1532.00 rows=1113 width=20) (actual time=0.138..1.419 rows=995 loops=8)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin500__bin  (cost=0.00..19.15 rows=1113 width=0) (actual time=0.126..0.126 rows=995 loops=8)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.15 rows=1 width=4) (actual time=11.047..11.087 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 1355.713 ms
(16 rows)

Time: 1357.829 ms
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=737530.23..737552.38 rows=8860 width=4) (actual time=23.861..23.974 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=699851.41..736949.32 rows=8860 width=4) (actual time=22.241..23.695 rows=118 loops=1)
         ->  HashAggregate  (cost=699851.41..699940.01 rows=8860 width=24) (actual time=22.226..22.431 rows=120 loops=1)
               ->  Nested Loop  (cost=19.43..699718.51 rows=8860 width=24) (actual time=0.179..20.347 rows=1371 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin500__subjectid on locationbin500 l1  (cost=0.00..300.31 rows=450 width=20) (actual time=0.016..0.026 rows=8 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin500 l2  (cost=19.43..1532.00 rows=1113 width=20) (actual time=0.109..1.210 rows=995 loops=8)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin500__bin  (cost=0.00..19.15 rows=1113 width=0) (actual time=0.099..0.099 rows=995 loops=8)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.15 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 24.204 ms
(16 rows)

Time: 25.449 ms
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=700609.52..720426.01 rows=500 width=4) (actual time=27.727..19617.725 rows=118 loops=1)
   ->  Merge Join  (cost=700609.52..1051757.81 rows=8860 width=4) (actual time=27.723..19617.428 rows=118 loops=1)
         Merge Cond: (a1_.id = l.lid2)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..335098.61 rows=6366713 width=4) (actual time=2.459..13066.409 rows=5971604 loops=1)
         ->  Sort  (cost=700609.52..700631.67 rows=8860 width=4) (actual time=22.939..23.193 rows=120 loops=1)
               Sort Key: l.lid2
               Sort Method:  quicksort  Memory: 30kB
               ->  Subquery Scan l  (cost=699851.41..700028.61 rows=8860 width=4) (actual time=22.364..22.779 rows=120 loops=1)
                     ->  HashAggregate  (cost=699851.41..699940.01 rows=8860 width=24) (actual time=22.360..22.540 rows=120 loops=1)
                           ->  Nested Loop  (cost=19.43..699718.51 rows=8860 width=24) (actual time=0.171..20.496 rows=1371 loops=1)
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                                 ->  Index Scan using locationbin500__subjectid on locationbin500 l1  (cost=0.00..300.31 rows=450 width=20) (actual time=0.013..0.024 rows=8 loops=1)
                                       Index Cond: (232042548 = subjectid)
                                 ->  Bitmap Heap Scan on locationbin500 l2  (cost=19.43..1532.00 rows=1113 width=20) (actual time=0.108..1.213 rows=995 loops=8)
                                       Recheck Cond: (l2.bin = l1.bin)
                                       ->  Bitmap Index Scan on locationbin500__bin  (cost=0.00..19.15 rows=1113 width=0) (actual time=0.098..0.098 rows=995 loops=8)
                                             Index Cond: (l2.bin = l1.bin)
 Total runtime: 19618.052 ms
(18 rows)

Time: 19619.394 ms
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=700609.52..720426.01 rows=500 width=4) (actual time=24.676..14393.984 rows=118 loops=1)
   ->  Merge Join  (cost=700609.52..1051757.81 rows=8860 width=4) (actual time=24.673..14393.673 rows=118 loops=1)
         Merge Cond: (a1_.id = l.lid2)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..335098.61 rows=6366713 width=4) (actual time=0.048..7867.653 rows=5971604 loops=1)
         ->  Sort  (cost=700609.52..700631.67 rows=8860 width=4) (actual time=24.559..24.751 rows=120 loops=1)
               Sort Key: l.lid2
               Sort Method:  quicksort  Memory: 30kB
               ->  Subquery Scan l  (cost=699851.41..700028.61 rows=8860 width=4) (actual time=23.974..24.390 rows=120 loops=1)
                     ->  HashAggregate  (cost=699851.41..699940.01 rows=8860 width=24) (actual time=23.971..24.159 rows=120 loops=1)
                           ->  Nested Loop  (cost=19.43..699718.51 rows=8860 width=24) (actual time=0.321..22.113 rows=1371 loops=1)
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                                 ->  Index Scan using locationbin500__subjectid on locationbin500 l1  (cost=0.00..300.31 rows=450 width=20) (actual time=0.049..0.063 rows=8 loops=1)
                                       Index Cond: (232042548 = subjectid)
                                 ->  Bitmap Heap Scan on locationbin500 l2  (cost=19.43..1532.00 rows=1113 width=20) (actual time=0.139..1.424 rows=995 loops=8)
                                       Recheck Cond: (l2.bin = l1.bin)
                                       ->  Bitmap Index Scan on locationbin500__bin  (cost=0.00..19.15 rows=1113 width=0) (actual time=0.126..0.126 rows=995 loops=8)
                                             Index Cond: (l2.bin = l1.bin)
 Total runtime: 14394.262 ms
(18 rows)

Time: 14395.641 ms
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=846758.44..846997.97 rows=95813 width=46) (actual time=7690.463..7826.063 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=833082.13..838830.91 rows=95813 width=46) (actual time=6375.971..7263.964 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=828754.18..832586.70 rows=95813 width=22) (actual time=6110.899..6633.943 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=826788.31..827746.44 rows=95813 width=24) (actual time=5987.421..6158.233 rows=129835 loops=1)
                     ->  Merge Join  (cost=564901.95..825351.11 rows=95813 width=24) (actual time=2640.038..5272.001 rows=508896 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=0.070..240.033 rows=180535 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=564901.95..566617.09 rows=686058 width=20) (actual time=2639.946..3392.285 rows=757787 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 79774kB
                                 ->  Bitmap Heap Scan on locationbin500 l2  (cost=15564.59..498395.59 rows=686058 width=20) (actual time=181.742..1063.322 rows=706533 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..15393.07 rows=686058 width=0) (actual time=179.913..179.913 rows=706533 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.425..123.425 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.836 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=265.010..265.010 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.035..131.604 rows=103331 loops=1)
 Total runtime: 7959.325 ms
(25 rows)

Time: 7961.366 ms
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=846758.44..846997.97 rows=95813 width=46) (actual time=7610.088..7745.405 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=833082.13..838830.91 rows=95813 width=46) (actual time=6298.702..7185.195 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=828754.18..832586.70 rows=95813 width=22) (actual time=6042.626..6565.123 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=826788.31..827746.44 rows=95813 width=24) (actual time=5921.168..6092.240 rows=129835 loops=1)
                     ->  Merge Join  (cost=564901.95..825351.11 rows=95813 width=24) (actual time=2582.754..5205.974 rows=508896 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=0.027..230.486 rows=180535 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=564901.95..566617.09 rows=686058 width=20) (actual time=2582.704..3335.700 rows=757787 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 79774kB
                                 ->  Bitmap Heap Scan on locationbin500 l2  (cost=15564.59..498395.59 rows=686058 width=20) (actual time=135.275..998.791 rows=706533 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..15393.07 rows=686058 width=0) (actual time=133.471..133.471 rows=706533 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.405..121.405 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..62.387 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=256.015..256.015 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.011..128.981 rows=103331 loops=1)
 Total runtime: 7878.409 ms
(25 rows)

Time: 7880.382 ms
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=843605.16..843606.41 rows=500 width=46) (actual time=7366.303..7367.735 rows=500 loops=1)
   ->  Sort  (cost=843605.16..843844.70 rows=95813 width=46) (actual time=7366.301..7366.788 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=833082.13..838830.91 rows=95813 width=46) (actual time=6291.340..7183.646 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=828754.18..832586.70 rows=95813 width=22) (actual time=6035.007..6559.546 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=826788.31..827746.44 rows=95813 width=24) (actual time=5913.944..6085.664 rows=129835 loops=1)
                           ->  Merge Join  (cost=564901.95..825351.11 rows=95813 width=24) (actual time=2578.224..5197.785 rows=508896 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=0.026..230.721 rows=180535 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=564901.95..566617.09 rows=686058 width=20) (actual time=2578.175..3329.608 rows=757787 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 79774kB
                                       ->  Bitmap Heap Scan on locationbin500 l2  (cost=15564.59..498395.59 rows=686058 width=20) (actual time=134.937..989.874 rows=706533 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..15393.07 rows=686058 width=0) (actual time=133.133..133.133 rows=706533 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.006..121.006 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..62.183 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=256.272..256.272 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.011..129.736 rows=103331 loops=1)
 Total runtime: 7377.755 ms
(26 rows)

Time: 7379.742 ms
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=843605.16..843606.41 rows=500 width=46) (actual time=7367.263..7368.704 rows=500 loops=1)
   ->  Sort  (cost=843605.16..843844.70 rows=95813 width=46) (actual time=7367.259..7367.744 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=833082.13..838830.91 rows=95813 width=46) (actual time=6290.167..7184.201 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=828754.18..832586.70 rows=95813 width=22) (actual time=6034.859..6560.638 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=826788.31..827746.44 rows=95813 width=24) (actual time=5914.218..6086.349 rows=129835 loops=1)
                           ->  Merge Join  (cost=564901.95..825351.11 rows=95813 width=24) (actual time=2583.275..5202.403 rows=508896 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..239363.35 rows=336753 width=20) (actual time=0.026..230.787 rows=180535 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=564901.95..566617.09 rows=686058 width=20) (actual time=2583.225..3335.494 rows=757787 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 79774kB
                                       ->  Bitmap Heap Scan on locationbin500 l2  (cost=15564.59..498395.59 rows=686058 width=20) (actual time=135.084..995.717 rows=706533 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin500__subjecttypeid  (cost=0.00..15393.07 rows=686058 width=0) (actual time=133.293..133.293 rows=706533 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=120.586..120.586 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..61.756 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=255.247..255.247 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.011..128.600 rows=103331 loops=1)
 Total runtime: 7378.802 ms
(26 rows)

Time: 7380.832 ms
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2048694.40..2050306.33 rows=644775 width=135) (actual time=45507.977..46409.298 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=1943762.31..1986478.65 rows=644775 width=135) (actual time=33752.101..40654.901 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=1740265.84..1768474.74 rows=644775 width=49) (actual time=22022.659..25876.333 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=1738809.78..1745257.53 rows=644775 width=24) (actual time=21888.876..23147.362 rows=800907 loops=1)
                     ->  Merge Join  (cost=0.00..1729138.16 rows=644775 width=24) (actual time=0.157..20052.915 rows=1091759 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..165488.65 rows=213952 width=20) (actual time=0.067..396.832 rows=239350 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.051..9957.020 rows=7226464 loops=1)
                                 Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=133.737..133.737 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=4.842..84.271 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11725.812..11725.812 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=4.374..5753.619 rows=4025132 loops=1)
 Total runtime: 47292.620 ms
(20 rows)

Time: 47295.070 ms
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=2048694.40..2050306.33 rows=644775 width=135) (actual time=44844.753..45747.858 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=1943762.31..1986478.65 rows=644775 width=135) (actual time=33100.316..39994.990 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=1740265.84..1768474.74 rows=644775 width=49) (actual time=21880.864..25720.848 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=1738809.78..1745257.53 rows=644775 width=24) (actual time=21785.589..23042.942 rows=800907 loops=1)
                     ->  Merge Join  (cost=0.00..1729138.16 rows=644775 width=24) (actual time=0.160..19950.697 rows=1091759 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..165488.65 rows=213952 width=20) (actual time=0.071..339.818 rows=239350 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.050..9950.927 rows=7226464 loops=1)
                                 Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=95.230..95.230 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..46.394 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11215.584..11215.584 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.039..5269.852 rows=4025132 loops=1)
 Total runtime: 46628.910 ms
(20 rows)

Time: 46630.664 ms
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2018607.09..2018608.34 rows=500 width=135) (actual time=41299.847..41301.281 rows=500 loops=1)
   ->  Sort  (cost=2018607.09..2020219.03 rows=644775 width=135) (actual time=41299.844..41300.324 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=1943762.31..1986478.65 rows=644775 width=135) (actual time=33134.471..40031.437 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=1740265.84..1768474.74 rows=644775 width=49) (actual time=21941.684..25791.463 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=1738809.78..1745257.53 rows=644775 width=24) (actual time=21846.309..23103.873 rows=800907 loops=1)
                           ->  Merge Join  (cost=0.00..1729138.16 rows=644775 width=24) (actual time=0.164..19992.198 rows=1091759 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..165488.65 rows=213952 width=20) (actual time=0.070..338.242 rows=239350 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.055..9958.397 rows=7226464 loops=1)
                                       Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=95.329..95.329 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..46.454 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11188.900..11188.900 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.036..5234.863 rows=4025132 loops=1)
 Total runtime: 41304.952 ms
(21 rows)

Time: 41395.276 ms
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2018607.09..2018608.34 rows=500 width=135) (actual time=41301.747..41303.181 rows=500 loops=1)
   ->  Sort  (cost=2018607.09..2020219.03 rows=644775 width=135) (actual time=41301.743..41302.232 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=1943762.31..1986478.65 rows=644775 width=135) (actual time=33141.157..40031.604 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=1740265.84..1768474.74 rows=644775 width=49) (actual time=21931.718..25773.172 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=1738809.78..1745257.53 rows=644775 width=24) (actual time=21836.632..23091.856 rows=800907 loops=1)
                           ->  Merge Join  (cost=0.00..1729138.16 rows=644775 width=24) (actual time=0.155..19993.895 rows=1091759 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l1  (cost=0.00..165488.65 rows=213952 width=20) (actual time=0.067..338.137 rows=239350 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Index Scan using locationbin500__subjectobjectbin on locationbin500 l2  (cost=0.00..1439201.26 rows=7266776 width=20) (actual time=0.049..9953.467 rows=7226464 loops=1)
                                       Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=95.042..95.042 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..46.293 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11205.570..11205.570 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.038..5239.042 rows=4025132 loops=1)
 Total runtime: 41306.828 ms
(21 rows)

Time: 41396.639 ms
