Testing with size 1000
Timing is on.
ANALYZE
Time: 20988.755 ms
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=447753.21..447760.00 rows=302 width=52) (actual time=3864.791..3868.015 rows=949 loops=1)
   ->  Sort  (cost=447753.21..447753.96 rows=302 width=52) (actual time=3864.787..3865.861 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=421949.13..447740.77 rows=302 width=52) (actual time=3805.233..3862.121 rows=1114 loops=1)
               ->  Nested Loop  (cost=421949.13..446913.64 rows=307 width=42) (actual time=3805.162..3844.993 rows=1114 loops=1)
                     ->  Hash Join  (cost=421949.13..446814.80 rows=307 width=24) (actual time=3805.063..3831.290 rows=1114 loops=1)
                           Hash Cond: (a2_.id = l.lid2)
                           ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=186.676..209.456 rows=686 loops=1)
                                 Hash Cond: (indirect1.bioentities = a2_.id)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.242..14.274 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.159..0.402 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.077..5.427 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=186.381..186.381 rows=71604 loops=1)
                                       ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.017..94.536 rows=71604 loops=1)
                           ->  Hash  (cost=418515.85..418515.85 rows=51215 width=8) (actual time=3618.295..3618.295 rows=83765 loops=1)
                                 ->  Subquery Scan l  (cost=417491.55..418515.85 rows=51215 width=8) (actual time=3231.376..3511.848 rows=83765 loops=1)
                                       ->  HashAggregate  (cost=417491.55..418003.70 rows=51215 width=24) (actual time=3231.372..3345.610 rows=83765 loops=1)
                                             ->  Merge Join  (cost=0.00..416723.33 rows=51215 width=24) (actual time=79.807..2589.161 rows=428354 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=58.217..569.749 rows=199622 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..220531.62 rows=377721 width=20) (actual time=21.576..717.456 rows=467823 loops=1)
                                                         Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.31 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=1114)
                           Index Cond: (a1_.id = l.lid1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.010..0.011 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3869.411 ms
(32 rows)

Time: 3891.812 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=447753.21..447760.00 rows=302 width=52) (actual time=3379.396..3382.679 rows=949 loops=1)
   ->  Sort  (cost=447753.21..447753.96 rows=302 width=52) (actual time=3379.393..3380.465 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=421949.13..447740.77 rows=302 width=52) (actual time=3331.751..3376.820 rows=1114 loops=1)
               ->  Nested Loop  (cost=421949.13..446913.64 rows=307 width=42) (actual time=3331.733..3366.527 rows=1114 loops=1)
                     ->  Hash Join  (cost=421949.13..446814.80 rows=307 width=24) (actual time=3331.694..3356.814 rows=1114 loops=1)
                           Hash Cond: (a2_.id = l.lid2)
                           ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=181.276..203.243 rows=686 loops=1)
                                 Hash Cond: (indirect1.bioentities = a2_.id)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.108..13.762 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.077..0.214 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..5.098 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=181.119..181.119 rows=71604 loops=1)
                                       ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.003..90.037 rows=71604 loops=1)
                           ->  Hash  (cost=418515.85..418515.85 rows=51215 width=8) (actual time=3150.324..3150.324 rows=83765 loops=1)
                                 ->  Subquery Scan l  (cost=417491.55..418515.85 rows=51215 width=8) (actual time=2763.607..3044.166 rows=83765 loops=1)
                                       ->  HashAggregate  (cost=417491.55..418003.70 rows=51215 width=24) (actual time=2763.602..2878.375 rows=83765 loops=1)
                                             ->  Merge Join  (cost=0.00..416723.33 rows=51215 width=24) (actual time=0.066..2133.937 rows=428354 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=0.034..252.426 rows=199622 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..220531.62 rows=377721 width=20) (actual time=0.020..590.944 rows=467823 loops=1)
                                                         Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                     ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.31 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                           Index Cond: (a1_.id = l.lid1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3384.008 ms
(32 rows)

Time: 3389.711 ms
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=447753.21..447760.00 rows=302 width=52) (actual time=3365.790..3368.441 rows=500 loops=1)
   ->  Unique  (cost=447753.21..447760.00 rows=302 width=52) (actual time=3365.786..3367.484 rows=500 loops=1)
         ->  Sort  (cost=447753.21..447753.96 rows=302 width=52) (actual time=3365.782..3366.346 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=421949.13..447740.77 rows=302 width=52) (actual time=3318.172..3363.234 rows=1114 loops=1)
                     ->  Nested Loop  (cost=421949.13..446913.64 rows=307 width=42) (actual time=3318.153..3352.929 rows=1114 loops=1)
                           ->  Hash Join  (cost=421949.13..446814.80 rows=307 width=24) (actual time=3318.118..3343.197 rows=1114 loops=1)
                                 Hash Cond: (a2_.id = l.lid2)
                                 ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=182.135..204.036 rows=686 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.110..13.749 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.079..0.217 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.026..5.064 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=181.976..181.976 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.004..90.455 rows=71604 loops=1)
                                 ->  Hash  (cost=418515.85..418515.85 rows=51215 width=8) (actual time=3135.892..3135.892 rows=83765 loops=1)
                                       ->  Subquery Scan l  (cost=417491.55..418515.85 rows=51215 width=8) (actual time=2750.490..3029.870 rows=83765 loops=1)
                                             ->  HashAggregate  (cost=417491.55..418003.70 rows=51215 width=24) (actual time=2750.486..2864.947 rows=83765 loops=1)
                                                   ->  Merge Join  (cost=0.00..416723.33 rows=51215 width=24) (actual time=0.066..2130.725 rows=428354 loops=1)
                                                         Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=0.034..253.250 rows=199622 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..220531.62 rows=377721 width=20) (actual time=0.019..590.500 rows=467823 loops=1)
                                                               Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.31 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l.lid1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3369.403 ms
(33 rows)

Time: 3375.186 ms
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=447753.21..447760.00 rows=302 width=52) (actual time=3369.342..3372.011 rows=500 loops=1)
   ->  Unique  (cost=447753.21..447760.00 rows=302 width=52) (actual time=3369.338..3371.051 rows=500 loops=1)
         ->  Sort  (cost=447753.21..447753.96 rows=302 width=52) (actual time=3369.335..3369.900 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=421949.13..447740.77 rows=302 width=52) (actual time=3320.872..3366.764 rows=1114 loops=1)
                     ->  Nested Loop  (cost=421949.13..446913.64 rows=307 width=42) (actual time=3320.854..3356.355 rows=1114 loops=1)
                           ->  Hash Join  (cost=421949.13..446814.80 rows=307 width=24) (actual time=3320.821..3345.997 rows=1114 loops=1)
                                 Hash Cond: (a2_.id = l.lid2)
                                 ->  Hash Join  (cost=2793.09..24907.94 rows=429 width=24) (actual time=181.438..203.495 rows=686 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.107..13.861 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.077..0.214 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.024..5.163 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=1898.04..1898.04 rows=71604 width=20) (actual time=181.281..181.281 rows=71604 loops=1)
                                             ->  Seq Scan on mrna a2_  (cost=0.00..1898.04 rows=71604 width=20) (actual time=0.004..89.970 rows=71604 loops=1)
                                 ->  Hash  (cost=418515.85..418515.85 rows=51215 width=8) (actual time=3139.291..3139.291 rows=83765 loops=1)
                                       ->  Subquery Scan l  (cost=417491.55..418515.85 rows=51215 width=8) (actual time=2755.821..3033.383 rows=83765 loops=1)
                                             ->  HashAggregate  (cost=417491.55..418003.70 rows=51215 width=24) (actual time=2755.817..2869.475 rows=83765 loops=1)
                                                   ->  Merge Join  (cost=0.00..416723.33 rows=51215 width=24) (actual time=0.067..2130.054 rows=428354 loops=1)
                                                         Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=0.035..253.426 rows=199622 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..220531.62 rows=377721 width=20) (actual time=0.019..593.338 rows=467823 loops=1)
                                                               Index Cond: (l2.subjecttype = 'org.intermine.model.bio.MRNA'::text)
                           ->  Index Scan using gene_pkey on gene a1_  (cost=0.00..0.31 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=1114)
                                 Index Cond: (a1_.id = l.lid1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 3372.934 ms
(33 rows)

Time: 3378.634 ms
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=258006.70..258007.88 rows=43 width=66) (actual time=1806.576..1826.959 rows=6492 loops=1)
   ->  Sort  (cost=258006.70..258006.81 rows=43 width=66) (actual time=1806.573..1813.003 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=257549.27..258005.54 rows=43 width=66) (actual time=1512.267..1789.249 rows=6492 loops=1)
               ->  Nested Loop  (cost=257549.27..257907.96 rows=43 width=55) (actual time=1512.205..1732.865 rows=6492 loops=1)
                     ->  Nested Loop  (cost=257549.27..257853.56 rows=43 width=45) (actual time=1512.178..1667.765 rows=6492 loops=1)
                           ->  Nested Loop  (cost=257549.27..257840.77 rows=44 width=31) (actual time=1512.161..1610.572 rows=6499 loops=1)
                                 ->  Merge Join  (cost=257549.27..257774.27 rows=44 width=12) (actual time=1512.046..1542.217 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.279..22.738 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.102..13.446 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.198 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.021..4.912 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=233105.00..233123.52 rows=7406 width=8) (actual time=1485.373..1496.466 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=232480.88..232629.00 rows=7406 width=8) (actual time=1280.693..1416.809 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=232480.88..232554.94 rows=7406 width=24) (actual time=1280.689..1336.327 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..232369.79 rows=7406 width=24) (actual time=42.738..1194.429 rows=46481 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=26.729..124.713 rows=25161 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=11.323..577.649 rows=352825 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.50 rows=1 width=23) (actual time=0.005..0.006 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.005..0.006 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.26 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 1833.417 ms
(39 rows)

Time: 1839.485 ms
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=258006.70..258007.88 rows=43 width=66) (actual time=1548.742..1569.211 rows=6492 loops=1)
   ->  Sort  (cost=258006.70..258006.81 rows=43 width=66) (actual time=1548.738..1555.198 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=257549.27..258005.54 rows=43 width=66) (actual time=1271.867..1531.517 rows=6492 loops=1)
               ->  Nested Loop  (cost=257549.27..257907.96 rows=43 width=55) (actual time=1271.852..1476.538 rows=6492 loops=1)
                     ->  Nested Loop  (cost=257549.27..257853.56 rows=43 width=45) (actual time=1271.835..1416.838 rows=6492 loops=1)
                           ->  Nested Loop  (cost=257549.27..257840.77 rows=44 width=31) (actual time=1271.819..1361.760 rows=6499 loops=1)
                                 ->  Merge Join  (cost=257549.27..257774.27 rows=44 width=12) (actual time=1271.778..1301.635 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.287..22.759 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.100..13.418 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.073..0.195 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.021..4.891 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=233105.00..233123.52 rows=7406 width=8) (actual time=1245.089..1255.966 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=232480.88..232629.00 rows=7406 width=8) (actual time=1044.017..1180.064 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=232480.88..232554.94 rows=7406 width=24) (actual time=1044.013..1099.790 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..232369.79 rows=7406 width=24) (actual time=0.083..964.109 rows=46481 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=0.020..32.128 rows=25161 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=0.010..443.470 rows=352825 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.50 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.26 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 1575.692 ms
(39 rows)

Time: 1580.305 ms
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=258006.70..258007.88 rows=43 width=66) (actual time=1542.552..1545.066 rows=500 loops=1)
   ->  Unique  (cost=258006.70..258007.88 rows=43 width=66) (actual time=1542.549..1544.098 rows=500 loops=1)
         ->  Sort  (cost=258006.70..258006.81 rows=43 width=66) (actual time=1542.546..1543.037 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=257549.27..258005.54 rows=43 width=66) (actual time=1265.585..1525.339 rows=6492 loops=1)
                     ->  Nested Loop  (cost=257549.27..257907.96 rows=43 width=55) (actual time=1265.570..1470.222 rows=6492 loops=1)
                           ->  Nested Loop  (cost=257549.27..257853.56 rows=43 width=45) (actual time=1265.553..1410.219 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=257549.27..257840.77 rows=44 width=31) (actual time=1265.537..1355.170 rows=6499 loops=1)
                                       ->  Merge Join  (cost=257549.27..257774.27 rows=44 width=12) (actual time=1265.502..1295.173 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.340..22.739 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.102..13.528 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.196 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.022..4.947 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=233105.00..233123.52 rows=7406 width=8) (actual time=1238.770..1249.650 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=232480.88..232629.00 rows=7406 width=8) (actual time=1038.681..1174.296 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=232480.88..232554.94 rows=7406 width=24) (actual time=1038.678..1094.343 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..232369.79 rows=7406 width=24) (actual time=0.084..961.010 rows=46481 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=0.020..31.929 rows=25161 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=0.010..441.510 rows=352825 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.50 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.26 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 1545.809 ms
(40 rows)

Time: 1550.464 ms
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=258006.70..258007.88 rows=43 width=66) (actual time=1544.548..1547.066 rows=500 loops=1)
   ->  Unique  (cost=258006.70..258007.88 rows=43 width=66) (actual time=1544.544..1546.116 rows=500 loops=1)
         ->  Sort  (cost=258006.70..258006.81 rows=43 width=66) (actual time=1544.541..1545.031 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=257549.27..258005.54 rows=43 width=66) (actual time=1267.014..1527.239 rows=6492 loops=1)
                     ->  Nested Loop  (cost=257549.27..257907.96 rows=43 width=55) (actual time=1266.998..1472.033 rows=6492 loops=1)
                           ->  Nested Loop  (cost=257549.27..257853.56 rows=43 width=45) (actual time=1266.982..1411.971 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=257549.27..257840.77 rows=44 width=31) (actual time=1266.966..1356.855 rows=6499 loops=1)
                                       ->  Merge Join  (cost=257549.27..257774.27 rows=44 width=12) (actual time=1266.927..1296.698 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.285..22.745 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.100..13.418 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.073..0.200 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.022..4.902 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=233105.00..233123.52 rows=7406 width=8) (actual time=1240.231..1251.182 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=232480.88..232629.00 rows=7406 width=8) (actual time=1040.517..1176.437 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=232480.88..232554.94 rows=7406 width=24) (actual time=1040.513..1096.169 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..232369.79 rows=7406 width=24) (actual time=0.084..962.697 rows=46481 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=0.020..32.030 rows=25161 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=0.010..442.040 rows=352825 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.50 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..2.26 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 1547.776 ms
(40 rows)

Time: 1552.540 ms
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=984486.73..984530.12 rows=3471 width=46) (actual time=30614.884..30638.124 rows=7408 loops=1)
   ->  Sort  (cost=984486.73..984495.41 rows=3471 width=46) (actual time=30614.880..30622.435 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Nested Loop  (cost=968124.75..984282.62 rows=3471 width=46) (actual time=26583.768..30596.327 rows=7408 loops=1)
               ->  Nested Loop  (cost=968124.75..983155.46 rows=3471 width=32) (actual time=26583.734..30516.931 rows=7408 loops=1)
                     ->  Hash Join  (cost=968124.75..981931.76 rows=3471 width=32) (actual time=26583.433..29785.571 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=941812.96..947611.81 rows=579885 width=24) (actual time=26255.391..27882.859 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=597090.47..933114.68 rows=579885 width=24) (actual time=11794.360..22259.518 rows=2584266 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..216758.40 rows=367819 width=20) (actual time=1.356..588.064 rows=370785 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=11792.979..14870.409 rows=3137088 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 274404kB
                                             ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=60.042..6581.945 rows=2254076 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=327.959..327.959 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=276.399..318.470 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.176..21.638 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.086..0.217 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.084..8.368 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=276.061..276.061 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.014..136.228 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.34 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 30685.281 ms
(35 rows)

Time: 30695.592 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=984486.73..984530.12 rows=3471 width=46) (actual time=27729.503..27752.407 rows=7408 loops=1)
   ->  Sort  (cost=984486.73..984495.41 rows=3471 width=46) (actual time=27729.498..27736.916 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Nested Loop  (cost=968124.75..984282.62 rows=3471 width=46) (actual time=23727.242..27711.711 rows=7408 loops=1)
               ->  Nested Loop  (cost=968124.75..983155.46 rows=3471 width=32) (actual time=23727.210..27631.636 rows=7408 loops=1)
                     ->  Hash Join  (cost=968124.75..981931.76 rows=3471 width=32) (actual time=23726.950..26896.939 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=941812.96..947611.81 rows=579885 width=24) (actual time=23408.441..25078.144 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=597090.47..933114.68 rows=579885 width=24) (actual time=9098.170..19491.688 rows=2584266 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..216758.40 rows=367819 width=20) (actual time=0.065..533.568 rows=370785 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=9098.080..12167.678 rows=3137088 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 274404kB
                                             ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=0.062..3913.383 rows=2254076 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=318.439..318.439 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=269.347..309.202 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.207..21.430 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.142..0.348 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.060..7.982 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=269.006..269.006 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..132.730 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.34 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 27800.939 ms
(35 rows)

Time: 27810.199 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=984486.73..984492.98 rows=500 width=46) (actual time=27698.942..27701.406 rows=500 loops=1)
   ->  Unique  (cost=984486.73..984530.12 rows=3471 width=46) (actual time=27698.938..27700.464 rows=500 loops=1)
         ->  Sort  (cost=984486.73..984495.41 rows=3471 width=46) (actual time=27698.934..27699.430 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Nested Loop  (cost=968124.75..984282.62 rows=3471 width=46) (actual time=23704.764..27681.205 rows=7408 loops=1)
                     ->  Nested Loop  (cost=968124.75..983155.46 rows=3471 width=32) (actual time=23704.730..27602.179 rows=7408 loops=1)
                           ->  Hash Join  (cost=968124.75..981931.76 rows=3471 width=32) (actual time=23704.476..26871.488 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=941812.96..947611.81 rows=579885 width=24) (actual time=23385.935..25052.455 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=597090.47..933114.68 rows=579885 width=24) (actual time=9086.253..19460.044 rows=2584266 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..216758.40 rows=367819 width=20) (actual time=0.066..527.214 rows=370785 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=9086.163..12152.562 rows=3137088 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 274404kB
                                                   ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=0.062..3903.263 rows=2254076 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=318.465..318.465 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=269.119..309.188 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.200..21.432 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.134..0.346 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.061..7.989 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=268.787..268.787 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.011..132.355 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.34 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 27743.461 ms
(36 rows)

Time: 27752.711 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=984486.73..984492.98 rows=500 width=46) (actual time=27631.296..27633.783 rows=500 loops=1)
   ->  Unique  (cost=984486.73..984530.12 rows=3471 width=46) (actual time=27631.293..27632.831 rows=500 loops=1)
         ->  Sort  (cost=984486.73..984495.41 rows=3471 width=46) (actual time=27631.288..27631.782 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Nested Loop  (cost=968124.75..984282.62 rows=3471 width=46) (actual time=23639.209..27613.483 rows=7408 loops=1)
                     ->  Nested Loop  (cost=968124.75..983155.46 rows=3471 width=32) (actual time=23639.173..27534.327 rows=7408 loops=1)
                           ->  Hash Join  (cost=968124.75..981931.76 rows=3471 width=32) (actual time=23638.916..26803.477 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=941812.96..947611.81 rows=579885 width=24) (actual time=23320.751..24990.771 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=597090.47..933114.68 rows=579885 width=24) (actual time=9068.380..19452.457 rows=2584266 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..216758.40 rows=367819 width=20) (actual time=0.061..529.369 rows=370785 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=9068.294..12135.596 rows=3137088 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 274404kB
                                                   ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=0.062..3888.871 rows=2254076 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=318.088..318.088 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=268.949..308.935 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.199..21.315 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.135..0.336 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.060..7.911 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=268.618..268.618 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..132.303 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.34 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=7408)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 27676.171 ms
(36 rows)

Time: 27685.442 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=408801.26..408805.06 rows=304 width=37) (actual time=4442.103..4443.134 rows=341 loops=1)
   ->  Sort  (cost=408801.26..408802.02 rows=304 width=37) (actual time=4442.101..4442.426 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=407792.53..408788.73 rows=304 width=37) (actual time=4412.158..4441.468 rows=341 loops=1)
               ->  Nested Loop  (cost=407792.53..408557.46 rows=304 width=26) (actual time=4412.097..4438.483 rows=341 loops=1)
                     ->  Nested Loop  (cost=407792.53..408458.97 rows=304 width=12) (actual time=4412.082..4435.359 rows=341 loops=1)
                           ->  Merge Join  (cost=407792.53..408237.44 rows=304 width=12) (actual time=4411.979..4419.856 rows=2193 loops=1)
                                 Merge Cond: (indirect1.bioentities = l.lid2)
                                 ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.713..3.266 rows=546 loops=1)
                                       Sort Key: indirect1.bioentities
                                       Sort Method:  quicksort  Memory: 50kB
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.180..2.076 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.122..0.326 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..0.682 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Sort  (cost=383348.26..383475.43 rows=50869 width=8) (actual time=4294.456..4354.864 rows=55850 loops=1)
                                       Sort Key: l.lid2
                                       Sort Method:  quicksort  Memory: 13659kB
                                       ->  Subquery Scan l  (cost=378354.32..379371.70 rows=50869 width=8) (actual time=3500.968..4023.345 rows=160316 loops=1)
                                             ->  HashAggregate  (cost=378354.32..378863.01 rows=50869 width=24) (actual time=3500.965..3712.615 rows=160316 loops=1)
                                                   ->  Nested Loop  (cost=0.00..377591.29 rows=50869 width=24) (actual time=0.136..3052.934 rows=276324 loops=1)
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=0.085..34.913 rows=25161 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..10.75 rows=4 width=20) (actual time=0.064..0.091 rows=13 loops=25161)
                                                               Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.72 rows=1 width=8) (actual time=0.005..0.005 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l.lid1)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.75 rows=1 width=19) (actual time=0.003..0.005 rows=1 loops=341)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 4445.811 ms
(36 rows)

Time: 4451.806 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=408801.26..408805.06 rows=304 width=37) (actual time=2793.689..2794.722 rows=341 loops=1)
   ->  Sort  (cost=408801.26..408802.02 rows=304 width=37) (actual time=2793.686..2794.014 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=407792.53..408788.73 rows=304 width=37) (actual time=2763.762..2793.048 rows=341 loops=1)
               ->  Nested Loop  (cost=407792.53..408557.46 rows=304 width=26) (actual time=2763.746..2790.121 rows=341 loops=1)
                     ->  Nested Loop  (cost=407792.53..408458.97 rows=304 width=12) (actual time=2763.731..2786.996 rows=341 loops=1)
                           ->  Merge Join  (cost=407792.53..408237.44 rows=304 width=12) (actual time=2763.630..2771.529 rows=2193 loops=1)
                                 Merge Cond: (indirect1.bioentities = l.lid2)
                                 ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.546..3.094 rows=546 loops=1)
                                       Sort Key: indirect1.bioentities
                                       Sort Method:  quicksort  Memory: 50kB
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.102..1.914 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.077..0.208 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.019..0.640 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Sort  (cost=383348.26..383475.43 rows=50869 width=8) (actual time=2646.175..2706.663 rows=55850 loops=1)
                                       Sort Key: l.lid2
                                       Sort Method:  quicksort  Memory: 13659kB
                                       ->  Subquery Scan l  (cost=378354.32..379371.70 rows=50869 width=8) (actual time=1850.962..2375.184 rows=160316 loops=1)
                                             ->  HashAggregate  (cost=378354.32..378863.01 rows=50869 width=24) (actual time=1850.959..2063.379 rows=160316 loops=1)
                                                   ->  Nested Loop  (cost=0.00..377591.29 rows=50869 width=24) (actual time=0.065..1409.750 rows=276324 loops=1)
                                                         Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=0.017..32.711 rows=25161 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                         ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..10.75 rows=4 width=20) (actual time=0.011..0.026 rows=13 loops=25161)
                                                               Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.72 rows=1 width=8) (actual time=0.004..0.005 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l.lid1)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.75 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 2797.442 ms
(36 rows)

Time: 2803.417 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=408801.26..408805.06 rows=304 width=37) (actual time=2795.062..2796.741 rows=341 loops=1)
   ->  Unique  (cost=408801.26..408805.06 rows=304 width=37) (actual time=2795.060..2796.084 rows=341 loops=1)
         ->  Sort  (cost=408801.26..408802.02 rows=304 width=37) (actual time=2795.057..2795.385 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=407792.53..408788.73 rows=304 width=37) (actual time=2765.124..2794.396 rows=341 loops=1)
                     ->  Nested Loop  (cost=407792.53..408557.46 rows=304 width=26) (actual time=2765.107..2791.477 rows=341 loops=1)
                           ->  Nested Loop  (cost=407792.53..408458.97 rows=304 width=12) (actual time=2765.092..2788.360 rows=341 loops=1)
                                 ->  Merge Join  (cost=407792.53..408237.44 rows=304 width=12) (actual time=2764.991..2772.847 rows=2193 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.567..3.124 rows=546 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 50kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.103..1.937 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.207 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.021..0.652 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=383348.26..383475.43 rows=50869 width=8) (actual time=2647.461..2708.054 rows=55850 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 13659kB
                                             ->  Subquery Scan l  (cost=378354.32..379371.70 rows=50869 width=8) (actual time=1854.613..2376.680 rows=160316 loops=1)
                                                   ->  HashAggregate  (cost=378354.32..378863.01 rows=50869 width=24) (actual time=1854.610..2066.176 rows=160316 loops=1)
                                                         ->  Nested Loop  (cost=0.00..377591.29 rows=50869 width=24) (actual time=0.039..1413.242 rows=276324 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=0.016..32.457 rows=25161 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..10.75 rows=4 width=20) (actual time=0.011..0.026 rows=13 loops=25161)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.72 rows=1 width=8) (actual time=0.005..0.005 rows=0 loops=2193)
                                       Index Cond: (a1_.id = l.lid1)
                                       Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                           ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                                 Index Cond: (a4_.id = a1_.geneid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.75 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 2799.472 ms
(37 rows)

Time: 2805.433 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=408801.26..408805.06 rows=304 width=37) (actual time=2803.906..2805.565 rows=341 loops=1)
   ->  Unique  (cost=408801.26..408805.06 rows=304 width=37) (actual time=2803.903..2804.911 rows=341 loops=1)
         ->  Sort  (cost=408801.26..408802.02 rows=304 width=37) (actual time=2803.900..2804.230 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=407792.53..408788.73 rows=304 width=37) (actual time=2773.950..2803.255 rows=341 loops=1)
                     ->  Nested Loop  (cost=407792.53..408557.46 rows=304 width=26) (actual time=2773.933..2800.357 rows=341 loops=1)
                           ->  Nested Loop  (cost=407792.53..408458.97 rows=304 width=12) (actual time=2773.918..2797.208 rows=341 loops=1)
                                 ->  Merge Join  (cost=407792.53..408237.44 rows=304 width=12) (actual time=2773.815..2781.677 rows=2193 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=2.591..3.139 rows=546 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 50kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.103..1.938 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.076..0.209 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.020..0.648 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=383348.26..383475.43 rows=50869 width=8) (actual time=2656.273..2716.760 rows=55850 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 13659kB
                                             ->  Subquery Scan l  (cost=378354.32..379371.70 rows=50869 width=8) (actual time=1861.544..2384.954 rows=160316 loops=1)
                                                   ->  HashAggregate  (cost=378354.32..378863.01 rows=50869 width=24) (actual time=1861.541..2073.020 rows=160316 loops=1)
                                                         ->  Nested Loop  (cost=0.00..377591.29 rows=50869 width=24) (actual time=0.040..1419.132 rows=276324 loops=1)
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..28166.22 rows=32266 width=20) (actual time=0.017..32.763 rows=25161 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..10.75 rows=4 width=20) (actual time=0.011..0.026 rows=13 loops=25161)
                                                                     Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.72 rows=1 width=8) (actual time=0.005..0.005 rows=0 loops=2193)
                                       Index Cond: (a1_.id = l.lid1)
                                       Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                           ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.004..0.005 rows=1 loops=341)
                                 Index Cond: (a4_.id = a1_.geneid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.75 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=341)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 2808.293 ms
(37 rows)

Time: 2814.285 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1576386.23..1576591.93 rows=7480 width=82) (actual time=71072.564..71203.163 rows=39884 loops=1)
   ->  Sort  (cost=1576386.23..1576404.93 rows=7480 width=82) (actual time=71072.559..71114.967 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=1533320.87..1575904.94 rows=7480 width=82) (actual time=52065.962..70939.379 rows=39884 loops=1)
               ->  Hash Join  (cost=1533320.87..1566442.69 rows=7480 width=72) (actual time=52065.914..70470.668 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=1531355.00..1564324.96 rows=7706 width=58) (actual time=51940.908..70187.283 rows=40032 loops=1)
                           ->  Hash Join  (cost=1531355.00..1562006.33 rows=7706 width=39) (actual time=51940.848..69696.640 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1489252.25..1502125.63 rows=1287338 width=24) (actual time=51295.809..58559.432 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=0.00..1469942.18 rows=1287338 width=24) (actual time=1.583..39760.820 rows=6059887 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=0.034..451.292 rows=317904 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=1.533..17581.680 rows=12391012 loops=1)
                                                   Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.324..643.324 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.250..571.235 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.195..156.853 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.136..0.213 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.050..58.704 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.916..124.916 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..62.162 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 71289.525 ms
(34 rows)

Time: 71320.960 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1576386.23..1576591.93 rows=7480 width=82) (actual time=67726.901..67857.446 rows=39884 loops=1)
   ->  Sort  (cost=1576386.23..1576404.93 rows=7480 width=82) (actual time=67726.896..67769.824 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=1533320.87..1575904.94 rows=7480 width=82) (actual time=50395.585..67589.656 rows=39884 loops=1)
               ->  Hash Join  (cost=1533320.87..1566442.69 rows=7480 width=72) (actual time=50395.538..67110.544 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=1531355.00..1564324.96 rows=7706 width=58) (actual time=50270.391..66840.788 rows=40032 loops=1)
                           ->  Hash Join  (cost=1531355.00..1562006.33 rows=7706 width=39) (actual time=50270.332..66339.645 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1489252.25..1502125.63 rows=1287338 width=24) (actual time=49625.301..56812.160 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=0.00..1469942.18 rows=1287338 width=24) (actual time=0.117..38313.097 rows=6059887 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=0.057..446.955 rows=317904 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.043..16235.507 rows=12391012 loops=1)
                                                   Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.551..643.551 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.324..572.554 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.276..157.004 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.212..0.327 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.055..58.915 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.097..125.097 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.037..62.645 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.008 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 67933.271 ms
(34 rows)

Time: 67965.769 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1576386.23..1576399.98 rows=500 width=82) (actual time=67892.583..67895.188 rows=500 loops=1)
   ->  Unique  (cost=1576386.23..1576591.93 rows=7480 width=82) (actual time=67892.580..67894.238 rows=500 loops=1)
         ->  Sort  (cost=1576386.23..1576404.93 rows=7480 width=82) (actual time=67892.575..67893.112 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=1533320.87..1575904.94 rows=7480 width=82) (actual time=50392.406..67754.715 rows=39884 loops=1)
                     ->  Hash Join  (cost=1533320.87..1566442.69 rows=7480 width=72) (actual time=50392.361..67267.329 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=1531355.00..1564324.96 rows=7706 width=58) (actual time=50266.752..66997.831 rows=40032 loops=1)
                                 ->  Hash Join  (cost=1531355.00..1562006.33 rows=7706 width=39) (actual time=50266.691..66491.381 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=1489252.25..1502125.63 rows=1287338 width=24) (actual time=49621.455..56890.227 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=0.00..1469942.18 rows=1287338 width=24) (actual time=0.119..38271.978 rows=6059887 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=0.055..453.091 rows=317904 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.047..16146.782 rows=12391012 loops=1)
                                                         Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.766..643.766 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.334..572.682 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.288..156.508 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.224..0.342 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.056..58.680 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.559..125.559 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.037..62.886 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.007..0.008 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 67933.411 ms
(35 rows)

Time: 67965.911 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1576386.23..1576399.98 rows=500 width=82) (actual time=67917.096..67919.690 rows=500 loops=1)
   ->  Unique  (cost=1576386.23..1576591.93 rows=7480 width=82) (actual time=67917.093..67918.752 rows=500 loops=1)
         ->  Sort  (cost=1576386.23..1576404.93 rows=7480 width=82) (actual time=67917.088..67917.633 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=1533320.87..1575904.94 rows=7480 width=82) (actual time=50437.011..67779.596 rows=39884 loops=1)
                     ->  Hash Join  (cost=1533320.87..1566442.69 rows=7480 width=72) (actual time=50436.966..67296.167 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=1531355.00..1564324.96 rows=7706 width=58) (actual time=50311.615..67026.120 rows=40032 loops=1)
                                 ->  Hash Join  (cost=1531355.00..1562006.33 rows=7706 width=39) (actual time=50311.556..66523.838 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=1489252.25..1502125.63 rows=1287338 width=24) (actual time=49664.168..56924.567 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=0.00..1469942.18 rows=1287338 width=24) (actual time=0.114..38331.037 rows=6059887 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..201396.13 rows=329268 width=20) (actual time=0.054..454.398 rows=317904 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.043..16209.794 rows=12391012 loops=1)
                                                         Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=645.914..645.914 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.324..574.808 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.278..156.106 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.212..0.337 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.058..58.501 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.301..125.301 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.037..62.867 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.007..0.008 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 67957.958 ms
(35 rows)

Time: 67990.305 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3323279.35..3323940.99 rows=52931 width=53) (actual time=355807.640..355863.624 rows=17651 loops=1)
   ->  Sort  (cost=3323279.35..3323411.68 rows=52931 width=53) (actual time=355807.636..355826.065 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=3107524.90..3319126.43 rows=52931 width=53) (actual time=252744.364..355737.714 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=3091656.94..3302199.85 rows=52931 width=39) (actual time=252166.941..354472.314 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=3049554.20..3137980.98 rows=8842678 width=24) (actual time=251523.478..297450.227 rows=29345747 loops=1)
                           ->  Merge Join  (cost=597090.47..2916914.03 rows=8842678 width=24) (actual time=9084.133..175717.034 rows=40639711 loops=1)
                                 Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.061..8128.844 rows=5614249 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=9084.046..58830.177 rows=51284366 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 274404kB
                                       ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=0.062..3929.896 rows=2254076 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.308..643.308 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.316..572.539 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.269..156.392 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.206..0.337 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.054..57.863 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=564.014..564.014 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=138.201..495.318 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=16.049..221.732 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=14.065..14.065 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.099..122.099 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.017..62.449 rows=48661 loops=1)
 Total runtime: 356367.076 ms
(38 rows)

Time: 356389.422 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3323279.35..3323940.99 rows=52931 width=53) (actual time=354947.225..355003.420 rows=17651 loops=1)
   ->  Sort  (cost=3323279.35..3323411.68 rows=52931 width=53) (actual time=354947.220..354965.841 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=3107524.90..3319126.43 rows=52931 width=53) (actual time=251672.543..354875.740 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=3091656.94..3302199.85 rows=52931 width=39) (actual time=251101.382..353613.499 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=3049554.20..3137980.98 rows=8842678 width=24) (actual time=250454.593..296276.705 rows=29345747 loops=1)
                           ->  Merge Join  (cost=597090.47..2916914.03 rows=8842678 width=24) (actual time=8848.490..175280.736 rows=40639711 loops=1)
                                 Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.058..8124.027 rows=5614249 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=8848.407..58549.023 rows=51284366 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 274404kB
                                       ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=0.062..3897.329 rows=2254076 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=646.641..646.641 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.332..575.894 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.288..156.739 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.225..0.344 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.053..58.261 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=557.887..557.887 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=138.831..490.833 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.946..216.978 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.965..13.965 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.829..122.829 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..62.879 rows=48661 loops=1)
 Total runtime: 355488.092 ms
(38 rows)

Time: 355508.524 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3322822.55..3322823.80 rows=500 width=53) (actual time=355747.930..355749.357 rows=500 loops=1)
   ->  Sort  (cost=3322822.55..3322954.88 rows=52931 width=53) (actual time=355747.926..355748.409 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=3319655.74..3320185.05 rows=52931 width=53) (actual time=355699.679..355721.947 rows=17651 loops=1)
               ->  Hash Join  (cost=3107524.90..3319126.43 rows=52931 width=53) (actual time=252156.832..355623.346 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=3091656.94..3302199.85 rows=52931 width=39) (actual time=251586.657..354382.383 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=3049554.20..3137980.98 rows=8842678 width=24) (actual time=250941.461..296835.855 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=597090.47..2916914.03 rows=8842678 width=24) (actual time=8810.698..175420.351 rows=40639711 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.057..8129.223 rows=5614249 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=8810.614..58515.499 rows=51284366 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 274404kB
                                             ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=0.062..3879.304 rows=2254076 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=645.050..645.050 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.314..573.841 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.267..157.174 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.205..0.319 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.053..58.807 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=556.872..556.872 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=138.555..489.101 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=16.171..216.273 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.997..13.997 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.328..122.328 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.017..62.615 rows=48661 loops=1)
 Total runtime: 356240.465 ms
(39 rows)

Time: 356261.014 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3322822.55..3322823.80 rows=500 width=53) (actual time=355295.583..355297.007 rows=500 loops=1)
   ->  Sort  (cost=3322822.55..3322954.88 rows=52931 width=53) (actual time=355295.579..355296.065 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=3319655.74..3320185.05 rows=52931 width=53) (actual time=355247.252..355269.473 rows=17651 loops=1)
               ->  Hash Join  (cost=3107524.90..3319126.43 rows=52931 width=53) (actual time=251868.526..355170.827 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=3091656.94..3302199.85 rows=52931 width=39) (actual time=251296.737..353930.177 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=3049554.20..3137980.98 rows=8842678 width=24) (actual time=250646.127..296565.572 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=597090.47..2916914.03 rows=8842678 width=24) (actual time=8872.061..175502.447 rows=40639711 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.059..8142.936 rows=5614249 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Sort  (cost=597090.47..602744.80 rows=2261730 width=20) (actual time=8871.977..58573.607 rows=51284366 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 274404kB
                                             ->  Index Scan using locationbin1000__subjecttypeid on locationbin1000 l1  (cost=0.00..358376.23 rows=2261730 width=20) (actual time=0.063..3930.408 rows=2254076 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=650.463..650.463 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.334..578.837 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.277..158.153 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.215..0.331 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.054..59.348 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.005 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=558.527..558.527 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=138.090..490.817 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=16.149..217.250 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.996..13.996 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.887..121.887 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..62.449 rows=48661 loops=1)
 Total runtime: 355764.522 ms
(39 rows)

Time: 355785.090 ms
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=364159.53..364169.65 rows=4049 width=4) (actual time=145.724..145.843 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=346040.31..363916.93 rows=4049 width=4) (actual time=142.275..145.537 rows=118 loops=1)
         ->  HashAggregate  (cost=346040.31..346080.80 rows=4049 width=24) (actual time=142.218..142.399 rows=120 loops=1)
               ->  Nested Loop  (cost=16.11..345979.58 rows=4049 width=24) (actual time=103.520..140.952 rows=869 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin1000__subjectid on locationbin1000 l1  (cost=0.00..155.43 rows=219 width=20) (actual time=41.974..41.985 rows=5 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin1000 l2  (cost=16.11..1557.37 rows=1087 width=20) (actual time=10.326..18.335 rows=1096 loops=5)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin1000__bin  (cost=0.00..15.84 rows=1087 width=0) (actual time=9.187..9.187 rows=1096 loops=5)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.38 rows=1 width=4) (actual time=0.021..0.022 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 146.062 ms
(16 rows)

Time: 148.137 ms
                                                                                 QUERY PLAN                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=364159.53..364169.65 rows=4049 width=4) (actual time=16.921..17.034 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=346040.31..363916.93 rows=4049 width=4) (actual time=15.383..16.749 rows=118 loops=1)
         ->  HashAggregate  (cost=346040.31..346080.80 rows=4049 width=24) (actual time=15.368..15.518 rows=120 loops=1)
               ->  Nested Loop  (cost=16.11..345979.58 rows=4049 width=24) (actual time=0.200..14.152 rows=869 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin1000__subjectid on locationbin1000 l1  (cost=0.00..155.43 rows=219 width=20) (actual time=0.013..0.021 rows=5 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin1000 l2  (cost=16.11..1557.37 rows=1087 width=20) (actual time=0.119..1.335 rows=1096 loops=5)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin1000__bin  (cost=0.00..15.84 rows=1087 width=0) (actual time=0.107..0.107 rows=1096 loops=5)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.38 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 17.242 ms
(16 rows)

Time: 18.578 ms
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=364118.68..364119.93 rows=500 width=4) (actual time=16.782..17.117 rows=118 loops=1)
   ->  Sort  (cost=364118.68..364128.80 rows=4049 width=4) (actual time=16.779..16.892 rows=118 loops=1)
         Sort Key: a1_.id
         Sort Method:  quicksort  Memory: 30kB
         ->  Nested Loop  (cost=346040.31..363916.93 rows=4049 width=4) (actual time=15.228..16.607 rows=118 loops=1)
               ->  HashAggregate  (cost=346040.31..346080.80 rows=4049 width=24) (actual time=15.214..15.362 rows=120 loops=1)
                     ->  Nested Loop  (cost=16.11..345979.58 rows=4049 width=24) (actual time=0.197..14.006 rows=869 loops=1)
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                           ->  Index Scan using locationbin1000__subjectid on locationbin1000 l1  (cost=0.00..155.43 rows=219 width=20) (actual time=0.014..0.021 rows=5 loops=1)
                                 Index Cond: (232042548 = subjectid)
                           ->  Bitmap Heap Scan on locationbin1000 l2  (cost=16.11..1557.37 rows=1087 width=20) (actual time=0.119..1.352 rows=1096 loops=5)
                                 Recheck Cond: (l2.bin = l1.bin)
                                 ->  Bitmap Index Scan on locationbin1000__bin  (cost=0.00..15.84 rows=1087 width=0) (actual time=0.108..0.108 rows=1096 loops=5)
                                       Index Cond: (l2.bin = l1.bin)
               ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.38 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
                     Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 17.345 ms
(17 rows)

Time: 18.676 ms
                                                                                    QUERY PLAN                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=364118.68..364119.93 rows=500 width=4) (actual time=16.813..17.159 rows=118 loops=1)
   ->  Sort  (cost=364118.68..364128.80 rows=4049 width=4) (actual time=16.810..16.925 rows=118 loops=1)
         Sort Key: a1_.id
         Sort Method:  quicksort  Memory: 30kB
         ->  Nested Loop  (cost=346040.31..363916.93 rows=4049 width=4) (actual time=15.263..16.631 rows=118 loops=1)
               ->  HashAggregate  (cost=346040.31..346080.80 rows=4049 width=24) (actual time=15.249..15.392 rows=120 loops=1)
                     ->  Nested Loop  (cost=16.11..345979.58 rows=4049 width=24) (actual time=0.195..14.026 rows=869 loops=1)
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                           ->  Index Scan using locationbin1000__subjectid on locationbin1000 l1  (cost=0.00..155.43 rows=219 width=20) (actual time=0.013..0.020 rows=5 loops=1)
                                 Index Cond: (232042548 = subjectid)
                           ->  Bitmap Heap Scan on locationbin1000 l2  (cost=16.11..1557.37 rows=1087 width=20) (actual time=0.119..1.355 rows=1096 loops=5)
                                 Recheck Cond: (l2.bin = l1.bin)
                                 ->  Bitmap Index Scan on locationbin1000__bin  (cost=0.00..15.84 rows=1087 width=0) (actual time=0.107..0.107 rows=1096 loops=5)
                                       Index Cond: (l2.bin = l1.bin)
               ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..4.38 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
                     Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 17.364 ms
(17 rows)

Time: 18.711 ms
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=485159.80..485295.27 rows=54187 width=46) (actual time=5508.339..5645.135 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=477647.95..480899.17 rows=54187 width=46) (actual time=4136.876..5074.189 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=473320.00..475487.48 rows=54187 width=22) (actual time=3876.284..4435.689 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=471354.13..471896.00 rows=54187 width=24) (actual time=3753.957..3927.155 rows=129835 loops=1)
                     ->  Merge Join  (cost=321181.59..470541.32 rows=54187 width=24) (actual time=1657.327..3277.788 rows=319319 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=0.077..131.592 rows=97749 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=321181.59..322180.68 rows=399637 width=20) (actual time=1657.226..2125.635 rows=466605 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 43939kB
                                 ->  Bitmap Heap Scan on locationbin1000 l2  (cost=9117.70..283998.70 rows=399637 width=20) (actual time=249.645..769.673 rows=405128 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin1000__subjecttypeid  (cost=0.00..9017.79 rows=399637 width=0) (actual time=248.514..248.514 rows=405128 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.261..122.261 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.528 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=260.542..260.542 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.033..131.245 rows=103331 loops=1)
 Total runtime: 5774.558 ms
(25 rows)

Time: 5803.670 ms
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=485159.80..485295.27 rows=54187 width=46) (actual time=5287.226..5424.548 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=477647.95..480899.17 rows=54187 width=46) (actual time=3915.319..4853.679 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=473320.00..475487.48 rows=54187 width=22) (actual time=3661.020..4222.175 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=471354.13..471896.00 rows=54187 width=24) (actual time=3540.332..3714.583 rows=129835 loops=1)
                     ->  Merge Join  (cost=321181.59..470541.32 rows=54187 width=24) (actual time=1457.642..3068.671 rows=319319 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=0.037..125.406 rows=97749 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=321181.59..322180.68 rows=399637 width=20) (actual time=1457.580..1928.189 rows=466605 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 43939kB
                                 ->  Bitmap Heap Scan on locationbin1000 l2  (cost=9117.70..283998.70 rows=399637 width=20) (actual time=78.459..575.951 rows=405128 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin1000__subjecttypeid  (cost=0.00..9017.79 rows=399637 width=0) (actual time=77.355..77.355 rows=405128 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=120.620..120.620 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..61.740 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=254.247..254.247 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.009..127.252 rows=103331 loops=1)
 Total runtime: 5554.053 ms
(25 rows)

Time: 5556.225 ms
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=483599.25..483600.50 rows=500 width=46) (actual time=5028.529..5029.969 rows=500 loops=1)
   ->  Sort  (cost=483599.25..483734.72 rows=54187 width=46) (actual time=5028.525..5029.012 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=477647.95..480899.17 rows=54187 width=46) (actual time=3913.075..4845.442 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=473320.00..475487.48 rows=54187 width=22) (actual time=3658.587..4216.500 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=471354.13..471896.00 rows=54187 width=24) (actual time=3537.476..3710.658 rows=129835 loops=1)
                           ->  Merge Join  (cost=321181.59..470541.32 rows=54187 width=24) (actual time=1462.790..3066.187 rows=319319 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=0.037..125.336 rows=97749 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=321181.59..322180.68 rows=399637 width=20) (actual time=1462.729..1928.144 rows=466605 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 43939kB
                                       ->  Bitmap Heap Scan on locationbin1000 l2  (cost=9117.70..283998.70 rows=399637 width=20) (actual time=78.418..575.815 rows=405128 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin1000__subjecttypeid  (cost=0.00..9017.79 rows=399637 width=0) (actual time=77.328..77.328 rows=405128 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.046..121.046 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.005..61.838 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=254.438..254.438 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.010..128.032 rows=103331 loops=1)
 Total runtime: 5036.927 ms
(26 rows)

Time: 5038.877 ms
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=483599.25..483600.50 rows=500 width=46) (actual time=5031.446..5032.867 rows=500 loops=1)
   ->  Sort  (cost=483599.25..483734.72 rows=54187 width=46) (actual time=5031.443..5031.926 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=477647.95..480899.17 rows=54187 width=46) (actual time=3916.251..4848.023 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=473320.00..475487.48 rows=54187 width=22) (actual time=3661.511..4218.977 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=471354.13..471896.00 rows=54187 width=24) (actual time=3540.965..3713.887 rows=129835 loops=1)
                           ->  Merge Join  (cost=321181.59..470541.32 rows=54187 width=24) (actual time=1465.225..3070.558 rows=319319 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..137414.28 rows=194519 width=20) (actual time=0.037..125.376 rows=97749 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=321181.59..322180.68 rows=399637 width=20) (actual time=1465.162..1931.225 rows=466605 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 43939kB
                                       ->  Bitmap Heap Scan on locationbin1000 l2  (cost=9117.70..283998.70 rows=399637 width=20) (actual time=78.360..578.124 rows=405128 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin1000__subjecttypeid  (cost=0.00..9017.79 rows=399637 width=0) (actual time=77.258..77.258 rows=405128 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=120.479..120.479 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.004..61.471 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=254.691..254.691 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.010..128.378 rows=103331 loops=1)
 Total runtime: 5039.823 ms
(26 rows)

Time: 5041.756 ms
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1022322.67..1023750.36 rows=571074 width=135) (actual time=39594.053..40453.163 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=929884.87..967718.52 rows=571074 width=135) (actual time=28770.575..35262.616 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=726388.40..751372.89 rows=571074 width=49) (actual time=17535.148..21085.925 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=724932.34..730643.08 rows=571074 width=24) (actual time=17442.046..18605.197 rows=800907 loops=1)
                     ->  Merge Join  (cost=0.00..716366.23 rows=571074 width=24) (actual time=25.508..15827.531 rows=946639 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..109359.66 rows=146066 width=20) (actual time=25.437..357.594 rows=137754 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.049..7726.355 rows=5672228 loops=1)
                                 Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=93.049..93.049 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..45.301 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11233.884..11233.884 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.039..5180.104 rows=4025132 loops=1)
 Total runtime: 41316.066 ms
(20 rows)

Time: 41318.404 ms
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1022322.67..1023750.36 rows=571074 width=135) (actual time=39651.579..40509.915 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=929884.87..967718.52 rows=571074 width=135) (actual time=28728.828..35255.123 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=726388.40..751372.89 rows=571074 width=49) (actual time=17417.818..20992.603 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=724932.34..730643.08 rows=571074 width=24) (actual time=17324.598..18500.843 rows=800907 loops=1)
                     ->  Merge Join  (cost=0.00..716366.23 rows=571074 width=24) (actual time=0.159..15751.443 rows=946639 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..109359.66 rows=146066 width=20) (actual time=0.084..200.914 rows=137754 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.056..7833.812 rows=5672228 loops=1)
                                 Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=93.169..93.169 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..45.657 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11309.484..11309.484 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.042..5201.227 rows=4025132 loops=1)
 Total runtime: 41373.705 ms
(20 rows)

Time: 41375.390 ms
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=996174.52..996175.77 rows=500 width=135) (actual time=36510.623..36512.049 rows=500 loops=1)
   ->  Sort  (cost=996174.52..997602.21 rows=571074 width=135) (actual time=36510.619..36511.092 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=929884.87..967718.52 rows=571074 width=135) (actual time=28721.881..35256.168 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=726388.40..751372.89 rows=571074 width=49) (actual time=17391.139..20961.970 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=724932.34..730643.08 rows=571074 width=24) (actual time=17298.325..18481.072 rows=800907 loops=1)
                           ->  Merge Join  (cost=0.00..716366.23 rows=571074 width=24) (actual time=0.135..15712.903 rows=946639 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..109359.66 rows=146066 width=20) (actual time=0.074..196.233 rows=137754 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.043..7800.978 rows=5672228 loops=1)
                                       Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=92.762..92.762 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..45.210 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11329.230..11329.230 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.040..5240.456 rows=4025132 loops=1)
 Total runtime: 36515.833 ms
(21 rows)

Time: 36598.047 ms
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=996174.52..996175.77 rows=500 width=135) (actual time=36491.088..36492.519 rows=500 loops=1)
   ->  Sort  (cost=996174.52..997602.21 rows=571074 width=135) (actual time=36491.085..36491.559 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=929884.87..967718.52 rows=571074 width=135) (actual time=28693.642..35237.748 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=726388.40..751372.89 rows=571074 width=49) (actual time=17366.487..20943.232 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=724932.34..730643.08 rows=571074 width=24) (actual time=17273.617..18456.830 rows=800907 loops=1)
                           ->  Merge Join  (cost=0.00..716366.23 rows=571074 width=24) (actual time=0.139..15702.047 rows=946639 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l1  (cost=0.00..109359.66 rows=146066 width=20) (actual time=0.075..196.798 rows=137754 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Index Scan using locationbin1000__subjectobjectbin on locationbin1000 l2  (cost=0.00..501136.89 rows=5608879 width=20) (actual time=0.045..7808.664 rows=5672228 loops=1)
                                       Index Cond: (l2.subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=92.819..92.819 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..45.137 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11325.614..11325.614 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.040..5224.542 rows=4025132 loops=1)
 Total runtime: 36496.172 ms
(21 rows)

Time: 36578.504 ms
