Testing with size 250
Timing is on.
SELECT
Time: 1567635.851 ms
CREATE INDEX
Time: 895608.615 ms
CREATE INDEX
Time: 1133528.532 ms
CREATE INDEX
Time: 242790.206 ms
CREATE INDEX
Time: 218795.119 ms
ANALYZE
Time: 2706.253 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1441161.14..1441190.86 rows=1321 width=52) (actual time=30505.125..30508.376 rows=949 loops=1)
   ->  Sort  (cost=1441161.14..1441164.44 rows=1321 width=52) (actual time=30505.122..30506.190 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=1425887.07..1441092.66 rows=1321 width=52) (actual time=28570.408..30502.402 rows=1114 loops=1)
               ->  Nested Loop  (cost=1425887.07..1440701.91 rows=1321 width=40) (actual time=28538.942..29933.192 rows=1114 loops=1)
                     ->  Hash Join  (cost=1425887.07..1437091.67 rows=1340 width=30) (actual time=28497.348..28932.466 rows=1114 loops=1)
                           Hash Cond: (l2.subjectid = indirect1.bioentities)
                           ->  Hash Join  (cost=1403823.39..1412776.35 rows=223824 width=26) (actual time=28214.434..28555.153 rows=83765 loops=1)
                                 Hash Cond: (l1.subjectid = a1_.id)
                                 ->  HashAggregate  (cost=1401857.52..1404095.76 rows=223824 width=24) (actual time=26994.623..27103.534 rows=83765 loops=1)
                                       ->  Merge Join  (cost=897168.46..1398500.16 rows=223824 width=24) (actual time=17925.049..24939.782 rows=1460811 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=63.336..1388.886 rows=655253 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                             ->  Sort  (cost=897168.46..900361.62 rows=1277261 width=20) (actual time=17861.689..19337.948 rows=1481710 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 147519kB
                                                   ->  Index Scan using locationbin250__subjecttypeid on locationbin250 l2  (cost=0.00..767624.68 rows=1277261 width=20) (actual time=33.014..14939.753 rows=1259091 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=22) (actual time=1219.757..1219.757 rows=48661 loops=1)
                                       ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=22) (actual time=21.692..1158.869 rows=48661 loops=1)
                           ->  Hash  (cost=21594.87..21594.87 rows=37505 width=4) (actual time=282.231..282.231 rows=4248 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=145.783..277.184 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=80.489..99.354 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=65.287..169.279 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.893..0.894 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using mrna_pkey on mrna a2_  (cost=0.00..0.28 rows=1 width=20) (actual time=0.505..0.506 rows=1 loops=1114)
                     Index Cond: (a2_.id = l2.subjectid)
 Total runtime: 30527.288 ms
(34 rows)

Time: 31179.356 ms
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1441161.14..1441190.86 rows=1321 width=52) (actual time=13989.331..13992.556 rows=949 loops=1)
   ->  Sort  (cost=1441161.14..1441164.44 rows=1321 width=52) (actual time=13989.328..13990.416 rows=1114 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 136kB
         ->  Nested Loop  (cost=1425887.07..1441092.66 rows=1321 width=52) (actual time=13526.998..13986.795 rows=1114 loops=1)
               ->  Nested Loop  (cost=1425887.07..1440701.91 rows=1321 width=40) (actual time=13526.985..13974.936 rows=1114 loops=1)
                     ->  Hash Join  (cost=1425887.07..1437091.67 rows=1340 width=30) (actual time=13526.960..13960.675 rows=1114 loops=1)
                           Hash Cond: (l2.subjectid = indirect1.bioentities)
                           ->  Hash Join  (cost=1403823.39..1412776.35 rows=223824 width=26) (actual time=13506.880..13846.562 rows=83765 loops=1)
                                 Hash Cond: (l1.subjectid = a1_.id)
                                 ->  HashAggregate  (cost=1401857.52..1404095.76 rows=223824 width=24) (actual time=13381.862..13490.336 rows=83765 loops=1)
                                       ->  Merge Join  (cost=897168.46..1398500.16 rows=223824 width=24) (actual time=4790.140..11355.815 rows=1460811 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=0.062..883.902 rows=655253 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                             ->  Sort  (cost=897168.46..900361.62 rows=1277261 width=20) (actual time=4790.054..6257.085 rows=1481710 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  quicksort  Memory: 147519kB
                                                   ->  Index Scan using locationbin250__subjecttypeid on locationbin250 l2  (cost=0.00..767624.68 rows=1277261 width=20) (actual time=0.046..1862.580 rows=1259091 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=22) (actual time=124.966..124.966 rows=48661 loops=1)
                                       ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=22) (actual time=0.014..65.213 rows=48661 loops=1)
                           ->  Hash  (cost=21594.87..21594.87 rows=37505 width=4) (actual time=19.393..19.393 rows=4248 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.210..14.249 rows=4248 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.148..0.349 rows=1 loops=1)
                                             Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.056..5.280 rows=4248 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.007..0.008 rows=1 loops=1114)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using mrna_pkey on mrna a2_  (cost=0.00..0.28 rows=1 width=20) (actual time=0.005..0.006 rows=1 loops=1114)
                     Index Cond: (a2_.id = l2.subjectid)
 Total runtime: 14011.325 ms
(34 rows)

Time: 14015.041 ms
                                                                                                            QUERY PLAN                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1441161.14..1441172.39 rows=500 width=52) (actual time=14006.421..14009.018 rows=500 loops=1)
   ->  Unique  (cost=1441161.14..1441190.86 rows=1321 width=52) (actual time=14006.417..14008.099 rows=500 loops=1)
         ->  Sort  (cost=1441161.14..1441164.44 rows=1321 width=52) (actual time=14006.414..14006.964 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=1425887.07..1441092.66 rows=1321 width=52) (actual time=13543.899..14003.886 rows=1114 loops=1)
                     ->  Nested Loop  (cost=1425887.07..1440701.91 rows=1321 width=40) (actual time=13543.886..13992.198 rows=1114 loops=1)
                           ->  Hash Join  (cost=1425887.07..1437091.67 rows=1340 width=30) (actual time=13543.860..13978.005 rows=1114 loops=1)
                                 Hash Cond: (l2.subjectid = indirect1.bioentities)
                                 ->  Hash Join  (cost=1403823.39..1412776.35 rows=223824 width=26) (actual time=13523.884..13864.216 rows=83765 loops=1)
                                       Hash Cond: (l1.subjectid = a1_.id)
                                       ->  HashAggregate  (cost=1401857.52..1404095.76 rows=223824 width=24) (actual time=13399.494..13508.247 rows=83765 loops=1)
                                             ->  Merge Join  (cost=897168.46..1398500.16 rows=223824 width=24) (actual time=4818.375..11382.062 rows=1460811 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=0.073..883.990 rows=655253 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Sort  (cost=897168.46..900361.62 rows=1277261 width=20) (actual time=4818.278..6294.516 rows=1481710 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  quicksort  Memory: 147519kB
                                                         ->  Index Scan using locationbin250__subjecttypeid on locationbin250 l2  (cost=0.00..767624.68 rows=1277261 width=20) (actual time=0.045..1891.887 rows=1259091 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                       ->  Hash  (cost=1357.61..1357.61 rows=48661 width=22) (actual time=124.338..124.338 rows=48661 loops=1)
                                             ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=22) (actual time=0.014..64.573 rows=48661 loops=1)
                                 ->  Hash  (cost=21594.87..21594.87 rows=37505 width=4) (actual time=19.289..19.289 rows=4248 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.205..14.202 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.146..0.344 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.053..5.201 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.007..0.008 rows=1 loops=1114)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using mrna_pkey on mrna a2_  (cost=0.00..0.28 rows=1 width=20) (actual time=0.005..0.006 rows=1 loops=1114)
                           Index Cond: (a2_.id = l2.subjectid)
 Total runtime: 14027.263 ms
(35 rows)

Time: 14059.169 ms
                                                                                                            QUERY PLAN                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1441161.14..1441172.39 rows=500 width=52) (actual time=14016.858..14019.476 rows=500 loops=1)
   ->  Unique  (cost=1441161.14..1441190.86 rows=1321 width=52) (actual time=14016.854..14018.540 rows=500 loops=1)
         ->  Sort  (cost=1441161.14..1441164.44 rows=1321 width=52) (actual time=14016.851..14017.406 rows=577 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a1_.id, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 136kB
               ->  Nested Loop  (cost=1425887.07..1441092.66 rows=1321 width=52) (actual time=13552.771..14014.335 rows=1114 loops=1)
                     ->  Nested Loop  (cost=1425887.07..1440701.91 rows=1321 width=40) (actual time=13552.758..14002.096 rows=1114 loops=1)
                           ->  Hash Join  (cost=1425887.07..1437091.67 rows=1340 width=30) (actual time=13552.733..13986.663 rows=1114 loops=1)
                                 Hash Cond: (l2.subjectid = indirect1.bioentities)
                                 ->  Hash Join  (cost=1403823.39..1412776.35 rows=223824 width=26) (actual time=13532.993..13872.886 rows=83765 loops=1)
                                       Hash Cond: (l1.subjectid = a1_.id)
                                       ->  HashAggregate  (cost=1401857.52..1404095.76 rows=223824 width=24) (actual time=13408.534..13516.932 rows=83765 loops=1)
                                             ->  Merge Join  (cost=897168.46..1398500.16 rows=223824 width=24) (actual time=4812.955..11392.789 rows=1460811 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=0.076..883.672 rows=655253 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                                   ->  Sort  (cost=897168.46..900361.62 rows=1277261 width=20) (actual time=4812.855..6283.610 rows=1481710 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  quicksort  Memory: 147519kB
                                                         ->  Index Scan using locationbin250__subjecttypeid on locationbin250 l2  (cost=0.00..767624.68 rows=1277261 width=20) (actual time=0.045..1890.776 rows=1259091 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.MRNA'::text)
                                       ->  Hash  (cost=1357.61..1357.61 rows=48661 width=22) (actual time=124.409..124.409 rows=48661 loops=1)
                                             ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=22) (actual time=0.015..64.762 rows=48661 loops=1)
                                 ->  Hash  (cost=21594.87..21594.87 rows=37505 width=4) (actual time=19.054..19.054 rows=4248 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.206..14.087 rows=4248 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.145..0.340 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.056..5.159 rows=4248 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..2.68 rows=1 width=14) (actual time=0.008..0.009 rows=1 loops=1114)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using mrna_pkey on mrna a2_  (cost=0.00..0.28 rows=1 width=20) (actual time=0.005..0.007 rows=1 loops=1114)
                           Index Cond: (a2_.id = l2.subjectid)
 Total runtime: 14037.739 ms
(35 rows)

Time: 14041.580 ms
                                                                                                               QUERY PLAN                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=499125.36..499127.29 rows=70 width=66) (actual time=3606.898..3627.093 rows=6492 loops=1)
   ->  Sort  (cost=499125.36..499125.54 rows=70 width=66) (actual time=3606.895..3613.333 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=498558.81..499123.22 rows=70 width=66) (actual time=2113.517..3589.710 rows=6492 loops=1)
               ->  Nested Loop  (cost=498558.81..498993.34 rows=70 width=55) (actual time=2065.050..3466.139 rows=6492 loops=1)
                     ->  Nested Loop  (cost=498558.81..498904.79 rows=70 width=45) (actual time=2064.824..3193.061 rows=6492 loops=1)
                           ->  Nested Loop  (cost=498558.81..498883.85 rows=72 width=31) (actual time=2050.830..3097.122 rows=6499 loops=1)
                                 ->  Merge Join  (cost=498558.81..498807.07 rows=72 width=12) (actual time=2015.801..2045.766 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.450..22.814 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.181..13.632 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.125..0.328 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.050..4.955 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=474114.54..474144.55 rows=12004 width=8) (actual time=1989.107..1999.859 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=473061.11..473301.19 rows=12004 width=8) (actual time=1788.682..1926.709 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=473061.11..473181.15 rows=12004 width=24) (actual time=1788.678..1846.513 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..472881.05 rows=12004 width=24) (actual time=51.602..1684.600 rows=64734 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=37.905..131.210 rows=64672 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=13.605..767.898 rows=559792 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.05 rows=1 width=23) (actual time=0.156..0.157 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.009..0.010 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.037..0.038 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.84 rows=1 width=19) (actual time=0.011..0.015 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 3633.390 ms
(39 rows)

Time: 3681.261 ms
                                                                                                               QUERY PLAN                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=499125.36..499127.29 rows=70 width=66) (actual time=2188.817..2208.998 rows=6492 loops=1)
   ->  Sort  (cost=499125.36..499125.54 rows=70 width=66) (actual time=2188.814..2195.265 rows=6492 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 1105kB
         ->  Nested Loop  (cost=498558.81..499123.22 rows=70 width=66) (actual time=1911.108..2172.046 rows=6492 loops=1)
               ->  Nested Loop  (cost=498558.81..498993.34 rows=70 width=55) (actual time=1911.095..2116.146 rows=6492 loops=1)
                     ->  Nested Loop  (cost=498558.81..498904.79 rows=70 width=45) (actual time=1911.080..2055.637 rows=6492 loops=1)
                           ->  Nested Loop  (cost=498558.81..498883.85 rows=72 width=31) (actual time=1911.067..2000.458 rows=6499 loops=1)
                                 ->  Merge Join  (cost=498558.81..498807.07 rows=72 width=12) (actual time=1911.027..1940.446 rows=6499 loops=1)
                                       Merge Cond: (indirect1.bioentities = l.lid2)
                                       ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.219..22.573 rows=4248 loops=1)
                                             Sort Key: indirect1.bioentities
                                             Sort Method:  quicksort  Memory: 392kB
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.104..13.412 rows=4248 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.196 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..4.921 rows=4248 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Sort  (cost=474114.54..474144.55 rows=12004 width=8) (actual time=1884.553..1895.127 rows=9818 loops=1)
                                             Sort Key: l.lid2
                                             Sort Method:  quicksort  Memory: 3480kB
                                             ->  Subquery Scan l  (cost=473061.11..473301.19 rows=12004 width=8) (actual time=1689.794..1822.392 rows=41453 loops=1)
                                                   ->  HashAggregate  (cost=473061.11..473181.15 rows=12004 width=24) (actual time=1689.791..1741.965 rows=41453 loops=1)
                                                         ->  Merge Join  (cost=0.00..472881.05 rows=12004 width=24) (actual time=0.123..1589.608 rows=64734 loops=1)
                                                               Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                               Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                               ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=0.019..82.205 rows=64672 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                               ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=0.019..712.504 rows=559792 loops=1)
                                                                     Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.05 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                       Index Cond: (a1_.id = l.lid1)
                           ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                 Index Cond: (a5_.id = a1_.geneid)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
               ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.84 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                     Index Cond: (a2_.id = l.lid2)
 Total runtime: 2215.279 ms
(39 rows)

Time: 2220.043 ms
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=499125.36..499127.29 rows=70 width=66) (actual time=2187.813..2190.343 rows=500 loops=1)
   ->  Unique  (cost=499125.36..499127.29 rows=70 width=66) (actual time=2187.809..2189.384 rows=500 loops=1)
         ->  Sort  (cost=499125.36..499125.54 rows=70 width=66) (actual time=2187.806..2188.291 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=498558.81..499123.22 rows=70 width=66) (actual time=1907.370..2171.220 rows=6492 loops=1)
                     ->  Nested Loop  (cost=498558.81..498993.34 rows=70 width=55) (actual time=1907.356..2112.854 rows=6492 loops=1)
                           ->  Nested Loop  (cost=498558.81..498904.79 rows=70 width=45) (actual time=1907.342..2052.381 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=498558.81..498883.85 rows=72 width=31) (actual time=1907.328..1996.999 rows=6499 loops=1)
                                       ->  Merge Join  (cost=498558.81..498807.07 rows=72 width=12) (actual time=1907.292..1936.570 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.213..22.556 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.106..13.424 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.077..0.199 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.024..4.910 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=474114.54..474144.55 rows=12004 width=8) (actual time=1880.859..1891.391 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=473061.11..473301.19 rows=12004 width=8) (actual time=1685.195..1817.969 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=473061.11..473181.15 rows=12004 width=24) (actual time=1685.191..1738.058 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..472881.05 rows=12004 width=24) (actual time=0.133..1585.981 rows=64734 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=0.026..82.468 rows=64672 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=0.019..705.663 rows=559792 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.05 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.84 rows=1 width=19) (actual time=0.004..0.005 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 2191.047 ms
(40 rows)

Time: 2195.820 ms
                                                                                                                  QUERY PLAN                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=499125.36..499127.29 rows=70 width=66) (actual time=2183.032..2185.544 rows=500 loops=1)
   ->  Unique  (cost=499125.36..499127.29 rows=70 width=66) (actual time=2183.029..2184.608 rows=500 loops=1)
         ->  Sort  (cost=499125.36..499125.54 rows=70 width=66) (actual time=2183.025..2183.516 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 1105kB
               ->  Nested Loop  (cost=498558.81..499123.22 rows=70 width=66) (actual time=1907.484..2166.249 rows=6492 loops=1)
                     ->  Nested Loop  (cost=498558.81..498993.34 rows=70 width=55) (actual time=1907.470..2111.075 rows=6492 loops=1)
                           ->  Nested Loop  (cost=498558.81..498904.79 rows=70 width=45) (actual time=1907.455..2051.115 rows=6492 loops=1)
                                 ->  Nested Loop  (cost=498558.81..498883.85 rows=72 width=31) (actual time=1907.442..1996.334 rows=6499 loops=1)
                                       ->  Merge Join  (cost=498558.81..498807.07 rows=72 width=12) (actual time=1907.409..1936.758 rows=6499 loops=1)
                                             Merge Cond: (indirect1.bioentities = l.lid2)
                                             ->  Sort  (cost=24444.27..24538.03 rows=37505 width=4) (actual time=18.270..22.637 rows=4248 loops=1)
                                                   Sort Key: indirect1.bioentities
                                                   Sort Method:  quicksort  Memory: 392kB
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.105..13.483 rows=4248 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.075..0.197 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ '5'' race (mixed-stage embryos)'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.025..4.952 rows=4248 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Sort  (cost=474114.54..474144.55 rows=12004 width=8) (actual time=1880.879..1891.436 rows=9818 loops=1)
                                                   Sort Key: l.lid2
                                                   Sort Method:  quicksort  Memory: 3480kB
                                                   ->  Subquery Scan l  (cost=473061.11..473301.19 rows=12004 width=8) (actual time=1684.956..1817.755 rows=41453 loops=1)
                                                         ->  HashAggregate  (cost=473061.11..473181.15 rows=12004 width=24) (actual time=1684.952..1737.868 rows=41453 loops=1)
                                                               ->  Merge Join  (cost=0.00..472881.05 rows=12004 width=24) (actual time=0.123..1583.285 rows=64734 loops=1)
                                                                     Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                                                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                                     ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=0.018..82.450 rows=64672 loops=1)
                                                                           Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                                                     ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=0.019..703.572 rows=559792 loops=1)
                                                                           Index Cond: (l1.subjecttype = 'org.intermine.model.bio.Exon'::text)
                                       ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..1.05 rows=1 width=23) (actual time=0.004..0.005 rows=1 loops=6499)
                                             Index Cond: (a1_.id = l.lid1)
                                 ->  Index Scan using gene_pkey on gene a5_  (cost=0.00..0.28 rows=1 width=18) (actual time=0.003..0.004 rows=1 loops=6499)
                                       Index Cond: (a5_.id = a1_.geneid)
                           ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.004..0.005 rows=1 loops=6492)
                                 Index Cond: (a4_.id = a1_.chromosomelocationid)
                     ->  Index Scan using est_pkey on est a2_  (cost=0.00..1.84 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=6492)
                           Index Cond: (a2_.id = l.lid2)
 Total runtime: 2186.251 ms
(40 rows)

Time: 2190.680 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3556222.07..3556409.20 rows=14970 width=46) (actual time=66561.578..66584.445 rows=7408 loops=1)
   ->  Sort  (cost=3556222.07..3556259.50 rows=14970 width=46) (actual time=66561.574..66569.019 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Hash Join  (cost=3490477.20..3555183.92 rows=14970 width=46) (actual time=60508.096..66543.737 rows=7408 loops=1)
               Hash Cond: (a1_.geneid = a4_.id)
               ->  Nested Loop  (cost=3488511.32..3552918.65 rows=14970 width=32) (actual time=60385.603..66395.829 rows=7408 loops=1)
                     ->  Hash Join  (cost=3488511.32..3548056.89 rows=14970 width=32) (actual time=60314.455..63335.829 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=3462199.53..3487208.27 rows=2500874 width=24) (actual time=59881.241..61404.182 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=2179565.16..3424686.42 rows=2500874 width=24) (actual time=21681.360..49691.273 rows=6981130 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..732748.88 rows=1189092 width=20) (actual time=30.381..1816.760 rows=1212087 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21650.957..29617.880 rows=8203240 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 788492kB
                                             ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=2408.654..11951.163 rows=7576110 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=2368.298..2368.298 rows=7576110 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=433.154..433.154 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=370.704..423.830 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=25.558..59.985 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.074..0.210 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=25.476..46.574 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=345.088..345.088 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=5.467..209.001 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.31 rows=1 width=8) (actual time=0.033..0.033 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.453..122.453 rows=48661 loops=1)
                     ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.036..61.969 rows=48661 loops=1)
 Total runtime: 66712.041 ms
(38 rows)

Time: 66797.501 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3556222.07..3556409.20 rows=14970 width=46) (actual time=63151.481..63174.336 rows=7408 loops=1)
   ->  Sort  (cost=3556222.07..3556259.50 rows=14970 width=46) (actual time=63151.478..63158.888 rows=7408 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 1228kB
         ->  Hash Join  (cost=3490477.20..3555183.92 rows=14970 width=46) (actual time=59382.894..63133.993 rows=7408 loops=1)
               Hash Cond: (a1_.geneid = a4_.id)
               ->  Nested Loop  (cost=3488511.32..3552918.65 rows=14970 width=32) (actual time=59255.357..62981.357 rows=7408 loops=1)
                     ->  Hash Join  (cost=3488511.32..3548056.89 rows=14970 width=32) (actual time=59255.047..62263.350 rows=85984 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=3462199.53..3487208.27 rows=2500874 width=24) (actual time=58935.723..60459.930 rows=1119997 loops=1)
                                 ->  Merge Join  (cost=2179565.16..3424686.42 rows=2500874 width=24) (actual time=21186.610..49094.023 rows=6981130 loops=1)
                                       Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..732748.88 rows=1189092 width=20) (actual time=0.059..1702.685 rows=1212087 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                       ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21186.529..29124.324 rows=8203240 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 788492kB
                                             ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=1985.578..11537.899 rows=7576110 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=1944.897..1944.897 rows=7576110 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                           ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=319.263..319.263 rows=6562 loops=1)
                                 ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=269.738..309.986 rows=6562 loops=1)
                                       Hash Cond: (indirect1.bioentities = a2_.id)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.178..21.559 rows=6562 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.110..0.309 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.060..8.037 rows=6562 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=269.499..269.499 rows=103331 loops=1)
                                             ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.013..132.308 rows=103331 loops=1)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.31 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=127.497..127.497 rows=48661 loops=1)
                     ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.036..68.267 rows=48661 loops=1)
 Total runtime: 63314.363 ms
(38 rows)

Time: 63326.978 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3556222.07..3556228.32 rows=500 width=46) (actual time=63158.059..63160.528 rows=500 loops=1)
   ->  Unique  (cost=3556222.07..3556409.20 rows=14970 width=46) (actual time=63158.056..63159.574 rows=500 loops=1)
         ->  Sort  (cost=3556222.07..3556259.50 rows=14970 width=46) (actual time=63158.052..63158.547 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Hash Join  (cost=3490477.20..3555183.92 rows=14970 width=46) (actual time=59337.622..63140.476 rows=7408 loops=1)
                     Hash Cond: (a1_.geneid = a4_.id)
                     ->  Nested Loop  (cost=3488511.32..3552918.65 rows=14970 width=32) (actual time=59216.014..62993.485 rows=7408 loops=1)
                           ->  Hash Join  (cost=3488511.32..3548056.89 rows=14970 width=32) (actual time=59215.701..62262.568 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=3462199.53..3487208.27 rows=2500874 width=24) (actual time=58898.017..60438.586 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=2179565.16..3424686.42 rows=2500874 width=24) (actual time=21129.857..49029.625 rows=6981130 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..732748.88 rows=1189092 width=20) (actual time=0.058..1704.684 rows=1212087 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21129.777..29090.042 rows=8203240 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 788492kB
                                                   ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=1948.499..11435.197 rows=7576110 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=1907.893..1907.893 rows=7576110 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=317.630..317.630 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=268.627..308.360 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.168..21.299 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.108..0.311 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.054..7.993 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=268.398..268.398 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.013..132.087 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.31 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.568..121.568 rows=48661 loops=1)
                           ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..62.295 rows=48661 loops=1)
 Total runtime: 63288.190 ms
(39 rows)

Time: 63300.874 ms
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3556222.07..3556228.32 rows=500 width=46) (actual time=63342.801..63345.279 rows=500 loops=1)
   ->  Unique  (cost=3556222.07..3556409.20 rows=14970 width=46) (actual time=63342.797..63344.328 rows=500 loops=1)
         ->  Sort  (cost=3556222.07..3556259.50 rows=14970 width=46) (actual time=63342.793..63343.286 rows=500 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 1228kB
               ->  Hash Join  (cost=3490477.20..3555183.92 rows=14970 width=46) (actual time=59528.202..63325.190 rows=7408 loops=1)
                     Hash Cond: (a1_.geneid = a4_.id)
                     ->  Nested Loop  (cost=3488511.32..3552918.65 rows=14970 width=32) (actual time=59407.008..63178.574 rows=7408 loops=1)
                           ->  Hash Join  (cost=3488511.32..3548056.89 rows=14970 width=32) (actual time=59406.704..62459.363 rows=85984 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=3462199.53..3487208.27 rows=2500874 width=24) (actual time=59087.679..60631.860 rows=1119997 loops=1)
                                       ->  Merge Join  (cost=2179565.16..3424686.42 rows=2500874 width=24) (actual time=21138.929..49016.143 rows=6981130 loops=1)
                                             Merge Cond: ((l2.objectid = l1.objectid) AND (l2.bin = l1.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..732748.88 rows=1189092 width=20) (actual time=0.058..1723.701 rows=1212087 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.ProteinBindingSite'::text)
                                             ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21138.849..29072.703 rows=8203240 loops=1)
                                                   Sort Key: l1.objectid, l1.bin
                                                   Sort Method:  quicksort  Memory: 788492kB
                                                   ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=1925.193..11448.471 rows=7576110 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=1884.435..1884.435 rows=7576110 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Hash  (cost=26304.05..26304.05 rows=619 width=32) (actual time=318.971..318.971 rows=6562 loops=1)
                                       ->  Hash Join  (cost=4327.95..26304.05 rows=619 width=32) (actual time=269.722..309.699 rows=6562 loops=1)
                                             Hash Cond: (indirect1.bioentities = a2_.id)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.170..21.401 rows=6562 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.106..0.320 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'adultmale_h3k4me3'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.058..8.025 rows=6562 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=269.492..269.492 rows=103331 loops=1)
                                                   ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.012..133.211 rows=103331 loops=1)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.31 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=85984)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '2.0kb'::text) AND (lower(a1_.direction) ~~ 'upstream'::text))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=121.154..121.154 rows=48661 loops=1)
                           ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..62.170 rows=48661 loops=1)
 Total runtime: 63472.210 ms
(39 rows)

Time: 63484.858 ms
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1925346.67..1925359.45 rows=1022 width=37) (actual time=7317.410..7318.441 rows=341 loops=1)
   ->  Sort  (cost=1925346.67..1925349.23 rows=1022 width=37) (actual time=7317.407..7317.737 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=1920449.26..1925295.58 rows=1022 width=37) (actual time=6918.556..7316.698 rows=341 loops=1)
               ->  Nested Loop  (cost=1920449.26..1924964.45 rows=1022 width=23) (actual time=6918.519..7311.424 rows=341 loops=1)
                     ->  Hash Join  (cost=1920449.26..1924515.60 rows=1022 width=23) (actual time=6918.302..7291.291 rows=2193 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=1886661.79..1888369.63 rows=170784 width=24) (actual time=6891.500..7096.720 rows=160316 loops=1)
                                 ->  Nested Loop  (cost=0.00..1884100.03 rows=170784 width=24) (actual time=0.108..5989.940 rows=625210 loops=1)
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=0.054..86.609 rows=64672 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                       ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..22.22 rows=5 width=20) (actual time=0.045..0.068 rows=10 loops=64672)
                                             Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=26.768..26.768 rows=322 loops=1)
                                 ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=14.476..26.316 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=7.876..22.480 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.133..0.341 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=7.735..21.058 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.43 rows=1 width=8) (actual time=0.007..0.007 rows=0 loops=2193)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.010..0.011 rows=1 loops=341)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 7320.965 ms
(30 rows)

Time: 7324.546 ms
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1925346.67..1925359.45 rows=1022 width=37) (actual time=4334.199..4335.203 rows=341 loops=1)
   ->  Sort  (cost=1925346.67..1925349.23 rows=1022 width=37) (actual time=4334.196..4334.525 rows=341 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 51kB
         ->  Nested Loop  (cost=1920449.26..1925295.58 rows=1022 width=37) (actual time=3942.092..4333.501 rows=341 loops=1)
               ->  Nested Loop  (cost=1920449.26..1924964.45 rows=1022 width=23) (actual time=3942.079..4330.029 rows=341 loops=1)
                     ->  Hash Join  (cost=1920449.26..1924515.60 rows=1022 width=23) (actual time=3941.859..4311.657 rows=2193 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=1886661.79..1888369.63 rows=170784 width=24) (actual time=3935.693..4138.912 rows=160316 loops=1)
                                 ->  Nested Loop  (cost=0.00..1884100.03 rows=170784 width=24) (actual time=0.040..3036.550 rows=625210 loops=1)
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=0.016..83.187 rows=64672 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                       ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..22.22 rows=5 width=20) (actual time=0.010..0.022 rows=10 loops=64672)
                                             Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=6.130..6.130 rows=322 loops=1)
                                 ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=1.857..5.697 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.106..1.981 rows=546 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.078..0.205 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.023..0.649 rows=546 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.43 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=2193)
                           Index Cond: (a1_.id = l1.subjectid)
                           Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
               ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=341)
                     Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 4337.696 ms
(30 rows)

Time: 4341.497 ms
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1925346.67..1925352.92 rows=500 width=37) (actual time=4378.914..4380.599 rows=341 loops=1)
   ->  Unique  (cost=1925346.67..1925359.45 rows=1022 width=37) (actual time=4378.910..4379.938 rows=341 loops=1)
         ->  Sort  (cost=1925346.67..1925349.23 rows=1022 width=37) (actual time=4378.907..4379.237 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=1920449.26..1925295.58 rows=1022 width=37) (actual time=3986.080..4378.216 rows=341 loops=1)
                     ->  Nested Loop  (cost=1920449.26..1924964.45 rows=1022 width=23) (actual time=3986.067..4374.732 rows=341 loops=1)
                           ->  Hash Join  (cost=1920449.26..1924515.60 rows=1022 width=23) (actual time=3985.855..4356.315 rows=2193 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1886661.79..1888369.63 rows=170784 width=24) (actual time=3979.659..4183.305 rows=160316 loops=1)
                                       ->  Nested Loop  (cost=0.00..1884100.03 rows=170784 width=24) (actual time=0.040..3069.353 rows=625210 loops=1)
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=0.016..84.424 rows=64672 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..22.22 rows=5 width=20) (actual time=0.010..0.022 rows=10 loops=64672)
                                                   Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=6.162..6.162 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=1.903..5.726 rows=322 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.104..1.987 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.077..0.210 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.022..0.658 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.43 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 4383.088 ms
(31 rows)

Time: 4386.613 ms
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1925346.67..1925352.92 rows=500 width=37) (actual time=4375.712..4377.390 rows=341 loops=1)
   ->  Unique  (cost=1925346.67..1925359.45 rows=1022 width=37) (actual time=4375.709..4376.737 rows=341 loops=1)
         ->  Sort  (cost=1925346.67..1925349.23 rows=1022 width=37) (actual time=4375.706..4376.035 rows=341 loops=1)
               Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
               Sort Method:  quicksort  Memory: 51kB
               ->  Nested Loop  (cost=1920449.26..1925295.58 rows=1022 width=37) (actual time=3982.763..4375.013 rows=341 loops=1)
                     ->  Nested Loop  (cost=1920449.26..1924964.45 rows=1022 width=23) (actual time=3982.750..4371.538 rows=341 loops=1)
                           ->  Hash Join  (cost=1920449.26..1924515.60 rows=1022 width=23) (actual time=3982.538..4353.106 rows=2193 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=1886661.79..1888369.63 rows=170784 width=24) (actual time=3976.334..4180.143 rows=160316 loops=1)
                                       ->  Nested Loop  (cost=0.00..1884100.03 rows=170784 width=24) (actual time=0.040..3069.071 rows=625210 loops=1)
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l2  (cost=0.00..71707.26 rows=81203 width=20) (actual time=0.016..84.088 rows=64672 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.EST'::text)
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..22.22 rows=5 width=20) (actual time=0.010..0.022 rows=10 loops=64672)
                                                   Index Cond: ((l1.subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text) AND (l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 ->  Hash  (cost=33732.90..33732.90 rows=4365 width=23) (actual time=6.170..6.170 rows=322 loops=1)
                                       ->  Nested Loop  (cost=0.00..33732.90 rows=4365 width=23) (actual time=1.904..5.731 rows=322 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.104..1.956 rows=546 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.077..0.204 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dmg3 rtpcr'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.021..0.651 rows=546 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using est_pkey on est a2_  (cost=0.00..0.31 rows=1 width=19) (actual time=0.003..0.004 rows=1 loops=546)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using geneflankingregion_pkey on geneflankingregion a1_  (cost=0.00..0.43 rows=1 width=8) (actual time=0.006..0.006 rows=0 loops=2193)
                                 Index Cond: (a1_.id = l1.subjectid)
                                 Filter: ((lower(a1_.distance) ~~ '5.0kb'::text) AND (lower(a1_.direction) ~~ 'downstream'::text))
                     ->  Index Scan using gene_pkey on gene a4_  (cost=0.00..0.31 rows=1 width=18) (actual time=0.005..0.006 rows=1 loops=341)
                           Index Cond: (a4_.id = a1_.geneid)
 Total runtime: 4379.885 ms
(31 rows)

Time: 4383.441 ms
                                                                                                           QUERY PLAN                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3482562.88..3482813.84 rows=9126 width=82) (actual time=131677.669..131808.387 rows=39884 loops=1)
   ->  Sort  (cost=3482562.88..3482585.69 rows=9126 width=82) (actual time=131677.664..131720.244 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=3430017.11..3481962.58 rows=9126 width=82) (actual time=112326.956..131550.162 rows=39884 loops=1)
               ->  Hash Join  (cost=3430017.11..3470418.14 rows=9126 width=72) (actual time=112326.913..130043.522 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=3428051.23..3468266.98 rows=9402 width=58) (actual time=112201.534..129777.558 rows=40032 loops=1)
                           ->  Hash Join  (cost=3428051.23..3465450.28 rows=9402 width=39) (actual time=112201.476..128600.068 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=3385948.49..3401655.87 rows=1570738 width=24) (actual time=111466.579..118857.598 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=2645165.66..3362387.42 rows=1570738 width=24) (actual time=50221.892..94246.802 rows=10216269 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=0.050..764.184 rows=526254 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=50221.819..65661.159 rows=14284829 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  external sort  Disk: 346200kB
                                                   ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=4696.038..17953.274 rows=10416305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=4633.748..4633.748 rows=10416305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=733.412..733.412 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=59.612..662.323 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=18.408..190.712 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.135..0.213 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=18.263..92.850 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.004..0.006 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.024..0.025 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.338..125.338 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..62.061 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.032..0.033 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 132131.948 ms
(39 rows)

Time: 132150.993 ms
                                                                                                           QUERY PLAN                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3482562.88..3482813.84 rows=9126 width=82) (actual time=129308.481..129439.031 rows=39884 loops=1)
   ->  Sort  (cost=3482562.88..3482585.69 rows=9126 width=82) (actual time=129308.476..129351.121 rows=39884 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
         Sort Method:  quicksort  Memory: 7145kB
         ->  Nested Loop  (cost=3430017.11..3481962.58 rows=9126 width=82) (actual time=111476.749..129179.762 rows=39884 loops=1)
               ->  Hash Join  (cost=3430017.11..3470418.14 rows=9126 width=72) (actual time=111476.707..128701.203 rows=39884 loops=1)
                     Hash Cond: (a1_.geneid = a5_.id)
                     ->  Nested Loop  (cost=3428051.23..3468266.98 rows=9402 width=58) (actual time=111354.337..128438.919 rows=40032 loops=1)
                           ->  Hash Join  (cost=3428051.23..3465450.28 rows=9402 width=39) (actual time=111354.280..127944.661 rows=40032 loops=1)
                                 Hash Cond: (l2.subjectid = a2_.id)
                                 ->  HashAggregate  (cost=3385948.49..3401655.87 rows=1570738 width=24) (actual time=110709.064..118205.898 rows=4677887 loops=1)
                                       ->  Merge Join  (cost=2645165.66..3362387.42 rows=1570738 width=24) (actual time=49261.010..93493.312 rows=10216269 loops=1)
                                             Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                             Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                             ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=0.048..762.839 rows=526254 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                             ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=49260.940..64735.035 rows=14284829 loops=1)
                                                   Sort Key: l2.objectid, l2.bin
                                                   Sort Method:  external sort  Disk: 346200kB
                                                   ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=3831.107..17056.592 rows=10416305 loops=1)
                                                         Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                         ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=3768.578..3768.578 rows=10416305 loops=1)
                                                               Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                 ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.725..643.725 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.314..572.893 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.270..156.279 rows=48827 loops=1)
                                                   ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.207..0.323 rows=1 loops=1)
                                                         Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                   ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.056..58.174 rows=48827 loops=1)
                                                         Index Cond: (indirect1.datasets = a3_.id)
                                             ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                   Index Cond: (a2_.id = indirect1.bioentities)
                           ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                 Index Cond: (a1_.id = l1.subjectid)
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.332..122.332 rows=48661 loops=1)
                           ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..61.947 rows=48661 loops=1)
               ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.008 rows=1 loops=39884)
                     Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 129762.335 ms
(39 rows)

Time: 129772.735 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3482562.88..3482576.63 rows=500 width=82) (actual time=129466.929..129469.485 rows=500 loops=1)
   ->  Unique  (cost=3482562.88..3482813.84 rows=9126 width=82) (actual time=129466.927..129468.539 rows=500 loops=1)
         ->  Sort  (cost=3482562.88..3482585.69 rows=9126 width=82) (actual time=129466.921..129467.451 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=3430017.11..3481962.58 rows=9126 width=82) (actual time=111682.648..129338.176 rows=39884 loops=1)
                     ->  Hash Join  (cost=3430017.11..3470418.14 rows=9126 width=72) (actual time=111682.606..128869.611 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=3428051.23..3468266.98 rows=9402 width=58) (actual time=111559.731..128603.532 rows=40032 loops=1)
                                 ->  Hash Join  (cost=3428051.23..3465450.28 rows=9402 width=39) (actual time=111559.675..128112.390 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=3385948.49..3401655.87 rows=1570738 width=24) (actual time=110911.761..118408.944 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=2645165.66..3362387.42 rows=1570738 width=24) (actual time=49756.986..93912.118 rows=10216269 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=0.052..759.317 rows=526254 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=49756.911..65333.052 rows=14284829 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  external sort  Disk: 346200kB
                                                         ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=4041.985..17308.584 rows=10416305 loops=1)
                                                               Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                               ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=3979.522..3979.522 rows=10416305 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=646.415..646.415 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.320..575.478 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.277..157.240 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.212..0.341 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.057..58.800 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=122.836..122.836 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.034..61.990 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.007 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 129755.331 ms
(40 rows)

Time: 129765.718 ms
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3482562.88..3482576.63 rows=500 width=82) (actual time=129614.090..129616.658 rows=500 loops=1)
   ->  Unique  (cost=3482562.88..3482813.84 rows=9126 width=82) (actual time=129614.086..129615.708 rows=500 loops=1)
         ->  Sort  (cost=3482562.88..3482585.69 rows=9126 width=82) (actual time=129614.081..129614.609 rows=500 loops=1)
               Sort Key: a1_.primaryidentifier, a2_.secondaryidentifier, a4_.intermine_start, a4_.intermine_end, a4_.strand, a5_.primaryidentifier, a1_.id, a2_.id, a4_.id, a5_.id
               Sort Method:  quicksort  Memory: 7145kB
               ->  Nested Loop  (cost=3430017.11..3481962.58 rows=9126 width=82) (actual time=111784.863..129485.355 rows=39884 loops=1)
                     ->  Hash Join  (cost=3430017.11..3470418.14 rows=9126 width=72) (actual time=111784.821..129010.847 rows=39884 loops=1)
                           Hash Cond: (a1_.geneid = a5_.id)
                           ->  Nested Loop  (cost=3428051.23..3468266.98 rows=9402 width=58) (actual time=111661.670..128745.015 rows=40032 loops=1)
                                 ->  Hash Join  (cost=3428051.23..3465450.28 rows=9402 width=39) (actual time=111661.614..128253.432 rows=40032 loops=1)
                                       Hash Cond: (l2.subjectid = a2_.id)
                                       ->  HashAggregate  (cost=3385948.49..3401655.87 rows=1570738 width=24) (actual time=111015.555..118528.136 rows=4677887 loops=1)
                                             ->  Merge Join  (cost=2645165.66..3362387.42 rows=1570738 width=24) (actual time=49685.987..93834.233 rows=10216269 loops=1)
                                                   Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                                   Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                                   ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..396448.56 rows=539738 width=20) (actual time=0.055..758.940 rows=526254 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.Exon'::text)
                                                   ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=49685.908..65268.848 rows=14284829 loops=1)
                                                         Sort Key: l2.objectid, l2.bin
                                                         Sort Method:  external sort  Disk: 346200kB
                                                         ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=4040.100..17306.777 rows=10416305 loops=1)
                                                               Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                               ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=3977.652..3977.652 rows=10416305 loops=1)
                                                                     Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=644.561..644.561 rows=48827 loops=1)
                                             ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.320..573.624 rows=48827 loops=1)
                                                   ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.275..156.617 rows=48827 loops=1)
                                                         ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.211..0.328 rows=1 loops=1)
                                                               Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                                         ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.057..58.493 rows=48827 loops=1)
                                                               Index Cond: (indirect1.datasets = a3_.id)
                                                   ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                                         Index Cond: (a2_.id = indirect1.bioentities)
                                 ->  Index Scan using exon_pkey on exon a1_  (cost=0.00..0.29 rows=1 width=23) (actual time=0.007..0.008 rows=1 loops=40032)
                                       Index Cond: (a1_.id = l1.subjectid)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.114..123.114 rows=48661 loops=1)
                                 ->  Seq Scan on gene a5_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.035..62.468 rows=48661 loops=1)
                     ->  Index Scan using location_pkey on location a4_  (cost=0.00..1.25 rows=1 width=14) (actual time=0.006..0.008 rows=1 loops=39884)
                           Index Cond: (a4_.id = a1_.chromosomelocationid)
 Total runtime: 129902.789 ms
(40 rows)

Time: 129913.232 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=10347027.27..10348699.37 rows=133768 width=53) (actual time=567329.298..567385.794 rows=17651 loops=1)
   ->  Sort  (cost=10347027.27..10347361.69 rows=133768 width=53) (actual time=567329.294..567348.361 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=9800871.61..10335637.35 rows=133768 width=53) (actual time=466224.204..567260.084 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=9785003.65..10317094.03 rows=133768 width=39) (actual time=465387.981..565811.525 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=9742900.91..9966375.72 rows=22347481 width=24) (actual time=464743.940..510053.349 rows=29345747 loops=1)
                           ->  Merge Join  (cost=4824730.82..9407688.70 rows=22347481 width=24) (actual time=72932.785..346289.410 rows=74723950 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21122.619..28705.572 rows=7576110 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 788492kB
                                       ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=1786.800..11376.377 rows=7576110 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=1747.142..1747.142 rows=7576110 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=51810.110..137709.182 rows=79665649 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  external sort  Disk: 346200kB
                                       ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=3840.465..17072.644 rows=10416305 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=3777.193..3777.193 rows=10416305 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=643.899..643.899 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.307..572.804 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.265..155.697 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.207..0.319 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.051..57.513 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=823.077..823.077 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=253.940..750.460 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=129.232..477.410 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=127.343..127.343 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.656..124.656 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.019..62.902 rows=48661 loops=1)
 Total runtime: 568263.871 ms
(45 rows)

Time: 568367.122 ms
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=10347027.27..10348699.37 rows=133768 width=53) (actual time=570305.182..570361.462 rows=17651 loops=1)
   ->  Sort  (cost=10347027.27..10347361.69 rows=133768 width=53) (actual time=570305.178..570323.699 rows=17651 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  quicksort  Memory: 3247kB
         ->  Hash Join  (cost=9800871.61..10335637.35 rows=133768 width=53) (actual time=464787.555..570238.767 rows=17651 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  Hash Join  (cost=9785003.65..10317094.03 rows=133768 width=39) (actual time=464225.409..569044.550 rows=301900 loops=1)
                     Hash Cond: (l2.subjectid = a2_.id)
                     ->  HashAggregate  (cost=9742900.91..9966375.72 rows=22347481 width=24) (actual time=463579.927..510844.446 rows=29345747 loops=1)
                           ->  Merge Join  (cost=4824730.82..9407688.70 rows=22347481 width=24) (actual time=70307.163..344386.548 rows=74723950 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21126.426..28639.498 rows=7576110 loops=1)
                                       Sort Key: l1.objectid, l1.bin
                                       Sort Method:  quicksort  Memory: 788492kB
                                       ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=1791.470..11439.997 rows=7576110 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=1750.960..1750.960 rows=7576110 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                 ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=49180.680..135037.099 rows=79665649 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  external sort  Disk: 346200kB
                                       ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=3812.683..17175.546 rows=10416305 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=3749.620..3749.620 rows=10416305 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=645.319..645.319 rows=48827 loops=1)
                           ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.307..574.226 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.263..156.557 rows=48827 loops=1)
                                       ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.203..0.323 rows=1 loops=1)
                                             Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                       ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..57.872 rows=48827 loops=1)
                                             Index Cond: (indirect1.datasets = a3_.id)
                                 ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                       Index Cond: (a2_.id = indirect1.bioentities)
               ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=548.841..548.841 rows=47985 loops=1)
                     ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=140.552..481.547 rows=47985 loops=1)
                           Hash Cond: (a1_.geneid = a4_.id)
                           ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.620..215.950 rows=47985 loops=1)
                                 Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                 ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=13.748..13.748 rows=95970 loops=1)
                                       Index Cond: (lower(distance) = '2.0kb'::text)
                           ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.883..124.883 rows=48661 loops=1)
                                 ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.017..62.950 rows=48661 loops=1)
 Total runtime: 571194.297 ms
(45 rows)

Time: 571308.971 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10344978.22..10344979.47 rows=500 width=53) (actual time=569716.264..569717.707 rows=500 loops=1)
   ->  Sort  (cost=10344978.22..10345312.64 rows=133768 width=53) (actual time=569716.260..569716.752 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=10336975.03..10338312.71 rows=133768 width=53) (actual time=569667.953..569690.525 rows=17651 loops=1)
               ->  Hash Join  (cost=9800871.61..10335637.35 rows=133768 width=53) (actual time=464462.144..569598.935 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=9785003.65..10317094.03 rows=133768 width=39) (actual time=463900.985..568403.056 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=9742900.91..9966375.72 rows=22347481 width=24) (actual time=463256.734..510339.153 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=4824730.82..9407688.70 rows=22347481 width=24) (actual time=70487.310..343631.714 rows=74723950 loops=1)
                                       Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21145.618..28699.989 rows=7576110 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 788492kB
                                             ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=1791.912..11409.994 rows=7576110 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=1751.336..1751.336 rows=7576110 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                       ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=49341.635..135095.821 rows=79665649 loops=1)
                                             Sort Key: l2.objectid, l2.bin
                                             Sort Method:  external sort  Disk: 346200kB
                                             ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=3808.958..17080.269 rows=10416305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=3746.738..3746.738 rows=10416305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=644.093..644.093 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.331..572.966 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.287..156.946 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.228..0.344 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..58.994 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=547.822..547.822 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=141.829..480.242 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=16.014..215.300 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=14.164..14.164 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.727..125.727 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..63.031 rows=48661 loops=1)
 Total runtime: 570548.099 ms
(46 rows)

Time: 570663.257 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10344978.22..10344979.47 rows=500 width=53) (actual time=569522.215..569523.664 rows=500 loops=1)
   ->  Sort  (cost=10344978.22..10345312.64 rows=133768 width=53) (actual time=569522.210..569522.705 rows=500 loops=1)
         Sort Key: a4_.primaryidentifier, a2_.secondaryidentifier, a2_.id, a4_.id
         Sort Method:  top-N heapsort  Memory: 94kB
         ->  HashAggregate  (cost=10336975.03..10338312.71 rows=133768 width=53) (actual time=569473.654..569496.480 rows=17651 loops=1)
               ->  Hash Join  (cost=9800871.61..10335637.35 rows=133768 width=53) (actual time=464514.328..569405.929 rows=17651 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  Hash Join  (cost=9785003.65..10317094.03 rows=133768 width=39) (actual time=463955.240..568212.332 rows=301900 loops=1)
                           Hash Cond: (l2.subjectid = a2_.id)
                           ->  HashAggregate  (cost=9742900.91..9966375.72 rows=22347481 width=24) (actual time=463306.305..510189.007 rows=29345747 loops=1)
                                 ->  Merge Join  (cost=4824730.82..9407688.70 rows=22347481 width=24) (actual time=70372.025..343495.577 rows=74723950 loops=1)
                                       Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                       Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                       ->  Sort  (cost=2179565.16..2198762.80 rows=7679054 width=20) (actual time=21080.718..28618.535 rows=7576110 loops=1)
                                             Sort Key: l1.objectid, l1.bin
                                             Sort Method:  quicksort  Memory: 788492kB
                                             ->  Bitmap Heap Scan on locationbin250 l1  (cost=174376.28..1301369.46 rows=7679054 width=20) (actual time=1790.683..11349.651 rows=7576110 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..172456.52 rows=7679054 width=0) (actual time=1750.252..1750.252 rows=7576110 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.GeneFlankingRegion'::text)
                                       ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=49291.250..135096.016 rows=79665649 loops=1)
                                             Sort Key: l2.objectid, l2.bin
                                             Sort Method:  external sort  Disk: 346200kB
                                             ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=3806.888..17030.800 rows=10416305 loops=1)
                                                   Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                                   ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=3744.755..3744.755 rows=10416305 loops=1)
                                                         Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                           ->  Hash  (cost=41801.57..41801.57 rows=24094 width=39) (actual time=648.771..648.771 rows=48827 loops=1)
                                 ->  Nested Loop  (cost=0.00..41801.57 rows=24094 width=39) (actual time=0.311..577.335 rows=48827 loops=1)
                                       ->  Nested Loop  (cost=0.00..21594.87 rows=37505 width=4) (actual time=0.268..158.311 rows=48827 loops=1)
                                             ->  Seq Scan on dataset a3_  (cost=0.00..23.93 rows=1 width=4) (actual time=0.208..0.325 rows=1 loops=1)
                                                   Filter: (lower(title) ~~ 'dm_s2rp_totalrna_p200_020-022-024_38bp'::text)
                                             ->  Index Scan using bioentitiesdatasets__datasets on bioentitiesdatasets indirect1  (cost=0.00..21102.12 rows=37505 width=8) (actual time=0.052..58.948 rows=48827 loops=1)
                                                   Index Cond: (indirect1.datasets = a3_.id)
                                       ->  Index Scan using transcriptregion_pkey on transcriptregion a2_  (cost=0.00..0.53 rows=1 width=35) (actual time=0.003..0.004 rows=1 loops=48827)
                                             Index Cond: (a2_.id = indirect1.bioentities)
                     ->  Hash  (cost=15269.67..15269.67 rows=47863 width=22) (actual time=545.713..545.713 rows=47985 loops=1)
                           ->  Hash Join  (cost=3225.65..15269.67 rows=47863 width=22) (actual time=141.277..478.514 rows=47985 loops=1)
                                 Hash Cond: (a1_.geneid = a4_.id)
                                 ->  Bitmap Heap Scan on geneflankingregion a1_  (cost=1259.78..12346.54 rows=47863 width=8) (actual time=15.956..213.870 rows=47985 loops=1)
                                       Filter: ((lower(distance) ~~ '2.0kb'::text) AND (lower(direction) ~~ 'upstream'::text))
                                       ->  Bitmap Index Scan on geneflankingregion__distance_like  (cost=0.00..1247.81 rows=95938 width=0) (actual time=14.122..14.122 rows=95970 loops=1)
                                             Index Cond: (lower(distance) = '2.0kb'::text)
                                 ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=125.232..125.232 rows=48661 loops=1)
                                       ->  Seq Scan on gene a4_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.031..62.790 rows=48661 loops=1)
 Total runtime: 570341.398 ms
(46 rows)

Time: 570456.992 ms
                                                                                 QUERY PLAN                                                                                  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1660967.73..1661024.57 rows=22737 width=4) (actual time=1570.622..1570.747 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=1574753.53..1659322.39 rows=22737 width=4) (actual time=254.790..1570.414 rows=118 loops=1)
         ->  HashAggregate  (cost=1574753.53..1574980.90 rows=22737 width=24) (actual time=194.119..194.402 rows=120 loops=1)
               ->  Nested Loop  (cost=23.44..1574412.47 rows=22737 width=24) (actual time=70.068..190.606 rows=2494 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin250__subjectid on locationbin250 l1  (cost=0.00..624.67 rows=929 width=20) (actual time=32.275..32.304 rows=15 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin250 l2  (cost=23.44..1667.37 rows=1335 width=20) (actual time=0.833..9.289 rows=943 loops=15)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin250__bin  (cost=0.00..23.10 rows=1335 width=0) (actual time=0.118..0.118 rows=943 loops=15)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..3.69 rows=1 width=4) (actual time=11.430..11.462 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 1571.028 ms
(16 rows)

Time: 1616.244 ms
                                                                                QUERY PLAN                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1660967.73..1661024.57 rows=22737 width=4) (actual time=41.507..41.621 rows=118 loops=1)
   Sort Key: a1_.id
   Sort Method:  quicksort  Memory: 30kB
   ->  Nested Loop  (cost=1574753.53..1659322.39 rows=22737 width=4) (actual time=39.856..41.329 rows=118 loops=1)
         ->  HashAggregate  (cost=1574753.53..1574980.90 rows=22737 width=24) (actual time=39.841..40.076 rows=120 loops=1)
               ->  Nested Loop  (cost=23.44..1574412.47 rows=22737 width=24) (actual time=0.203..36.293 rows=2494 loops=1)
                     Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                     ->  Index Scan using locationbin250__subjectid on locationbin250 l1  (cost=0.00..624.67 rows=929 width=20) (actual time=0.014..0.035 rows=15 loops=1)
                           Index Cond: (232042548 = subjectid)
                     ->  Bitmap Heap Scan on locationbin250 l2  (cost=23.44..1667.37 rows=1335 width=20) (actual time=0.102..1.154 rows=943 loops=15)
                           Recheck Cond: (l2.bin = l1.bin)
                           ->  Bitmap Index Scan on locationbin250__bin  (cost=0.00..23.10 rows=1335 width=0) (actual time=0.092..0.092 rows=943 loops=15)
                                 Index Cond: (l2.bin = l1.bin)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..3.69 rows=1 width=4) (actual time=0.005..0.006 rows=1 loops=120)
               Index Cond: (a1_.id = l2.subjectid)
 Total runtime: 41.892 ms
(16 rows)

Time: 43.068 ms
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1576853.60..1584580.14 rows=500 width=4) (actual time=48.690..20216.298 rows=118 loops=1)
   ->  Merge Join  (cost=1576853.60..1928210.05 rows=22737 width=4) (actual time=48.687..20215.989 rows=118 loops=1)
         Merge Cond: (a1_.id = l.lid2)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..335098.61 rows=6366713 width=4) (actual time=5.073..13669.483 rows=5971604 loops=1)
         ->  Sort  (cost=1576853.60..1576910.45 rows=22737 width=4) (actual time=40.493..40.736 rows=120 loops=1)
               Sort Key: l.lid2
               Sort Method:  quicksort  Memory: 30kB
               ->  Subquery Scan l  (cost=1574753.53..1575208.27 rows=22737 width=4) (actual time=39.866..40.324 rows=120 loops=1)
                     ->  HashAggregate  (cost=1574753.53..1574980.90 rows=22737 width=24) (actual time=39.864..40.095 rows=120 loops=1)
                           ->  Nested Loop  (cost=23.44..1574412.47 rows=22737 width=24) (actual time=0.201..36.426 rows=2494 loops=1)
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                                 ->  Index Scan using locationbin250__subjectid on locationbin250 l1  (cost=0.00..624.67 rows=929 width=20) (actual time=0.014..0.036 rows=15 loops=1)
                                       Index Cond: (232042548 = subjectid)
                                 ->  Bitmap Heap Scan on locationbin250 l2  (cost=23.44..1667.37 rows=1335 width=20) (actual time=0.103..1.140 rows=943 loops=15)
                                       Recheck Cond: (l2.bin = l1.bin)
                                       ->  Bitmap Index Scan on locationbin250__bin  (cost=0.00..23.10 rows=1335 width=0) (actual time=0.093..0.093 rows=943 loops=15)
                                             Index Cond: (l2.bin = l1.bin)
 Total runtime: 20216.674 ms
(18 rows)

Time: 20217.925 ms
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1576853.60..1584580.14 rows=500 width=4) (actual time=43.112..14442.759 rows=118 loops=1)
   ->  Merge Join  (cost=1576853.60..1928210.05 rows=22737 width=4) (actual time=43.110..14442.456 rows=118 loops=1)
         Merge Cond: (a1_.id = l.lid2)
         ->  Index Scan using locatedsequencefeature_pkey on locatedsequencefeature a1_  (cost=0.00..335098.61 rows=6366713 width=4) (actual time=0.048..7899.325 rows=5971604 loops=1)
         ->  Sort  (cost=1576853.60..1576910.45 rows=22737 width=4) (actual time=42.994..43.169 rows=120 loops=1)
               Sort Key: l.lid2
               Sort Method:  quicksort  Memory: 30kB
               ->  Subquery Scan l  (cost=1574753.53..1575208.27 rows=22737 width=4) (actual time=42.357..42.831 rows=120 loops=1)
                     ->  HashAggregate  (cost=1574753.53..1574980.90 rows=22737 width=24) (actual time=42.354..42.596 rows=120 loops=1)
                           ->  Nested Loop  (cost=23.44..1574412.47 rows=22737 width=24) (actual time=0.375..38.901 rows=2494 loops=1)
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end) AND (l1.objectid = l2.objectid))
                                 ->  Index Scan using locationbin250__subjectid on locationbin250 l1  (cost=0.00..624.67 rows=929 width=20) (actual time=0.048..0.070 rows=15 loops=1)
                                       Index Cond: (232042548 = subjectid)
                                 ->  Bitmap Heap Scan on locationbin250 l2  (cost=23.44..1667.37 rows=1335 width=20) (actual time=0.127..1.299 rows=943 loops=15)
                                       Recheck Cond: (l2.bin = l1.bin)
                                       ->  Bitmap Index Scan on locationbin250__bin  (cost=0.00..23.10 rows=1335 width=0) (actual time=0.115..0.115 rows=943 loops=15)
                                             Index Cond: (l2.bin = l1.bin)
 Total runtime: 14443.089 ms
(18 rows)

Time: 14444.390 ms
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1602478.73..1603034.76 rows=222414 width=46) (actual time=13072.168..13209.242 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=1569380.31..1582725.15 rows=222414 width=46) (actual time=11746.473..12645.426 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=1565052.36..1573948.92 rows=222414 width=22) (actual time=11479.699..12009.956 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=1563086.49..1565310.63 rows=222414 width=24) (actual time=11355.665..11529.842 rows=129835 loops=1)
                     ->  Merge Join  (cost=1058704.09..1559750.28 rows=222414 width=24) (actual time=5312.637..10101.428 rows=889170 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=0.071..464.491 rows=346082 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=1058704.09..1061877.13 rows=1269215 width=20) (actual time=5312.530..6673.815 rows=1369526 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 151539kB
                                 ->  Bitmap Heap Scan on locationbin250 l2  (cost=28702.27..930034.21 rows=1269215 width=20) (actual time=651.435..2288.800 rows=1310545 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..28384.97 rows=1269215 width=0) (actual time=647.182..647.182 rows=1310545 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=123.976..123.976 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.367 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=266.711..266.711 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.036..131.187 rows=103331 loops=1)
 Total runtime: 13350.149 ms
(25 rows)

Time: 13390.789 ms
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=1602478.73..1603034.76 rows=222414 width=46) (actual time=12754.133..12890.126 rows=129835 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 15320kB
   ->  Hash Join  (cost=1569380.31..1582725.15 rows=222414 width=46) (actual time=11428.802..12327.444 rows=129835 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=1565052.36..1573948.92 rows=222414 width=22) (actual time=11164.275..11694.055 rows=129835 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=1563086.49..1565310.63 rows=222414 width=24) (actual time=11040.100..11214.158 rows=129835 loops=1)
                     ->  Merge Join  (cost=1058704.09..1559750.28 rows=222414 width=24) (actual time=4989.679..9778.123 rows=889170 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=0.057..462.482 rows=346082 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                           ->  Sort  (cost=1058704.09..1061877.13 rows=1269215 width=20) (actual time=4989.584..6351.820 rows=1369526 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  quicksort  Memory: 151539kB
                                 ->  Bitmap Heap Scan on locationbin250 l2  (cost=28702.27..930034.21 rows=1269215 width=20) (actual time=324.438..1971.912 rows=1310545 loops=1)
                                       Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                       ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..28384.97 rows=1269215 width=0) (actual time=320.271..320.271 rows=1310545 loops=1)
                                             Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
               ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.119..124.119 rows=48661 loops=1)
                     ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.588 rows=48661 loops=1)
         ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=264.466..264.466 rows=103331 loops=1)
               ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.036..130.247 rows=103331 loops=1)
 Total runtime: 13031.754 ms
(25 rows)

Time: 13033.624 ms
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1593807.80..1593809.05 rows=500 width=46) (actual time=12553.357..12554.783 rows=500 loops=1)
   ->  Sort  (cost=1593807.80..1594363.84 rows=222414 width=46) (actual time=12553.344..12553.820 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=1569380.31..1582725.15 rows=222414 width=46) (actual time=11470.200..12370.295 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=1565052.36..1573948.92 rows=222414 width=22) (actual time=11204.891..11734.732 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=1563086.49..1565310.63 rows=222414 width=24) (actual time=11080.225..11253.999 rows=129835 loops=1)
                           ->  Merge Join  (cost=1058704.09..1559750.28 rows=222414 width=24) (actual time=5021.904..9846.044 rows=889170 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=0.060..473.398 rows=346082 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=1058704.09..1061877.13 rows=1269215 width=20) (actual time=5021.807..6391.790 rows=1369526 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 151539kB
                                       ->  Bitmap Heap Scan on locationbin250 l2  (cost=28702.27..930034.21 rows=1269215 width=20) (actual time=334.203..1999.827 rows=1310545 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..28384.97 rows=1269215 width=0) (actual time=330.032..330.032 rows=1310545 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.596..124.596 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.016..62.960 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=265.249..265.249 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.037..131.057 rows=103331 loops=1)
 Total runtime: 12573.336 ms
(26 rows)

Time: 12575.201 ms
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1593807.80..1593809.05 rows=500 width=46) (actual time=12525.295..12526.715 rows=500 loops=1)
   ->  Sort  (cost=1593807.80..1594363.84 rows=222414 width=46) (actual time=12525.291..12525.772 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 74kB
         ->  Hash Join  (cost=1569380.31..1582725.15 rows=222414 width=46) (actual time=11442.516..12342.554 rows=129835 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=1565052.36..1573948.92 rows=222414 width=22) (actual time=11178.595..11708.375 rows=129835 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=1563086.49..1565310.63 rows=222414 width=24) (actual time=11054.354..11227.676 rows=129835 loops=1)
                           ->  Merge Join  (cost=1058704.09..1559750.28 rows=222414 width=24) (actual time=5017.930..9817.233 rows=889170 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..452808.16 rows=639822 width=20) (actual time=0.061..470.621 rows=346082 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.Gene'::text)
                                 ->  Sort  (cost=1058704.09..1061877.13 rows=1269215 width=20) (actual time=5017.833..6384.300 rows=1369526 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  quicksort  Memory: 151539kB
                                       ->  Bitmap Heap Scan on locationbin250 l2  (cost=28702.27..930034.21 rows=1269215 width=20) (actual time=332.629..1994.874 rows=1310545 loops=1)
                                             Recheck Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..28384.97 rows=1269215 width=0) (actual time=328.427..328.427 rows=1310545 loops=1)
                                                   Index Cond: (subjecttype = ANY ('{org.intermine.model.bio.ProteinBindingSite,org.intermine.model.bio.HistoneBindingSite}'::text[]))
                     ->  Hash  (cost=1357.61..1357.61 rows=48661 width=18) (actual time=124.181..124.181 rows=48661 loops=1)
                           ->  Seq Scan on gene a1_  (cost=0.00..1357.61 rows=48661 width=18) (actual time=0.015..62.288 rows=48661 loops=1)
               ->  Hash  (cost=3036.31..3036.31 rows=103331 width=28) (actual time=263.860..263.860 rows=103331 loops=1)
                     ->  Seq Scan on proteinbindingsite a2_  (cost=0.00..3036.31 rows=103331 width=28) (actual time=0.039..130.008 rows=103331 loops=1)
 Total runtime: 12545.041 ms
(26 rows)

Time: 12546.906 ms
                                                                                             QUERY PLAN                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=3735302.15..3738726.23 rows=1369630 width=135) (actual time=103966.055..104867.106 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=3504962.20..3595700.19 rows=1369630 width=135) (actual time=92176.063..99090.568 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=3301465.73..3361387.04 rows=1369630 width=49) (actual time=80258.702..84112.039 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=3300009.67..3313705.97 rows=1369630 width=24) (actual time=80134.949..81422.667 rows=800907 loops=1)
                     ->  Merge Join  (cost=2645165.66..3279465.22 rows=1369630 width=24) (actual time=52479.897..77934.359 rows=1384935 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..354596.35 rows=470633 width=20) (actual time=30.621..694.930 rows=442714 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=52449.223..63778.636 rows=10417148 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  external sort  Disk: 346200kB
                                 ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=4444.119..17676.586 rows=10416305 loops=1)
                                       Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=4366.134..4366.134 rows=10416305 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=123.705..123.705 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=7.883..75.069 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11913.536..11913.536 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=3.398..5893.124 rows=4025132 loops=1)
 Total runtime: 105899.869 ms
(25 rows)

Time: 105992.066 ms
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=3735302.15..3738726.23 rows=1369630 width=135) (actual time=103188.579..104092.090 rows=800907 loops=1)
   Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
   Sort Method:  quicksort  Memory: 225860kB
   ->  Hash Join  (cost=3504962.20..3595700.19 rows=1369630 width=135) (actual time=91360.302..98291.803 rows=800907 loops=1)
         Hash Cond: (l2.subjectid = a2_.id)
         ->  Hash Join  (cost=3301465.73..3361387.04 rows=1369630 width=49) (actual time=80061.185..83926.689 rows=800907 loops=1)
               Hash Cond: (l1.subjectid = a1_.id)
               ->  HashAggregate  (cost=3300009.67..3313705.97 rows=1369630 width=24) (actual time=79966.632..81256.370 rows=800907 loops=1)
                     ->  Merge Join  (cost=2645165.66..3279465.22 rows=1369630 width=24) (actual time=52598.103..77771.076 rows=1384935 loops=1)
                           Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                           Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                           ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..354596.35 rows=470633 width=20) (actual time=0.056..630.955 rows=442714 loops=1)
                                 Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                           ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=52597.993..63699.545 rows=10417148 loops=1)
                                 Sort Key: l2.objectid, l2.bin
                                 Sort Method:  external sort  Disk: 346200kB
                                 ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=4573.533..18004.206 rows=10416305 loops=1)
                                       Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                       ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=4495.960..4495.960 rows=10416305 loops=1)
                                             Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
               ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=94.506..94.506 rows=35958 loops=1)
                     ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.017..46.289 rows=35958 loops=1)
         ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11295.076..11295.076 rows=4025132 loops=1)
               ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.037..5287.231 rows=4025132 loops=1)
 Total runtime: 105124.946 ms
(25 rows)

Time: 105212.630 ms
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3663947.37..3663948.62 rows=500 width=135) (actual time=99145.724..99147.161 rows=500 loops=1)
   ->  Sort  (cost=3663947.37..3667371.45 rows=1369630 width=135) (actual time=99145.721..99146.202 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=3504962.20..3595700.19 rows=1369630 width=135) (actual time=90980.387..97884.473 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=3301465.73..3361387.04 rows=1369630 width=49) (actual time=79735.376..83573.785 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=3300009.67..3313705.97 rows=1369630 width=24) (actual time=79640.075..80923.946 rows=800907 loops=1)
                           ->  Merge Join  (cost=2645165.66..3279465.22 rows=1369630 width=24) (actual time=52355.670..77496.882 rows=1384935 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..354596.35 rows=470633 width=20) (actual time=0.055..629.134 rows=442714 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=52355.561..63440.469 rows=10417148 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  external sort  Disk: 346200kB
                                       ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=4597.252..17819.890 rows=10416305 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=4519.168..4519.168 rows=10416305 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=95.255..95.255 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..46.394 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11240.984..11240.984 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.037..5249.319 rows=4025132 loops=1)
 Total runtime: 99390.014 ms
(26 rows)

Time: 99477.433 ms
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3663947.37..3663948.62 rows=500 width=135) (actual time=99266.879..99268.307 rows=500 loops=1)
   ->  Sort  (cost=3663947.37..3667371.45 rows=1369630 width=135) (actual time=99266.875..99267.354 rows=500 loops=1)
         Sort Key: a1_.primaryidentifier, a2_.primaryidentifier, a1_.id, a2_.id
         Sort Method:  top-N heapsort  Memory: 150kB
         ->  Hash Join  (cost=3504962.20..3595700.19 rows=1369630 width=135) (actual time=91102.622..98006.609 rows=800907 loops=1)
               Hash Cond: (l2.subjectid = a2_.id)
               ->  Hash Join  (cost=3301465.73..3361387.04 rows=1369630 width=49) (actual time=79853.259..83692.014 rows=800907 loops=1)
                     Hash Cond: (l1.subjectid = a1_.id)
                     ->  HashAggregate  (cost=3300009.67..3313705.97 rows=1369630 width=24) (actual time=79759.051..81043.307 rows=800907 loops=1)
                           ->  Merge Join  (cost=2645165.66..3279465.22 rows=1369630 width=24) (actual time=52463.331..77619.394 rows=1384935 loops=1)
                                 Merge Cond: ((l1.objectid = l2.objectid) AND (l1.bin = l2.bin))
                                 Join Filter: ((l1.intermine_start <= l2.intermine_end) AND (l2.intermine_start <= l1.intermine_end))
                                 ->  Index Scan using locationbin250__subjectobjectbin on locationbin250 l1  (cost=0.00..354596.35 rows=470633 width=20) (actual time=0.054..630.561 rows=442714 loops=1)
                                       Index Cond: (subjecttype = 'org.intermine.model.bio.IntergenicRegion'::text)
                                 ->  Sort  (cost=2645165.66..2671729.59 rows=10625571 width=20) (actual time=52463.225..63557.731 rows=10417148 loops=1)
                                       Sort Key: l2.objectid, l2.bin
                                       Sort Method:  external sort  Disk: 346200kB
                                       ->  Bitmap Heap Scan on locationbin250 l2  (cost=241281.79..1405106.43 rows=10625571 width=20) (actual time=4597.778..17875.071 rows=10416305 loops=1)
                                             Recheck Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                                             ->  Bitmap Index Scan on locationbin250__subjecttypeid  (cost=0.00..238625.40 rows=10625571 width=0) (actual time=4520.088..4520.088 rows=10416305 loops=1)
                                                   Index Cond: (subjecttype = 'org.intermine.model.bio.TranscriptRegion'::text)
                     ->  Hash  (cost=1006.58..1006.58 rows=35958 width=45) (actual time=94.154..94.154 rows=35958 loops=1)
                           ->  Seq Scan on intergenicregion a1_  (cost=0.00..1006.58 rows=35958 width=45) (actual time=0.018..46.072 rows=35958 loops=1)
               ->  Hash  (cost=153182.32..153182.32 rows=4025132 width=90) (actual time=11245.380..11245.380 rows=4025132 loops=1)
                     ->  Seq Scan on transcriptregion a2_  (cost=0.00..153182.32 rows=4025132 width=90) (actual time=0.038..5248.003 rows=4025132 loops=1)
 Total runtime: 99511.024 ms
(26 rows)

Time: 99598.739 ms
