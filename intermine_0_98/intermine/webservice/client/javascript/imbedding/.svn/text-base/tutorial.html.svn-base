<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>InterMine Embedding Tutorial</title>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
        <!-- These are the three required libraries -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"
            type="text/javascript"></script>
        <script src="http://jquery-jsonp.googlecode.com/files/jquery.jsonp-2.1.4.min.js" type="text/javascript"></script>
        <!-- <script src="http://intermine.org/lib/imbedding/0.1/imbedding.min.js" type="text/javascript"></script> -->
        <script src="src/imbedding.js" type="text/javascript"></script>

        <!-- The graphing library -->
        <!--[if IE]><script language="javascript" type="text/javascript" src="lib/flot/excanvas.min.js"></script><![endif]-->
        <script language="javascript" type="text/javascript" src="lib/flot/jquery.flot.js"></script>
        <script language="javascript" type="text/javascript" src="lib/flot/jquery.flot.stack.js"></script>

        <!-- The syntax highlighting library -->
        <script src="lib/jquery-syntax/jquery.syntax.js" type="text/javascript"></script>
        <link rel="stylesheet" type="text/css" href="lib/jquery-syntax/jquery.syntax.layout.list.css">
        <link rel="stylesheet" type="text/css" href="lib/jquery-syntax/jquery.syntax.core.css">

        <!-- The ui library -->
        <script src="lib/jquery-ui-1.8.9.custom.min.js" type="text/javascript"></script>
        <link rel="stylesheet" type="text/css" href="lib/css/flick/jquery-ui-1.8.9.custom.css">

        <!-- javascript for this page -->
        <script src="lib/tutorial.js" type="text/javascript"></script>

        <!-- Grab fonts from Google -->
        <link href='http://fonts.googleapis.com/css?family=Vollkorn' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Cuprum' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Neuton' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'>

        <!-- The three publically hosted table styles -->
        <link rel="alternate stylesheet" type="text/css" title="dark" href="style/dark.css">
        <link rel="alternate stylesheet" type="text/css" title="light" href="style/light.css">
        <link rel="stylesheet" type="text/css" title="bold" href="style/bold.css">

        <!-- style for this page -->
        <link rel="stylesheet" type="text/css" href="style/tutorial.css">
    </head>
    <body>
        <div id="page">
        <h1 style="text-align: center;" >InterMine Ajax Embedding Tutorial</h1>
    <div id="dialog-confirm" title="Delete the current query?">
        <p>
        <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
        Changing the root class will clear your current query - are you sure?
        </p>
    </div>

<div id="tabs">
    <ul>
        <li><a href="#tabs-1">The Basics</a></li>
        <li><a href="#tabs-6">Customisation</a></li>
        <li><a href="#tabs-3">Templates</a></li>
        <li><a href="#tabs-2">Arbitrary Queries</a></li>
        <li><a href="#tabs-4">Doing Other Things with Results</a></li>
        <li><a href="#tabs-7">Styling Tables</a></li>
        <li><a href="#tabs-5">Resources</a></li>
    </ul>


    <div id="tabs-1">
        <h2>The basics</h2>
        <p>
        You can now embed results from InterMine queries directly into your own web pages.
        All you need for this is a little knowledge of javascript - and there is a 
        JavaScript client library available so you really do need only a little. If you 
        want to do more, the techniques shown here are flexible and powerful enough
        to present information in any way you choose.
        </p>
        <h2>Example</h2>
        <p>
        Below you can see a table with results from the FlyMine preview site. On page
        ready the table structure was loaded in and the mine was queried for the count.
        The default behaviour is for results to be loaded into tables with only the title and 
        count showing. Clicking the table will expand it, causing it to fetch data rows
        from the mine and insert them into itself, allowing you to see its contents. 
        </p>
        <div id="placeholder1"><p>This will be where the table goes</p></div>
        <p>
        As you can see, you do not need a lot of code to get this effect:
        <p>
        <textarea rows="20" cols="80" class="coder html-snippet">&lt;div id="some-placeholder"&gt;&lt;/div&gt;
&lt;script type="text/javascript"&gt;
    IMBedding.setBaseUrl("http://preview.flymine.org/preview");
    IMBedding.loadTemplate(
        {
            name:           "Gene_RegionOverlappingTFbindingsite",

            constraint1:    "Gene",
            op1:            "LOOKUP",
            value1:         "CG2328",
            code1:          "A",
        },            
        '#some-placeholder',
    );
&lt;/script&gt;</textarea>
            <p>
            Go <a href="demo.html" target="_blank" >here</a> to see a very simple demo of 
            the techniques shown on this page.
            <p>
            <input type="checkbox" id="demoSourceCB" onclick="$('#demo').slideToggle();"><label for="demoSourceCB">View The Source For a Complete Working Example</label>

        <div id="demo" style="display: none;">
            <textarea rows="20" cols="80" class="coder html-snippet">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;

&lt;head&gt;
    &lt;title&gt;A Minimal Example Page&lt;/title&gt;
    &lt;meta http-equiv="content-type" content="text/html;charset=utf-8" /&gt;
    &lt;!-- jQuery is hosted by Google --&gt;
    &lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" 
        type="text/javascript"&gt;
    &lt;/script&gt;
    &lt;!-- jquery-jsonp is likewise available from an online repository --&gt;
    &lt;script src="http://jquery-jsonp.googlecode.com/files/jquery.jsonp-2.1.4.min.js" 
        type="text/javascript"&gt;
    &lt;/script&gt;
    &lt;!-- InterMine similarly hosts imbedding --&gt;
    &lt;script src="http://intermine.org/lib/imbedding/0.1/imbedding.min.js" 
        type="text/javascript"&gt;
    &lt;/script&gt;
    &lt;link rel="stylesheet" type="text/css" 
        href="http://intermine.org/lib/imbedding/0.1/style/light.css" /&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;div id="placeholder"&gt;&lt;/div&gt;
&lt;/body&gt;

&lt;script type="text/javascript"&gt;
    IMBedding.setBaseUrl("http://squirrel.flymine.org/intermine-test");
    IMBedding.loadTemplate(
        {
            name:           "ManagerLookup",
            size:           10,
        
            constraint1:    "Manager",
            op1:            "LOOKUP",
            value1:         "*",
            code1:          "A"
        },
        '#placeholder'
    );
&lt;/script&gt;

&lt;/html&gt;</textarea>
</div>
        <h2 id="boilerplate">How To Set This Up</h2>
        <p>
        We have tried to keep the boilerplate you need to put into your code to a minimum, but
        there are a few things you need:
        <ul>
            <li class="resource"><h3>Some javascript libraries.</h3>
            <p>
            To use the InterMine Embedding library (imbedding.js), you will need to <a 
            href="#boilerplate" onclick="$('#librariesHead').slideToggle();">include</a>
            the following scripts into your page: 
            <a href="www.jquery.com">jQuery</a>,
            <a href="http://code.google.com/p/jquery-jsonp/">jQuery-JSONP</a> and 
            <a href="http://intermine.org/lib/imbedding/">imbedding.js library</a>.
            </p>
            <div id="librariesHead" style="display: none;">
                <p>
                You do not need to download them, just add the following lines to the 
                head of the page:
                </p>
                <textarea rows="20" cols="80" class="coder html-snippet">
                    &lt;head&gt;
    &lt;!-- jQuery is hosted by Google --&gt;
    &lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" 
        type="text/javascript"&gt;
    &lt;/script&gt;
    &lt;!-- jquery-jsonp is likewise available from an online repository --&gt;
    &lt;script src="http://jquery-jsonp.googlecode.com/files/jquery.jsonp-2.1.4.min.js" 
        type="text/javascript"&gt;
    &lt;/script&gt;
    &lt;!-- Similarly imbedding.js is hosted on intermine.org --&gt;
    &lt;script src="http://www.intermine.org/lib/imbedding/0.1/imbedding.min.js" 
        type="text/javascript"&gt;
    &lt;/script&gt;
&lt;/head&gt;
                </textarea>
            </div>
            </li>
            <li class="resource"><h3>Some css styles</h3>
            <p>
            To style the tables, you will also need to include some css with the <a 
            href="#boilerplate" onclick="$('#classlist').slideToggle();">appropriate classes.</a>
            <div id="classlist" style="display: none;">
            <span class="normal-color">Classes you can style in an embedded table:</span>
            <ul>
                <li class="resource">.imbedded-table-container: <span class="normal-color">The outer container that holds the table</span></li>
                <li class="resource">.imbedded-table-titlebox: <span class="normal-color">The box that holds the title and count</span></li>
                <li class="resource">.imbedded-table-title: <span class="normal-color">The text with the actual title</span></li>
                <li class="resource">.imbedded-table: <span class="normal-color">The table element</span></li>
                <li class="resource">.imbedded-column-header-row: <span class="normal-color">The row with the column headings</span></li>
                <li class="resource">.imbedded-column-data-row: <span class="normal-color">The rows with the data</span></li>
                <li class="resource">.imbedded-cell: <span class="normal-color">Each cell of the table</span></li>
                <li class="resource">.imbedded-row-odd: <span class="normal-color">Odd numbered table rows</span></li>
                <li class="resource">.imbedded-row-even: <span class="normal-color">Even numbered table rows</span></li>
                <li class="resource">.imbedded-column-odd: <span class="normal-color">Odd numbered table columns</span></li>
                <li class="resource">.imbedded-column-even: <span class="normal-color">Even numbered table columns</span></li>
                <li class="resource">.imbedded-exportlink: <span class="normal-color">The CSV and TSV export links</span></li>
                <li class="resource">.imbedded-pagelink: <span class="normal-color">The previous/next/more/all paging links</span></li>
                <li class="resource">.imbedded-mineresultslink: <span class="normal-color">The link to the results in the originating mine</span></li>
                <li class="resource">.imbedded-prev: <span class="normal-color">The previous paging link</span></li>
                <li class="resource">.imbedded-next: <span class="normal-color">The next paging link</span></li>
                <li class="resource">.imbedded-table-tooltip: <span class="normal-color">The tooltip that contains the template description</span></li>
                <li class="resource">.imbedded-table-expand-help: <span class="normal-color">The link that says "show/hide table"</span></li>
                <li class="resource">.imbedded-null: <span class="normal-color">Cells that have no value</span></li>
            </ul>
            <p>
            There are some stylesheets available (all the ones used on this page) via the 
            web-hosting interface as well.
            </p>
            <textarea rows="20" cols="80" class="coder html-snippet">
&lt;head&gt;
    &lt;!-- You are welcome to fetch these styles from the intermine host --&gt;
    &lt;link rel="stylesheet" href="http://www.intermine.org/lib/imbedding/0.1/style/bold.css" /&gt;
&lt;/head&gt;
            </textarea>
            <p>
            Go <a href="http://www.intermine.org/lib/imbedding/0.1/style/bold.css" target="_blank">here</a> to see an example of a stylesheet
            <p>
            </div>
            </li>
            <li class="resource"><h3>A placeholder (or several) on the page</h3>
            <p>
            You will need to include <a href="#boilerplate" onclick="$('#placeholder-snippet').slideToggle();">an element</a> to tell the table where to go.
            </p>
            <div id="placeholder-snippet" style="display: none;">
            <textarea rows="20" cols="80" class="coder html-snippet">
&lt;body&gt;
    &lt;div id="placeholder"&gt;The content of this div will be replaced by the table&lt;/div&gt;
&lt;/body&gt;
            </textarea>
            <p>
            Using placeholders means you can be precise about where you want your tables to
            appear on the page, and have as many of them as you want, without interference
            between them.
            </p><p>
            Placeholders also mean graceful fallback - simply supply alternative fallback
            material within the placeholder element: it will be overwritten when the table goes
            in.
            </p>
            <button id="positionExButton">Replace the placeholder element below with a table</button>

            <div id="positionExample">
                <div style="border: solid 3px #0073EA;">
                <p>
                <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>
                Terribly sorry there is no pretty table to see here. Maybe you
                don't have JavaScript enabled? No worries, just go through to
                <a href="http://www.flymine.org">FlyMine</a> for all the data you can eat
                </p>
                </div>
            </div>
        </div>
            <li class="resource"><h3>A Script to load the table in</h3>
            <p>
            You can either write your own separate library of functions and include it in your 
            head, or you can insert <a href="#boilerplate" 
            onclick="$('#scriptElem').slideToggle();">a script element</a> directly into the page:
            </p>
            <div id="scriptElem" style="display: none;">
                <textarea rows="20" cols="80" class="coder html-snippet">&lt;script type="text/javascript"&gt;
    IMBedding.setBaseUrl("http://squirrel.flymine.org/intermine-test");
    IMBedding.loadTemplate(
        {
            name:           "ManagerLookup",
            size:           10,
        
            constraint1:    "Manager",
            op1:            "LOOKUP",
            value1:         "*",
            code1:          "A",
        },
        '#placeholder1'
    );
&lt;/script&gt;
</textarea>
</div>
            </li>
        </ul>

    </div>

    <div id="tabs-2">
        <h2>Loading an Arbitrary Query</h2>
        <p>
        This tool is designed to help you write javascript functions for your pages
        by generating the code for you. You can paste in xml, experiment with 
        JSON, or build a query from scratch. You can then see the generated code, 
        and cut and paste it into your own page.
        </p>
        <p> 
        Queries can be passed to the loading function as either an xml text string,
        or as a json object. The loading module must be prepared with the base url
        before-hand in either case. 
        </p><p>
        You can either define your query using the form below, 
        or simply paste in some XML/JSON. When you press <em>"Load Query"</em>
        the results will be loaded, and the corresponding code will be generated
        for you to cut and paste into your own page (just click on the 
        <em>"Show the code"</em> button.)
        </p>
        <input type="checkbox" id="formatDetailsCB" onclick="$('#formatDetails').slideToggle('fast', function(){});"><label for="formatDetailsCB">see information about the formats</label>
        <div id="query-radios" style="display: inline; float: right;">
            <input class="querier" type="radio" value="querybuilder" id="querybuilder-opt" name="query"><label for="querybuilder-opt">Build A Query</label>
            <input class="querier" type="radio" checked="checked" value="cutandpaste" id="cutandpaste-opt" name="query"><label for="cutandpaste-opt">Paste in some XML/JSON</label>
        </div>
        <div id="formatDetails" style="display: none;">
            <p>
            Your query is ultimately passed to the mine as xml, which has a 
            well defined format. We have information available on <a 
            href="http://www.intermine.org/wiki/QueryXmlFormat">the xml format</a>,
            in addition to a 
            <a href="http://www.intermine.org/browser/trunk/intermine/webapp/main/resources/webapp/webservice/query.xsd">formal definition</a>.
            </p><p>
            The json object format is basically the same, except that its 
            view is expected to be an array and it has arrays of <code>joins</code> 
            and <code>constraints</code> in the place of the repeated 
            <code>join</code> and <code>constraint</code> xml tags. Also: 
            it accepts <code>from</code> as a synonym for <code>model</code>, 
            <code>where</code> as a synonym for <code>constraints</code>, 
            and <code>select</code> as a synonym for <code>view</code> 
            (as in the example below). The json object format will also correctly
            interpret <code>&lt;</code> and <code>&gt;</code> when used as operators,
            whereas the xml will have to be correctly formatted by hand.
            </p><p>
            Click <a href="http://intermine.org/wiki/WebService#a2.1Querywebservice">here</a> for 
            detailed information on the query webservice api.
            </p>
        </div>
        <div id="cutandpaste">
            <p>
            You can simply paste in xml or json into the appropriate box below, press
            load, and see the results, and the generating code for them.
            </p>
            <label for="boxselector">Use: </label>
            <select id="boxselector">
                <option value="xml" selected="selected">Use XML</option>
                <option value="json" >Use JSON</option>
            </select>
            <table>
                <tr>
                    <td>
                        <textarea class="coder" id="xmlarea" rows="15"  cols="60">
&lt;query name="" model="genomic" view="Gene.homologues.type Gene.homologues.gene.primaryIdentifier Gene.homologues.inParanoidScore Gene.homologues.homologue.primaryIdentifier Gene.homologues.homologue.organism.shortName" sortOrder="Gene.homologues.type asc"&gt;
  &lt;constraint path="Gene.primaryIdentifier" op="&amp;lt;" value="D"/&gt;
  &lt;constraint path="Gene.primaryIdentifier" op="&amp;gt;" value="C"/&gt;
&lt;/query&gt;</textarea>
                    </td>
                    <td>
                        <textarea style="display: none;" class="coder" id="jsonarea" rows="15" cols="60">
{
    select: [
        "Gene.homologues.type", 
        "Gene.homologues.gene.primaryIdentifier", 
        "Gene.homologues.inParanoidScore", 
        "Gene.homologues.homologue.primaryIdentifier", 
        "Gene.homologues.homologue.organism.shortName"
    ],
    where: [
        {path: "Gene.primaryIdentifier", op: "&lt;", value: "D"},
        {path: "Gene.primaryIdentifier", op: "&gt;", value: "C"}
    ]
}</textarea>
                    </td>
                </tr>
            </table>
        </div>
        <div class="option-box" id="querybuilder" style="display: none;">
            
    <form id="root-class-form" action="">
        <p><label for="root-class"><em>Construct a query for</em></label>
        <select id="root-class">
        </select></p>
    </form>
    <div class="option-box">
        <h3 class="querybuilder-section-header">Views</h3>
        <form id="views-form" action="">
            <table id="querybuilder-views">
            </table>
        </form>
        <button id="view-adder">Add a view</button>
        <span id="sortOrderDiv" style="display: none">
            <label for="sortOrderSelector">Sort by:</label>
            <select id="sortOrderSelector">
            </select>
            <span id="sortDirectionDiv">
                <input type="radio" name="sortDirection" value="ASC" id="sortASC"
                    checked="checked">
                <label for="sortASC">ascending</label>
                <input type="radio" name="sortDirection" value="DESC" id="sortDESC">
                <label for="sortDESC">descending</label>
            </span>
        </span>
    </div>
    <div class="option-box">
        <h3 class="querybuilder-section-header">Constraints</h3>
        <form id="constraints-form">
            <table id="querybuilder-constraints">
            </table>
        </form>
        <button id="constraint-adder">Add a constraint</button>
        <span id="logic-box" style="display: none">
            <label for="logic-text">Logic</label>
            <input type="text" placeholder="specify logic here" id="logic">
        </span>
    </div>
    <div class="option-box">
        <h3 class="querybuilder-section-header">Joins</h3>
        <form id="joins-form">
            <table id="querybuilder-joins">
            </table>
        </form>
        <button id="join-adder">Add a join</button>
    </div>
    </div>
    <button id="query-loader">Load Query</button>
    <input type="checkbox" id="showQueryCode"><label for="showQueryCode">View Generated Code</label>
    <div id="codeContainer" style="display: none">
    <div id="codeDisplay" class="ui-state-highlight ui-corner-all">
        <p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span><strong>Patience please</strong> - there isn't any code to display just yet. Just load a query and the corresponding code will be generated and displayed in this box</p>
    </div>
    </div>
    <form>
        <div class="styles" style="float: right;">
            <input class="styler" type="radio" value="bold" id="bold-q" name="style"checked="true"/>
                <label for="bold-q">Bold</label>
            <input class="styler" type="radio" value="dark" id="dark-q" name="style" />
                <label for="dark-q">Dark</label>
            <input class="styler" type="radio" value="light" id="light-q" name="style"/>
                <label for="light-q">Light</label>
        </div>
    </form>
    <div id="placeholder2"><p>The query defined above will go here</p></div>
    </div>

    <div id="tabs-3">
        <h2>Loading a Template</h2>
        <p>
        This tool is designed to help you write javascript functions to load desired
        query results. It will generate code you can cut and paste into your web page
        to embed query results. Press <em>"Show Source"</em> to see the code generated 
        for each query.
        <p>
        Enter a template name to see the list of templates for this mine. 
        Selecting one will bring up a form for you to enter the values for 
        the parameters that this template expects. 
        </p>
        <input type="checkbox" id="templateDetailsCB" onclick="$('#templateDetails').slideToggle('fast', function(){});"/><label for="templateDetailsCB">see information about templates</label>
        <div id="templateDetails" style="display: none;">
            <p>
            Templates are predefined queries with a fixed number of parameters. 
            If you are familiar with BioMart, they are very similar in functionality 
            to BioMart queries, in that they expect certain parameters and always 
            return certain types of data. Each mine has a list of templates
            which are preconfigured and accessible to the public - you can always 
            write your own as well: for a tutorial on writing your own templates 
            from scratch see  <a href="http://intermine.org/wiki/TemplateTutorial">
            here</a>.
            </p><p>
            Click <a href="http://intermine.org/wiki/WebService#a2.2Templatewebservice">here</a> for 
            detailed information on the template webservice api.
            </p>
        </div>
        <div class="option-box">
            <form id="template-form">
                <p><label for="templateName">Template Name: </label>
                <input spellcheck="false" size="50" type="text" name="name" id="templateName" placeholder="Enter a template Name" /></p>
                <div id="templateSpecific"></div>
                <br/>
                <input type="button" name="loadTemplate" value="Load Template" onclick="loadUserTemplate()" />
                <input type="checkbox" id="showTemplateCode"/><label for="showTemplateCode">View Generated Code</label>
            </form>
            <div id="templateCodeContainer" style="display: none">
                <div id="templateCodeDisplay"  class="ui-state-highlight ui-corner-all">
    <p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span><strong>Patience please</strong> - there isn't any code to display just yet. Just load a query and the corresponding code will be generated and displayed in this box</p>
            </div>
            </div>
        </div>
    <form>
        <div class="styles" style="float: right;">
            <input class="styler" type="radio" value="bold" id="bold-t" name="style"checked="true"/>
                <label for="bold-t">Bold</label>
            <input class="styler" type="radio" value="dark" id="dark-t" name="style" />
                <label for="dark-t">Dark</label>
            <input class="styler" type="radio" value="light" id="light-t" name="style"/>
                <label for="light-t">Light</label>
        </div>
    </form>
        <div id="placeholder3"><p>The template results will go here</p></div>
    </div>


    <div id="tabs-4">
        <h2>Other ways to use the data you get back</h2>
        <p> 
        The previous examples all demonstrate the default functionality, where
        a table is inserted into the page at the location of the given selector string.
        However, any arbitrary behaviour is possible by passing a function instead of
        a selector. The examples below demonstrate some potential applications of this, with 
        two graphs and an alternative tabular display.
        </p><p>
        One difference between this and the default behaviour is the fact that you will need
        to specify a result format. The two that will be most useful are 
        <a href='http://www.intermine.org/wiki/JSONObjectFormat' target="_blank">jsonpobjects</a>, which all these examples use, and 
        <a href='http://www.intermine.org/wiki/JSONRowFormat' target="_blank">jsonprows</a>, which is similar but provides less syntactic sugar
        for accessing fields of the result items.
        </p>
        <div class="option-box">
        <form>
            <span style="float: right"><input type="checkbox" id="showMeGraphCode" /><label for="showMeGraphCode">Show the code</label></span>
            <div id="graph-radios">
                <input class="grapher" type="radio" id="graph1" name="graph"/><label for="graph1">Employee Age Distribution</label>
                <input class="grapher" type="radio" id="graph2" name="graph"/><label for="graph2">Manager Age vs Seniority</label>
                <input class="grapher" type="radio" id="graph3" name="graph"/><label for="graph3">Department Summary</label>
            </div>
        </form>
        <div id="showGraphAreaContainer" style="display: none;">
        <textarea rows="20" cols="80" id="showGraphArea" class="coder js-snippet">function loadGraph1() {
    IMBedding.loadQuery(
        {
            select: ["Employee.age", "Employee.department.company.name"],
            from: "testmodel"
        },
        {size: 1000, format: "jsonpobjects"},
        function(resultSet) {
            var graphData = [];
            var ageSum = 0;
            var countAtAgeAtCompany = {};
            for (i in resultSet.results) {
                var employee = resultSet.results[i];
                var age = employee.age;
                var company = employee.department.company.name
                ageSum += age;
                if (! countAtAgeAtCompany[company]) {
                    countAtAgeAtCompany[company] = {};
                }
                if (! countAtAgeAtCompany[company][age]) {
                    countAtAgeAtCompany[company][age] = 1;
                } else {
                    countAtAgeAtCompany[company][age] 
                        = countAtAgeAtCompany[company][age] + 1;
                }
            }
            for (name in countAtAgeAtCompany) {
                var company = countAtAgeAtCompany[name];
                var count = 0;
                var sum = 0;
                var companyData = {
                    data: []
                }
                for (age in company) {
                    count += company[age];
                    sum += age * company[age];
                    companyData.data.push([age, company[age]]);
                }
                var companyAverage = parseInt(sum / count);
                companyData.label = 
                    name + " [av: " + companyAverage + "]";
                graphData.push(companyData);
            }
            var options = {
                series: {
                    stack: true,
                    lines: {show: false},
                    bars: {show: true, barWidth: 0.9},
                },
                legend: {position: "nw"}
            };
            var plot = $.plot("#graph", graphData, options);
            var averageAge = parseInt(ageSum / resultSet.results.length);
            $('<span></span>').html("Age (average:" + averageAge + ")")
                              .addClass("axis-label").appendTo('#graph');
        }
    );
}

function loadGraph2() {
    IMBedding.loadQuery(
        {
            select: ["Manager.age", "Manager.seniority", "Manager.name"],
            where: [{path: "Manager.age", op: ">", value: 30}],
            from: "testmodel"
        },
        {size: 1000, format: "jsonpobjects"},
        function(resultSet) {
            var graphData = [];
            var managers = {};
            var ageVsSen = {
                label: "Seniority by Age",
                color: "rgb(0, 115, 234)",
                points: {show: true},
                data: []
            };
            var trendLine = {
                label: "Trend Line",
                color: "rgb(255, 0, 132)",
                lines: {show: true},
            };
            for (i in resultSet.results) {
                var manager = resultSet.results[i];
                var seniority =manager.seniority;
                var age = manager.age;
                ageVsSen.data.push([age, seniority]);
                managers[age + "-" + seniority] = manager;
            }
            trendLine.data = findLineByLeastSquares(ageVsSen.data);
            graphData.push(ageVsSen);
            graphData.push(trendLine);
            var options = {
                grid: {hoverable: true, clickable: true},
                legend: {position: "nw"}
            };
            var plot = $.plot("#graph", graphData, options);
            $('#graph').bind("plothover", function(event, pos, item) {
                if (item) {
                    $("#tooltip").remove();
                    var x = item.datapoint[0].toFixed(2),
                        y = item.datapoint[1].toFixed(2);
                    var key = parseInt(x) + "-" + parseInt(y);
                    var manager = managers[key];
                    showTooltip(item.pageX, item.pageY, manager.name);
                }
                else {
                    $("#tooltip").remove();
                    previousPoint = null;            
                }
            }).bind("plotclick", function(event, pos, item) {
                if (item) {
                    var x = item.datapoint[0].toFixed(2),
                        y = item.datapoint[1].toFixed(2);
                    var key = parseInt(x) + "-" + parseInt(y);
                    var manager = managers[key];
                    var url = baseUrl + "/objectDetails.do?id=" 
                                + manager.objectId;
                    window.location.replace(url);
                }
            });
            $('<span></span>').html("Age").addClass("axis-label").appendTo('#graph');
        }
    );
}

function loadDepartmentSummary(departmentName) {
    departmentName = departmentName || "Sales";
    IMBedding.loadQuery(
        {
            select: [
                "Department.name", "Department.company.name", 
                "Department.employees.name", 
                "Department.employees.age", 
                "Department.employees.address.address", 
                "Department.manager.name",
                "Department.company.departments.name"
            ],
            where: [
                {
                    path: "Department.name", 
                    op: "=", value: departmentName
                },
                {
                    path: "Department.company.name", 
                    op: "=", value: "Wernham-Hogg"
                }
            ],
            from: "testmodel"
        },
        {size: 1000, format: "jsonpobjects"},
        function(resultSet) {
            var department = resultSet.results[0];
            var summary = $('<div></div>').addClass("department-summary");
            var title = document.createElement("h2");
            title.appendChild(document.createTextNode(
                        department.company.name + ": "));
            var depSelect = document.createElement("select");
            $(depSelect).button();
            var noOfDeps = department.company.departments.length;
            for (var i = 0; i &lt; noOfDeps; i++) {
                var dep = department.company.departments[i];
                var depOption = document.createElement("option");
                if (dep.objectId == department.objectId) {
                    depOption.selected = true;
                }
                depOption.innerHTML = dep.name;
                depSelect.appendChild(depOption);
            }
            title.appendChild(depSelect);
            $(depSelect).change(function() {
                loadDepartmentSummary($(depSelect).val());
            });
            summary.append(title);
            var subtitle = document.createElement("h3");
            subtitle.innerHTML = "Manager: " + department.manager.name;
            summary.append(subtitle);
            var employeeCount = department.employees.length;
            var list = document.createElement("ul");
            for (var i = 0; i &lt; employeeCount; i++) {
                var employee = department.employees[i];
                if (employee.objectId == department.manager.objectId) {
                    continue;
                }
                var item = document.createElement("li");
                var link = document.createElement("a");
                link.href = baseUrl + "/objectDetails.do?id=" 
                                    + employee.objectId;
                link.innerHTML = employee.name;
                item.appendChild(link);
                $(link).hover(
                    getEmployeeTooltipper(employee),
                    function(event) {
                        $('.tooltip').remove();
                    }
                );
                list.appendChild(item);
            }
            summary.append(list);
            $('#graph').empty().append(summary);
        }
    );
};
</textarea>
        </div>
        </div>
        <div id="graph" style="width: 600px; height: 300px;"><p>This will be where the graph goes</p></div>
    </div>
    <div id="tabs-7">
        <h2>Styling The Tables</h2>
        <p> 
        The tables produced with the imbedding.js library are designed to be easily stylable. 
        Customisation is possible by using the classes that the elements are decorated with:
        </p>
        <span class="normal-color">Classes you can style in an embedded table:</a>
        <ul>
            <li class="resource">.imbedded-table-container: <span class="normal-color">The outer container that holds the table</span></li>
            <li class="resource">.imbedded-table-titlebox: <span class="normal-color">The box that holds the title and count</span></li>
            <li class="resource">.imbedded-table-title: <span class="normal-color">The text with the actual title</span></li>
            <li class="resource">.imbedded-table: <span class="normal-color">The table element</span></li>
            <li class="resource">.imbedded-column-header-row: <span class="normal-color">The row with the column headings</span></li>
            <li class="resource">.imbedded-cell: <span class="normal-color">Each cell of the table</span></li>
            <li class="resource">.imbedded-row-odd: <span class="normal-color">Odd numbered table rows</span></li>
            <li class="resource">.imbedded-row-even: <span class="normal-color">Even numbered table rows</span></li>
            <li class="resource">.imbedded-column-odd: <span class="normal-color">Odd numbered table columns</span></li>
            <li class="resource">.imbedded-column-even: <span class="normal-color">Even numbered table columns</span></li>
            <li class="resource">.imbedded-exportlink: <span class="normal-color">The CSV and TSV export links</span></li>
            <li class="resource">.imbedded-pagelink: <span class="normal-color">The previous/next paging links</span></li>
            <li class="resource">.imbedded-mineresultslink: <span class="normal-color">The link to the results in the originating mine</span></li>
            <li class="resource">.imbedded-prev: <span class="normal-color">The previous paging link</span></li>
            <li class="resource">.imbedded-next: <span class="normal-color">The next paging link</span></li>
            <li class="resource">.imbedded-table-tooltip: <span class="normal-color">The tooltip that contains the template description</span></li>
            <li class="resource">.imbedded-table-expand-help: <span class="normal-color">The link that says "show/hide table"</span></li>
            <li class="resource">.imbedded-null: <span class="normal-color">Cells that have no value</span></li>
        </ul>
        <p>
        There are <a href="http://www.intermine.org/lib/imbedding/0.1/style/" target="_blank">three styles</a> supplied here with the tutorial, and you can see how changing them
        changes the appearance of the table below:
        </p>
        <form>
            <div class="styles" style="float: right">
                <input class="styler" type="radio" value="bold" id="bold-style" name="style"checked="true"/>
                <label for="bold-style">Bold</label>
                <input class="styler" type="radio" value="dark" id="dark-style" name="style" />
                    <label for="dark-style">Dark</label>
                <input class="styler" type="radio" value="light" id="light-style" name="style"/>
                    <label for="light-style">Light</label>
            </div>
        </form>
        <div id="styleDemo" ></div>
    </div>
    <div id="tabs-5">
        <h2>You May Be Interested In</h2>
        <ul>
            <li class="resource">
                <a href="http://jquery.com">jQuery</a>
                <p> 
                A powerful javascript framework this site makes extensive use of
                </p>
            </li>
            <li class="resource">
                <a href="http://code.google.com/p/jquery-jsonp/">jQuery-JSONP</a>
                <p> 
                A an extension to jQuery to improve jsonp requests (through the 
                addition of better error handling).
                </p>
            </li>
            <li class="resource">
                <a href="http://jquery-ui.com">jQuery-UI</a>
                <p>
                User interface extensions to jQuery. Used here for tabs, buttons
                and autocomplete.
                </p>
            </li>
            <li class="resource">
                <a href="http://www.oriontransfer.co.nz/software/jquery-syntax/index.en">jQuery-Syntax</a>
                <p>
                Used here for syntax highlighting in the code demonstration boxes.
                </p>
            </li>
            <li class="resource">
                <a href="http://code.google.com/p/flot/">Flot</a>
                <p>
                The library used to generate the graphs on the 
                "other things you can do with data" tab.
                </p>
            </li>
            <li class="resource">
                <a href="http://code.google.com/apis/webfonts/">Google Font API</a>
                <p>
                A webservice for supplying beautiful web-fonts so you don't have
                to do the messy business of hosting them.
                </p>
            </li>
        </ul>
    </div>
    <div id="tabs-6">
        <h2>Customising the Tables</h2>
        <div id="faq">
            <!--
        <h3><a href="#">Can anyone use these features?</a></h3>
        <div>
            <p>
            Anyone on any server can access these embedding features. There were
            principally designed for use by groups that have mines in addition to
            other sites, which wanted better sharing of data and functionality
            between the two webapps they run, and to help with interconnections
            between different mines - but you do not have to have a mine yourself
            to make use of these features. They are as accessible as any webservice 
            request; ie: they are open to the public, and not rate-limited.
            </p>
        </div>
        -->
        <h3><a style="cursor: pointer">What properties can I configure, and what are the defaults?</a></h3>
        <div>
            <p>
            There are lots of user configurable properties, and they all have sane defaults. 
            Below you can see a list of values you can pass into the options object
            of any loadQuery and loadTemplate call, and their default values:
            </p>
            <table class="info-table">
                <tr>
                    <th>property</th>
                    <th>description</th>
                    <th>takes</th>
                    <th>default value</th>
                </tr>
                <tbody>
                    <tr>
                        <td>additionText</td>
                        <td>the text to display in the "load x more rows" links</td>
                        <td><code>string</code></td>
                        <td><code>"Load [x] more rows"</code></td>
                    </tr>
                    <tr>
                        <td>afterBuildTable</td>
                        <td>a function to call after the table is built</td>
                        <td><code>function</code></td>
                        <td><code>function(table) {}</code></td>
                    </tr>
                    <tr>
                        <td>afterTableUpdate</td>
                        <td>a function to call after the table is updated with new data</td>
                        <td><code>function</code></td>
                        <td><code>function(table, resultSet) {}</code></td>
                    </tr>
                    <tr>
                        <td>allRowsText</td>
                        <td>the text to display in the links offering to show the remaining rows</td>
                        <td><code>string</code></td>
                        <td><code>"Show remaining rows"</code></td>
                    </tr>
                    <tr>
                        <td>collapseHelpText</td>
                        <td>the text to display in the "hide table" links</td>
                        <td><code>string</code></td>
                        <td><code>"hide table"</code></td>
                    </tr>
                    <tr>
                        <td>countText</td>
                        <td>the text to display in parentheses beside the title</td>
                        <td><code>string</code></td>
                        <td><code>"[x] rows"</code></td>
                    </tr>
                    <tr>
                        <td>defaultQueryName</td>
                        <td>the text to display in the title box if the query has no name</td>
                        <td><code>string</code></td>
                        <td><code>Query Results</code></td>
                    </tr>
                    <tr>
                        <td>emptyCellText</td>
                        <td>the text to display in cells that have no value</td>
                        <td><code>string</code></td>
                        <td><code>"[NONE]"</code></td>
                    </tr>
                    <tr>
                        <td>expandHelpText</td>
                        <td>the text to display in the "show table" links</td>
                        <td><code>string</code></td>
                        <td><code>"show table"</code></td>
                    </tr>
                    <tr>
                        <td>formatCount</td>
                        <td>format the count by adding thousands separators for legibility</td>
                        <td><code>boolean</code></td>
                        <td><code>true</code></td>
                    </tr>
                    <tr>
                        <td>nextText</td>
                        <td>the text to display in the "next page" links</td>
                        <td><code>string</code></td>
                        <td><code>"Next"</code></td>
                    </tr>
                    <tr>
                        <td>onTitleClick</td>
                        <td>what to do when the user clicks the table title</td>
                        <td><code>"collapse", "mine", "none", or function</code></td>
                        <td><code>"collapse"</code></td>
                    </tr>
                    <tr>
                        <td>openOnLoad</td>
                        <td>whether the table should be loaded open or not</td>
                        <td><code>boolean</code></td>
                        <td><code>false</code></td>
                    </tr>
                    <tr>
                        <td>previousText</td>
                        <td>the text to display in the "previous page" links</td>
                        <td><code>string</code></td>
                        <td><code>"Previous"</code></td>
                    </tr>
                    <tr>
                        <td>queryTitleText</td>
                        <td>the text to display as the title of the table. If given, this setting overrides any value returned from the server.</td>
                        <td><code>string</code></td>
                        <td><code>null</code></td>
                    </tr>
                    <tr>
                        <td>resultsDescriptionText</td>
                        <td>the text to display in the toolbox. If given, this setting overrides any value returned from the server.</td>
                        <td><code>string</code></td>
                        <td><code>null</code></td>
                    </tr>
                    <tr>
                        <td>showAdditionsLink</td>
                        <td>whether to show the links offering "x more rows"</td>
                        <td><code>boolean</code></td>
                        <td><code>true</code></td>
                    </tr>
                    <tr>
                        <td>showAllCeiling</td>
                        <td>The maximum number of rows a query can return and still have the table offer to show all rows</td>
                        <td><code>int</code></td>
                        <td><code>75</code></td>
                    </tr>
                    <tr>
                        <td>showAllLink</td>
                        <td>whether to show the links offering "show remaining rows"</td>
                        <td><code>boolean</code></td>
                        <td><code>true</code></td>
                    </tr>
                    <tr>
                        <td>showCount</td>
                        <td>whether to show the count or not</td>
                        <td><code>boolean</code></td>
                        <td><code>true</code></td>
                    </tr>
                    <tr>
                        <td>showExportLinks</td>
                        <td>whether to show the export links (csv, tsv) or not</td>
                        <td><code>boolean</code></td>
                        <td><code>true</code></td>
                    </tr>
                    <tr>
                        <td>showMineLink</td>
                        <td>whether to show the mine links</td>
                        <td><code>boolean</code></td>
                        <td><code>true</code></td>
                    </tr>
                    <tr>
                        <td>throbberSrc</td>
                        <td>the location of a throbber to show when the table is first loaded</td>
                        <td><code>location</code></td>
                        <td><code>"images/throbber.gif"</code></td>
                    </tr>
                    <tr>
                        <td>thousandsSeparator</td>
                        <td>The string to use as the separator between numbers</td>
                        <td><code>string</code></td>
                        <td><code>","</code></td>
                    </tr>
                    <tr>
                        <td>titleHoverCursor</td>
                        <td>the cursor to show when the mouse is held over the title (unless its behaviour is "none"</td>
                        <td><code>string</code></td>
                        <td><code>"pointer"</code></td>
                    </tr>
                </tbody>
            </table>
            <p>
            Note that options that take a parameter (such as countText) should indicate the 
            position of the parameter with the string "[x]"
            </p>
            <p>
            If you want all your tables to share the same set of options, you can specify that
            globally; the example below shows how this can be used for internationalisation:
            </p>
            <textarea rows="5" cols="20" class="coder js-snippet">function setLang(code) {
    if (code == "en") {
        return;
    } else if (code == "de") {
        IMBedding.setDefaultOptions({
            additionText: "[x] Mehr Zeilen Anzeigen", 
            allRowsText: "Alle Zeilen Anzeigen", 
            collapseHelpText: "Tafel ausblenden",
            countText, "[x] Zeilen",
            defaultQueryName: "Ergebnisse",
            emptyCellText: "[KEINS]",
            expandHelpText: "Tafel anzeigen"
            exportCSVText: "Als CSV herunterladen",
            exportTSVText: "Als TSV herunterladen",
            mineLinkText: "Tafel im Mine anschauen",
            nextText: "Weiter", 
            previousText: "Zur&ampuumlck", 
            resultsDescriptionText: "Ergebnisse Ihrer Abfrage"
        });
    } else if (code == "it") {
        IMBedding.setDefaultOptions({
            additionText: "carica altre [x] righe",
            allRowsText: "carica tutte righe",
            collapseHelpText: "chiudi tabella",
            countText: "[x] righe",
            defaultQueryName: "Risultato",
            emptyCellText: "[NIENTE]",
            expandHelpText: "mostra tabella",
            exportCSVText: "Esporta il risultato in formato CSV", 
            exportTSVText: "Esporta il risultato in formato TSV", 
            mineLinkText: "Guarda in Mine",
            nextText: "avanti", 
            previousText: "indietro",
            resultsDescriptionText: "il risultato della loro interrogazione"
        });
    } else // and so on ...</textarea>
            <p>
            Furthermore, the table itself is an object of type "Table", and upon production 
            and and updates it is passed to the (no-op) functions 
            <code>IMBedding.afterBuildTable(table)</code>
            and <code>IMBedding.afterTableUpdate(table, resultSet)</code> respectively. 
            To get access to the table automatically, simply replace the no-op versions with 
            your own code:
            </p>
            <textarea rows="5" cols="20" class="coder js-snippet">IMBedding.afterBuildTable = function(table) {doSomethingWith(table)};</textarea>
            <p>
            The table object provides you with deep low level access to many aspects, including
            all the elements (which are attributes of it, as jQuery objects) and many
            methods. For example if you load a template but don't want one of the columns, 
            you could do something like this:
            <p>
            <textarea rows="5" cols="20" class="coder js-snippet">IMBedding.afterTableUpdate = function(table) {
    table.table.children('tr').each(function() {
        $(this.children[unwantedColIndex]).remove();
    });
};</textarea>
            <p>
            The above code will then apply to <em>all</em> tables built by IMBedding. To alter
            the behaviour for just one table, supply a value for the <code>afterBuildTable</code>
            and <code>afterTableUpdate</code> options values. Both the table specific function, 
            and the global one will be run.
            </p>
        </div>
        <h3><a style="cursor: pointer">Showing Contents on Load</a></h3>
        <div>
        <p>
        Setting <code>openOnLoad</code> to true loads the table pre-opened. Clicking on the titlebar of this
        table will collapse it.
        </p>
        <div id="placeholderEx2"><button onclick="loadTable1()">Load a pre-opened table</button></div>
        <input type="checkbox" id="example2CB" onclick="$('#example2').slideToggle();"/><label for="example2CB">View Source</label>
        <div id="example2" style="display: none;">
            <textarea rows="20" cols="80" class="coder html-snippet"><script type="text/javascript">
    IMBedding.setBaseUrl("http://preview.flymine.org/preview");
    IMBedding.loadTemplate(
        {
            name:           "Gene_Identifiers",

            constraint1:    "Gene.secondaryIdentifier",
            op1:            "<",
            value1:         "CG1046",
            code1:          "A",
        },
        "#placeholderEx2",
        {openOnLoad: true}
    );
</script></textarea>
        </div>
    </div>
    <h3><a style="cursor: pointer">Changing Title Click Behaviour</a></h3>
    <div>
        <p>
        The default behaviour for a click on the title is to expand/collapse the table. 
        You can choose other behaviours:
        </p>
        <h3>Default Behaviour</h3>
        <div id="placeholderEx3d"><p>This will be where the table goes</p></div>
        <h3>Click Through to Mine</h3>
        <div id="placeholderEx3a"><p>This will be where the table goes</p></div>
        <h3>No Behaviour</h3>
        <div id="placeholderEx3b"><p>This will be where the table goes</p></div>
        <h3>Arbitrary Behaviour</h3>
        <div id="placeholderEx3c"><p>This will be where the table goes</p></div>
        <input type="checkbox" id="example3CB" onclick="$('#example3').slideToggle();"/><label for="example3CB">View Source</label>
        <div id="example3" style="display: none;">
        <textarea rows="20" cols="80" class="coder html-snippet"><script type="text/javascript">
    // Common arguments
    IMBedding.setBaseUrl("http://preview.flymine.org/preview");
    var data = {
        name:           "Gene_allGOTerms2",

        constraint1:    "Gene",
        op1:            "LOOKUP",
        value1:         "CG11348",
        code1:          "A",
    };
    var ph = "#placeholderEx3";
    var options = {};

    // Load a template with the default dehaviour
    IMBedding.loadTemplate(data, ph + "a", options);
    // Load a template where clicking on the title
    // takes you to the mine.
    options.onTitleClick = "mine";
    IMBedding.loadTemplate(data, ph + "a", options);
    // Load a template where clicking on the title
    // does nothing at all.
    options.onTitleClick = "none";
    IMBedding.loadTemplate(data, ph + "b", options);
    // Load a template where clicking on the title
    // does something completely different
    options.onTitleClick = function() {
        alert( "You clicked on:\n" + $(this).text());
    };
    options.titleHoverCursor = "help";
    IMBedding.loadTemplate(data, ph + "c", options);
</script></textarea></div>
        </div>
        <h3><a style="cursor: pointer">Configuring What is Shown</a></h3>
        <div>
            <p>
            As well as the title, by default the table will also contain export links,
            a link to the results in the originating mine, a count of the total results, and
            pages with 10 rows of results. The tables below show adjustments to these features.
            </p>
            <h3>No Export Links</h3>
            <textarea rows="20" cols="80" class="coder js-snippet">options.showExportLinks = false;</textarea>
            <div id="placeholderEx4a"><p>This will be where the table goes</p></div>
            <h3>No Count</h3>
            <textarea rows="20" cols="80" class="coder js-snippet">options.showCount = false;</textarea>
            <div id="placeholderEx4b"><p>This will be where the table goes</p></div>
            <h3>No Mine Link</h3>
            <textarea rows="20" cols="80" class="coder js-snippet">options.showMineLink = false;</textarea>
            <div id="placeholderEx4c"><p>This will be where the table goes</p></div>
            <h3>A Different Number of Rows</h3>
            <textarea rows="20" cols="80" class="coder js-snippet">data.size = 15;</textarea>
            <div id="placeholderEx4d"><p>This will be where the table goes</p></div>
            <h3>A Different Language</h3>
            <textarea rows="20" cols="80" class="coder js-snippet">data.nextText = "avanti"; // and others</textarea>
            <div id="placeholderEx4e"><p>This will be where the table goes</p></div>
            <input type="checkbox" id="example4CB" onclick="$('#example4').slideToggle();"/><label for="example4CB">View Source</label>
            <div id="example4" style="display: none;">
            <textarea rows="20" cols="80" class="coder html-snippet"><script type="text/javascript">
    IMBedding.setBaseUrl("http://preview.flymine.org/preview");
    var data = {
        name:        "Organism_GeneDomain_new",

        constraint1: "ProteinDomain.proteins.genes.organism.name",
        op1:         "=",
        value1:      "Drosophila melanogaster",
        code1:       "A",

        constraint2: "ProteinDomain.shortName",
        op2:         "=",
        value2:      "*homeo*",
        code2:       "B"
    };
    var ph = '#placeholderEx4';
    // Load a table without export links
    IMBedding.loadTemplate(data, ph + "a", {showExportLinks: false});

    // Load a table without a count
    IMBedding.loadTemplate(data, ph + "b", {showCount: false});

    // Load a tavle without a mine-link
    IMBedding.loadTemplate(data, ph + "c", {showMineLink: false});

    // Load a table with a page size of 15
    data.size = 15;
    IMBedding.loadTemplate(data, ph + "d");

    //Load a table in Italian
    var options = {
        nextText: "avanti", 
        previousText: "indietro",
        additionText: "carica altre x righe",
        allRowsText: "carica tutte righe",
        emptyCellText: "[NIENTE]",
        collapseHelpText: "chiudi tabella",
        expandHelpText: "mostra tabella",
        exportCSVText: "Esporta il risultato in formato CSV", 
        exportTSVText: "Esporta il risultato in formato TSV", 
        mineLinkText: "Guarda in Mine",
        resultsDescriptionText: "il risultato della loro interrogazione",
        queryTitleText: "Organismo --&gt; Tutti genia con un dominio specifico",
        countText: "[x] righe",
        thousandsSeparator: "."
    };
    IMBedding.loadTemplate(data, ph + "e", options);
</script></textarea>
        </div>
        </div>
      </div>
    </div>
        </div>
    </div>
</div>
    </div>
    </body>
</html>
